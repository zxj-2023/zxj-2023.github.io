<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="zxj Blogs">
<meta property="og:type" content="website">
<meta property="og:title" content="Zhang XiJun">
<meta property="og:url" content="http://example.com/page/6/index.html">
<meta property="og:site_name" content="Zhang XiJun">
<meta property="og:description" content="zxj Blogs">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="å¼ ç†™æµš">
<meta property="article:tag" content="zxj">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/6/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/6/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Zhang XiJun</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Zhang XiJun</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">BLOGS</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="æœç´¢..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="å¼ ç†™æµš"
      src="/images/zxjavatar.gif">
  <p class="site-author-name" itemprop="name">å¼ ç†™æµš</p>
  <div class="site-description" itemprop="description">zxj Blogs</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">127</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">47</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">55</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zxj-2023" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;zxj-2023" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://wpa.qq.com/msgrd?v=3&uin=2902065320&site=qq&menu=yes" title="QQ â†’ http:&#x2F;&#x2F;wpa.qq.com&#x2F;msgrd?v&#x3D;3&amp;uin&#x3D;2902065320&amp;site&#x3D;qq&amp;menu&#x3D;yes" rel="noopener me" target="_blank"><i class="fab fa-qq fa-fw"></i>QQ</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          é“¾æ¥
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://zxj-2023.github.io/" title="https:&#x2F;&#x2F;zxj-2023.github.io" rel="noopener" target="_blank">Zhang XiJun</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://theme-next.js.org/" title="https:&#x2F;&#x2F;theme-next.js.org" rel="noopener" target="_blank">NexT</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%80%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82pandas%E5%9F%BA%E7%A1%80-%E8%AF%BE%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%80%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82pandas%E5%9F%BA%E7%A1%80-%E8%AF%BE%E7%A8%8B/" class="post-title-link" itemprop="url">æ•°æ®åˆ†æâ€”â€”ç¬¬ä¸€ç« ï¼šç¬¬ä¸€èŠ‚æ•°æ®è½½å…¥åŠåˆæ­¥è§‚å¯Ÿ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00 / ä¿®æ”¹æ—¶é—´ï¼š16:57:42" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/" itemprop="url" rel="index"><span itemprop="name">kaggle</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/titanic/" itemprop="url" rel="index"><span itemprop="name">titanic</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>å¤ä¹ ï¼š</strong>æ•°æ®åˆ†æçš„ç¬¬ä¸€æ­¥ï¼ŒåŠ è½½æ•°æ®æˆ‘ä»¬å·²ç»å­¦ä¹ å®Œæ¯•äº†ã€‚å½“æ•°æ®å±•ç°åœ¨æˆ‘ä»¬é¢å‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„ç¬¬ä¸€æ­¥å°±æ˜¯è®¤è¯†ä»–ï¼Œä»Šå¤©æˆ‘ä»¬è¦å­¦ä¹ çš„å°±æ˜¯<strong>äº†è§£å­—æ®µå«ä¹‰ä»¥åŠåˆæ­¥è§‚å¯Ÿæ•°æ®</strong>ã€‚</p>
<h2 id="1-ç¬¬ä¸€ç« ï¼šæ•°æ®è½½å…¥åŠåˆæ­¥è§‚å¯Ÿ"><a href="#1-ç¬¬ä¸€ç« ï¼šæ•°æ®è½½å…¥åŠåˆæ­¥è§‚å¯Ÿ" class="headerlink" title="1 ç¬¬ä¸€ç« ï¼šæ•°æ®è½½å…¥åŠåˆæ­¥è§‚å¯Ÿ"></a>1 ç¬¬ä¸€ç« ï¼šæ•°æ®è½½å…¥åŠåˆæ­¥è§‚å¯Ÿ</h2><h3 id="1-4-çŸ¥é“ä½ çš„æ•°æ®å«ä»€ä¹ˆ"><a href="#1-4-çŸ¥é“ä½ çš„æ•°æ®å«ä»€ä¹ˆ" class="headerlink" title="1.4 çŸ¥é“ä½ çš„æ•°æ®å«ä»€ä¹ˆ"></a>1.4 çŸ¥é“ä½ çš„æ•°æ®å«ä»€ä¹ˆ</h3><p>æˆ‘ä»¬å­¦ä¹ pandasçš„åŸºç¡€æ“ä½œï¼Œé‚£ä¹ˆä¸Šä¸€èŠ‚é€šè¿‡pandasåŠ è½½ä¹‹åçš„æ•°æ®ï¼Œå…¶æ•°æ®ç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><strong>å¼€å§‹å‰å¯¼å…¥numpyå’Œpandas</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<h4 id="1-4-1-ä»»åŠ¡ä¸€ï¼špandasä¸­æœ‰ä¸¤ä¸ªæ•°æ®ç±»å‹DateFrameå’ŒSeriesï¼Œé€šè¿‡æŸ¥æ‰¾ç®€å•äº†è§£ä»–ä»¬ã€‚ç„¶åè‡ªå·±å†™ä¸€ä¸ªå…³äºè¿™ä¸¤ä¸ªæ•°æ®ç±»å‹çš„å°ä¾‹å­ğŸŒ°-å¼€æ”¾é¢˜"><a href="#1-4-1-ä»»åŠ¡ä¸€ï¼špandasä¸­æœ‰ä¸¤ä¸ªæ•°æ®ç±»å‹DateFrameå’ŒSeriesï¼Œé€šè¿‡æŸ¥æ‰¾ç®€å•äº†è§£ä»–ä»¬ã€‚ç„¶åè‡ªå·±å†™ä¸€ä¸ªå…³äºè¿™ä¸¤ä¸ªæ•°æ®ç±»å‹çš„å°ä¾‹å­ğŸŒ°-å¼€æ”¾é¢˜" class="headerlink" title="1.4.1 ä»»åŠ¡ä¸€ï¼špandasä¸­æœ‰ä¸¤ä¸ªæ•°æ®ç±»å‹DateFrameå’ŒSeriesï¼Œé€šè¿‡æŸ¥æ‰¾ç®€å•äº†è§£ä»–ä»¬ã€‚ç„¶åè‡ªå·±å†™ä¸€ä¸ªå…³äºè¿™ä¸¤ä¸ªæ•°æ®ç±»å‹çš„å°ä¾‹å­ğŸŒ°[å¼€æ”¾é¢˜]"></a>1.4.1 ä»»åŠ¡ä¸€ï¼špandasä¸­æœ‰ä¸¤ä¸ªæ•°æ®ç±»å‹DateFrameå’ŒSeriesï¼Œé€šè¿‡æŸ¥æ‰¾ç®€å•äº†è§£ä»–ä»¬ã€‚ç„¶åè‡ªå·±å†™ä¸€ä¸ªå…³äºè¿™ä¸¤ä¸ªæ•°æ®ç±»å‹çš„å°ä¾‹å­ğŸŒ°[å¼€æ”¾é¢˜]</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æˆ‘ä»¬ä¸¾çš„ä¾‹å­</span></span><br><span class="line">sdata = &#123;<span class="string">&#x27;Ohio&#x27;</span>: <span class="number">35000</span>, <span class="string">&#x27;Texas&#x27;</span>: <span class="number">71000</span>, <span class="string">&#x27;Oregon&#x27;</span>: <span class="number">16000</span>, <span class="string">&#x27;Utah&#x27;</span>: <span class="number">5000</span>&#125;</span><br><span class="line">example_1 = pd.Series(sdata)</span><br><span class="line">example_1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Ohio      35000
Texas     71000
Oregon    16000
Utah       5000
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æˆ‘ä»¬ä¸¾çš„ä¾‹å­</span></span><br><span class="line">data = &#123;<span class="string">&#x27;state&#x27;</span>: [<span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Ohio&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>, <span class="string">&#x27;Nevada&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;year&#x27;</span>: [<span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>],<span class="string">&#x27;pop&#x27;</span>: [<span class="number">1.5</span>, <span class="number">1.7</span>, <span class="number">3.6</span>, <span class="number">2.4</span>, <span class="number">2.9</span>, <span class="number">3.2</span>]&#125;</span><br><span class="line">example_2 = pd.DataFrame(data)</span><br><span class="line">example_2</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2001</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nevada</td>
      <td>2001</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nevada</td>
      <td>2002</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Nevada</td>
      <td>2003</td>
      <td>3.2</td>
    </tr>
  </tbody>
</table>
#### 1.4.2 ä»»åŠ¡äºŒï¼šæ ¹æ®ä¸ŠèŠ‚è¯¾çš„æ–¹æ³•è½½å…¥"train.csv"æ–‡ä»¶

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df=pd.read_csv(<span class="string">&#x27;./titanic/train.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>

ä¹Ÿå¯ä»¥åŠ è½½ä¸Šä¸€èŠ‚è¯¾ä¿å­˜çš„"train_chinese.csv"æ–‡ä»¶ã€‚é€šè¿‡ç¿»è¯‘ç‰ˆtrain_chinese.csvç†Ÿæ‚‰äº†è¿™ä¸ªæ•°æ®é›†ï¼Œç„¶åæˆ‘ä»¬å¯¹trian.csvæ¥è¿›è¡Œæ“ä½œ
#### 1.4.3 ä»»åŠ¡ä¸‰ï¼šæŸ¥çœ‹DataFrameæ•°æ®çš„æ¯åˆ—çš„åç§°


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df.columns</span><br></pre></td></tr></table></figure>


    Index(['PassengerId', 'Survived', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp',
           'Parch', 'Ticket', 'Fare', 'Cabin', 'Embarked'],
          dtype='object')

#### 1.4.4ä»»åŠ¡å››ï¼šæŸ¥çœ‹"Cabin"è¿™åˆ—çš„æ‰€æœ‰å€¼[æœ‰å¤šç§æ–¹æ³•]


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df[<span class="string">&#x27;Cabin&#x27;</span>].head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>


    0     NaN
    1     C85
    2     NaN
    3    C123
    4     NaN
    5     NaN
    6     E46
    7     NaN
    8     NaN
    9     NaN
    Name: Cabin, dtype: object


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df.Cabin.values[:<span class="number">10</span>]</span><br><span class="line">df.Cabin.head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>


    0     NaN
    1     C85
    2     NaN
    3    C123
    4     NaN
    5     NaN
    6     E46
    7     NaN
    8     NaN
    9     NaN
    Name: Cabin, dtype: object

#### 1.4.5 ä»»åŠ¡äº”ï¼šåŠ è½½æ–‡ä»¶"test_1.csv"ï¼Œç„¶åå¯¹æ¯”"train.csv"ï¼Œçœ‹çœ‹æœ‰å“ªäº›å¤šå‡ºçš„åˆ—ï¼Œç„¶åå°†å¤šå‡ºçš„åˆ—åˆ é™¤
ç»è¿‡æˆ‘ä»¬çš„è§‚å¯Ÿå‘ç°ä¸€ä¸ªæµ‹è¯•é›†test_1.csvæœ‰ä¸€åˆ—æ˜¯å¤šä½™çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªå¤šä½™çš„åˆ—åˆ å»


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">test_1=pd.read_csv(<span class="string">&#x27;../ç¬¬ä¸€å•å…ƒé¡¹ç›®é›†åˆ/test_1.csv&#x27;</span>)</span><br><span class="line">test_1.head()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>100</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>100</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>100</td>
    </tr>
  </tbody>
</table>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#test_1.columns</span></span><br><span class="line">test_1.drop(<span class="string">&#x27;Unnamed: 0&#x27;</span>,axis=<span class="number">1</span>,inplace=<span class="literal">True</span>)</span><br><span class="line">test_1.columns</span><br></pre></td></tr></table></figure>
<pre><code>Index([&#39;PassengerId&#39;, &#39;Survived&#39;, &#39;Pclass&#39;, &#39;Name&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;,
       &#39;Parch&#39;, &#39;Ticket&#39;, &#39;Fare&#39;, &#39;Cabin&#39;, &#39;Embarked&#39;, &#39;a&#39;],
      dtype=&#39;object&#39;)
</code></pre><p>ã€æ€è€ƒã€‘è¿˜æœ‰å…¶ä»–çš„åˆ é™¤å¤šä½™çš„åˆ—çš„æ–¹å¼å—ï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="keyword">del</span> test_1[<span class="string">&#x27;Unnamed: 0&#x27;</span>]</span><br><span class="line">test_1.columns</span><br></pre></td></tr></table></figure>
<pre><code>Index([&#39;PassengerId&#39;, &#39;Survived&#39;, &#39;Pclass&#39;, &#39;Name&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;,
       &#39;Parch&#39;, &#39;Ticket&#39;, &#39;Fare&#39;, &#39;Cabin&#39;, &#39;Embarked&#39;, &#39;a&#39;],
      dtype=&#39;object&#39;)
</code></pre><h4 id="1-4-6-ä»»åŠ¡å…­ï¼š-å°†-â€˜PassengerIdâ€™-â€™Nameâ€™-â€™Ageâ€™-â€™Ticketâ€™-è¿™å‡ ä¸ªåˆ—å…ƒç´ éšè—ï¼Œåªè§‚å¯Ÿå…¶ä»–å‡ ä¸ªåˆ—å…ƒç´ "><a href="#1-4-6-ä»»åŠ¡å…­ï¼š-å°†-â€˜PassengerIdâ€™-â€™Nameâ€™-â€™Ageâ€™-â€™Ticketâ€™-è¿™å‡ ä¸ªåˆ—å…ƒç´ éšè—ï¼Œåªè§‚å¯Ÿå…¶ä»–å‡ ä¸ªåˆ—å…ƒç´ " class="headerlink" title="1.4.6 ä»»åŠ¡å…­ï¼š å°†[â€˜PassengerIdâ€™,â€™Nameâ€™,â€™Ageâ€™,â€™Ticketâ€™]è¿™å‡ ä¸ªåˆ—å…ƒç´ éšè—ï¼Œåªè§‚å¯Ÿå…¶ä»–å‡ ä¸ªåˆ—å…ƒç´ "></a>1.4.6 ä»»åŠ¡å…­ï¼š å°†[â€˜PassengerIdâ€™,â€™Nameâ€™,â€™Ageâ€™,â€™Ticketâ€™]è¿™å‡ ä¸ªåˆ—å…ƒç´ éšè—ï¼Œåªè§‚å¯Ÿå…¶ä»–å‡ ä¸ªåˆ—å…ƒç´ </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df.drop([<span class="string">&#x27;PassengerId&#x27;</span>, <span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>,<span class="string">&#x27;Ticket&#x27;</span>], axis=<span class="number">1</span>).head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>0</td>
      <td>0</td>
      <td>8.4583</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>1</td>
      <td>male</td>
      <td>0</td>
      <td>0</td>
      <td>51.8625</td>
      <td>E46</td>
      <td>S</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>3</td>
      <td>1</td>
      <td>21.0750</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>0</td>
      <td>2</td>
      <td>11.1333</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>2</td>
      <td>female</td>
      <td>1</td>
      <td>0</td>
      <td>30.0708</td>
      <td>NaN</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
ã€æ€è€ƒã€‘å¯¹æ¯”ä»»åŠ¡äº”å’Œä»»åŠ¡å…­ï¼Œæ˜¯ä¸æ˜¯ä½¿ç”¨äº†ä¸ä¸€æ ·çš„æ–¹æ³•(å‡½æ•°)ï¼Œå¦‚æœä½¿ç”¨ä¸€æ ·çš„å‡½æ•°å¦‚ä½•å®Œæˆä¸Šé¢çš„ä¸åŒçš„è¦æ±‚å‘¢ï¼Ÿ

ã€æ€è€ƒå›ç­”ã€‘

å¦‚æœæƒ³è¦å®Œå…¨çš„åˆ é™¤ä½ çš„æ•°æ®ç»“æ„ï¼Œä½¿ç”¨inplace=Trueï¼Œå› ä¸ºä½¿ç”¨inplaceå°±å°†åŸæ•°æ®è¦†ç›–äº†ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰ç”¨

### 1.5 ç­›é€‰çš„é€»è¾‘

è¡¨æ ¼æ•°æ®ä¸­ï¼Œæœ€é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯è¦å…·æœ‰å¯ç­›é€‰çš„èƒ½åŠ›ï¼Œé€‰å‡ºæˆ‘æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œä¸¢å¼ƒæ— ç”¨çš„ä¿¡æ¯ã€‚

ä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯ç”¨å®æˆ˜æ¥å­¦ä¹ pandasè¿™ä¸ªåŠŸèƒ½ã€‚

#### 1.5.1 ä»»åŠ¡ä¸€ï¼š æˆ‘ä»¬ä»¥"Age"ä¸ºç­›é€‰æ¡ä»¶ï¼Œæ˜¾ç¤ºå¹´é¾„åœ¨10å²ä»¥ä¸‹çš„ä¹˜å®¢ä¿¡æ¯ã€‚


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="built_in">print</span>((df[<span class="string">&#x27;Age&#x27;</span>]&lt;<span class="number">10</span>).head(<span class="number">2</span>))</span><br><span class="line">df[df[<span class="string">&#x27;Age&#x27;</span>]&lt;<span class="number">10</span>].head(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

    0    False
    1    False
    Name: Age, dtype: bool

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>Palsson, Master. Gosta Leonard</td>
      <td>male</td>
      <td>2.0</td>
      <td>3</td>
      <td>1</td>
      <td>349909</td>
      <td>21.075</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>10</th>
      <td>11</td>
      <td>1</td>
      <td>3</td>
      <td>Sandstrom, Miss. Marguerite Rut</td>
      <td>female</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>PP 9549</td>
      <td>16.700</td>
      <td>G6</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
#### 1.5.2 ä»»åŠ¡äºŒï¼š ä»¥"Age"ä¸ºæ¡ä»¶ï¼Œå°†å¹´é¾„åœ¨10å²ä»¥ä¸Šå’Œ50å²ä»¥ä¸‹çš„ä¹˜å®¢ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥ï¼Œå¹¶å°†è¿™ä¸ªæ•°æ®å‘½åä¸ºmidage


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">midage=df[(df[<span class="string">&#x27;Age&#x27;</span>]&gt;<span class="number">10</span>) &amp; (df[<span class="string">&#x27;Age&#x27;</span>]&lt;<span class="number">50</span>)]</span><br><span class="line">midage</span><br></pre></td></tr></table></figure>





ã€æç¤ºã€‘äº†è§£pandasçš„æ¡ä»¶ç­›é€‰æ–¹å¼ä»¥åŠå¦‚ä½•ä½¿ç”¨äº¤é›†å’Œå¹¶é›†æ“ä½œ

#### 1.5.3 ä»»åŠ¡ä¸‰ï¼šå°†midageçš„æ•°æ®ä¸­ç¬¬100è¡Œçš„"Pclass"å’Œ"Sex"çš„æ•°æ®æ˜¾ç¤ºå‡ºæ¥


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">midage = midage.reset_index(drop=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(midage)</span><br><span class="line">midage.loc[<span class="number">1</span>][[<span class="string">&#x27;Pclass&#x27;</span>, <span class="string">&#x27;Sex&#x27;</span>]]</span><br></pre></td></tr></table></figure>

         PassengerId  Survived  Pclass  \
    0              1         0       3   
    1              2         1       1   
    2              3         1       3   
    3              4         1       1   
    4              5         0       3   
    ..           ...       ...     ...   
    571          886         0       3   
    572          887         0       2   
    573          888         1       1   
    574          890         1       1   
    575          891         0       3   

                                                      Name     Sex   Age  SibSp  \
    0                              Braund, Mr. Owen Harris    male  22.0      1   
    1    Cumings, Mrs. John Bradley (Florence Briggs Th...  female  38.0      1   
    2                               Heikkinen, Miss. Laina  female  26.0      0   
    3         Futrelle, Mrs. Jacques Heath (Lily May Peel)  female  35.0      1   
    4                             Allen, Mr. William Henry    male  35.0      0   
    ..                                                 ...     ...   ...    ...   
    571               Rice, Mrs. William (Margaret Norton)  female  39.0      0   
    572                              Montvila, Rev. Juozas    male  27.0      0   
    573                       Graham, Miss. Margaret Edith  female  19.0      0   
    574                              Behr, Mr. Karl Howell    male  26.0      0   
    575                                Dooley, Mr. Patrick    male  32.0      0   

         Parch            Ticket     Fare Cabin Embarked  
    0        0         A/5 21171   7.2500   NaN        S  
    1        0          PC 17599  71.2833   C85        C  
    2        0  STON/O2. 3101282   7.9250   NaN        S  
    3        0            113803  53.1000  C123        S  
    4        0            373450   8.0500   NaN        S  
    ..     ...               ...      ...   ...      ...  
    571      5            382652  29.1250   NaN        Q  
    572      0            211536  13.0000   NaN        S  
    573      0            112053  30.0000   B42        S  
    574      0            111369  30.0000  C148        C  
    575      0            370376   7.7500   NaN        Q  

    [576 rows x 12 columns]



    Pclass         1
    Sex       female
    Name: 1, dtype: object



ã€æç¤ºã€‘åœ¨æŠ½å–æ•°æ®ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ•°æ®çš„ç›¸å¯¹é¡ºåºä¿æŒä¸å˜ï¼Œç”¨ä»€ä¹ˆå‡½æ•°å¯ä»¥è¾¾åˆ°è¿™ä¸ªæ•ˆæœå‘¢ï¼Ÿ

#### 1.5.4 ä»»åŠ¡å››ï¼šä½¿ç”¨locæ–¹æ³•å°†midageçš„æ•°æ®ä¸­ç¬¬100ï¼Œ105ï¼Œ108è¡Œçš„"Pclass"ï¼Œ"Name"å’Œ"Sex"çš„æ•°æ®æ˜¾ç¤ºå‡ºæ¥


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">midage.loc[[<span class="number">100</span>,<span class="number">105</span>,<span class="number">108</span>],[<span class="string">&#x27;Pclass&#x27;</span>,<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Sex&#x27;</span>]] </span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>2</td>
      <td>Byles, Rev. Thomas Roussel Davids</td>
      <td>male</td>
    </tr>
    <tr>
      <th>105</th>
      <td>3</td>
      <td>Cribb, Mr. John Hatfield</td>
      <td>male</td>
    </tr>
    <tr>
      <th>108</th>
      <td>3</td>
      <td>Calic, Mr. Jovo</td>
      <td>male</td>
    </tr>
  </tbody>
</table>
#### 1.5.5 ä»»åŠ¡äº”ï¼šä½¿ç”¨ilocæ–¹æ³•å°†midageçš„æ•°æ®ä¸­ç¬¬100ï¼Œ105ï¼Œ108è¡Œçš„"Pclass"ï¼Œ"Name"å’Œ"Sex"çš„æ•°æ®æ˜¾ç¤ºå‡ºæ¥


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">midage.iloc[[<span class="number">100</span>,<span class="number">105</span>,<span class="number">108</span>],[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]] </span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>149</th>
      <td>2</td>
      <td>Byles, Rev. Thomas Roussel Davids</td>
      <td>male</td>
    </tr>
    <tr>
      <th>160</th>
      <td>3</td>
      <td>Cribb, Mr. John Hatfield</td>
      <td>male</td>
    </tr>
    <tr>
      <th>163</th>
      <td>3</td>
      <td>Calic, Mr. Jovo</td>
      <td>male</td>
    </tr>
  </tbody>
</table>


<p>ã€æ€è€ƒã€‘å¯¹æ¯”<code>iloc</code>å’Œ<code>loc</code>çš„å¼‚åŒ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># *   å½“ä½ éœ€è¦æ ¹æ®**æ ‡ç­¾åç§°**ï¼ˆå¦‚è¡Œç´¢å¼•åæˆ–åˆ—åï¼‰æ¥é€‰å–æ•°æ®æ—¶ï¼Œä½¿ç”¨ `loc`ã€‚è¿™ä½¿å¾—ä»£ç æ›´å…·å¯è¯»æ€§ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥çœ‹åˆ°ä½ æ­£åœ¨æ“ä½œçš„æ ‡ç­¾ã€‚</span></span><br><span class="line"><span class="comment"># *   å½“ä½ éœ€è¦æ ¹æ®**æ•´æ•°ä½ç½®**æ¥é€‰å–æ•°æ®æ—¶ï¼ˆä¸å…³å¿ƒæ ‡ç­¾åç§°ï¼Œæˆ–è€…æ ‡ç­¾ä¸æ˜¯æ•´æ•°ï¼‰ï¼Œä½¿ç”¨ `iloc`ã€‚è¿™åœ¨å¤„ç†æ²¡æœ‰æœ‰æ„ä¹‰æ ‡ç­¾çš„ DataFrameï¼Œæˆ–è€…éœ€è¦è¿›è¡Œä¸ä½ç½®ç›¸å…³çš„æ“ä½œæ—¶å¾ˆæœ‰ç”¨ã€‚</span></span><br><span class="line"><span class="comment"># *   **æ³¨æ„**ï¼šå¦‚æœ DataFrame çš„ç´¢å¼•æ˜¯é»˜è®¤çš„æ•´æ•°ç´¢å¼• (0, 1, 2, ...)ï¼Œé‚£ä¹ˆ `loc` å’Œ `iloc` åœ¨ä½¿ç”¨å•ä¸ªæ•´æ•°æˆ–æ•´æ•°åˆ‡ç‰‡è¿›è¡Œè¡Œé€‰æ‹©æ—¶ï¼Œè¡Œä¸ºå¯èƒ½ä¼šç›¸ä¼¼ï¼Œä½†è¿™å¯èƒ½ä¼šå¯¼è‡´æ··æ·†ã€‚</span></span><br><span class="line"><span class="comment">#     *   ä¾‹å¦‚ï¼Œå¦‚æœ `df.index` æ˜¯ `[0, 1, 2, 5, 6]`ï¼š</span></span><br><span class="line"><span class="comment">#         *   `df.loc[0]` ä¼šé€‰æ‹©ç´¢å¼•æ ‡ç­¾ä¸º `0` çš„è¡Œã€‚</span></span><br><span class="line"><span class="comment">#         *   `df.iloc[0]` ä¹Ÿä¼šé€‰æ‹©ç¬¬ä¸€è¡Œï¼ˆå³ç´¢å¼•æ ‡ç­¾ä¸º `0` çš„è¡Œï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#         *   `df.loc[3]` ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ²¡æœ‰ç´¢å¼•æ ‡ç­¾ä¸º `3`ã€‚</span></span><br><span class="line"><span class="comment">#         *   `df.iloc[3]` ä¼šé€‰æ‹©ç¬¬å››è¡Œï¼ˆå³ç´¢å¼•æ ‡ç­¾ä¸º `5` çš„è¡Œï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># *   ä¸ºäº†é¿å…æ··æ·†ï¼Œæœ€ä½³å®è·µæ˜¯ï¼šå½“ä½ çŸ¥é“ä½ æ­£åœ¨ä½¿ç”¨æ ‡ç­¾æ—¶ï¼Œæ˜ç¡®ä½¿ç”¨ `loc`ï¼›å½“ä½ çŸ¥é“ä½ æ­£åœ¨ä½¿ç”¨æ•´æ•°ä½ç½®æ—¶ï¼Œæ˜ç¡®ä½¿ç”¨ `iloc`ã€‚</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0---%E8%AF%84%E4%BB%B7-%E8%AF%BE%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0---%E8%AF%84%E4%BB%B7-%E8%AF%BE%E7%A8%8B/" class="post-title-link" itemprop="url">æ•°æ®åˆ†æâ€”â€”ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-06-12 18:46:07" itemprop="dateModified" datetime="2025-06-12T18:46:07+08:00">2025-06-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/" itemprop="url" rel="index"><span itemprop="name">kaggle</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/titanic/" itemprop="url" rel="index"><span itemprop="name">titanic</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ç¬¬ä¸‰ç« -æ¨¡å‹æ­å»ºå’Œè¯„ä¼°-è¯„ä¼°"><a href="#ç¬¬ä¸‰ç« -æ¨¡å‹æ­å»ºå’Œè¯„ä¼°-è¯„ä¼°" class="headerlink" title="ç¬¬ä¸‰ç«  æ¨¡å‹æ­å»ºå’Œè¯„ä¼°-è¯„ä¼°"></a>ç¬¬ä¸‰ç«  æ¨¡å‹æ­å»ºå’Œè¯„ä¼°-è¯„ä¼°</h2><p>æ ¹æ®ä¹‹å‰çš„æ¨¡å‹çš„å»ºæ¨¡ï¼Œæˆ‘ä»¬çŸ¥é“å¦‚ä½•è¿ç”¨sklearnè¿™ä¸ªåº“æ¥å®Œæˆå»ºæ¨¡ï¼Œä»¥åŠæˆ‘ä»¬çŸ¥é“äº†çš„æ•°æ®é›†çš„åˆ’åˆ†ç­‰ç­‰æ“ä½œã€‚é‚£ä¹ˆä¸€ä¸ªæ¨¡å‹æˆ‘ä»¬æ€ä¹ˆçŸ¥é“å®ƒå¥½ä¸å¥½ç”¨å‘¢ï¼Ÿä»¥è‡³äºæˆ‘ä»¬èƒ½ä¸èƒ½æ”¾å¿ƒçš„ä½¿ç”¨æ¨¡å‹ç»™æˆ‘çš„ç»“æœå‘¢ï¼Ÿé‚£ä¹ˆä»Šå¤©çš„å­¦ä¹ çš„è¯„ä¼°ï¼Œå°±ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚</p>
<p>åŠ è½½ä¸‹é¢çš„åº“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span>  <span class="comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;figure.figsize&#x27;</span>] = (<span class="number">10</span>, <span class="number">6</span>)  <span class="comment"># è®¾ç½®è¾“å‡ºå›¾ç‰‡å¤§å°</span></span><br></pre></td></tr></table></figure>
<p><strong>ä»»åŠ¡ï¼šåŠ è½½æ•°æ®å¹¶åˆ†å‰²æµ‹è¯•é›†å’Œè®­ç»ƒé›†</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># ä¸€èˆ¬å…ˆå–å‡ºXå’Œyåå†åˆ‡å‰²ï¼Œæœ‰äº›æƒ…å†µä¼šä½¿ç”¨åˆ°æœªåˆ‡å‰²çš„ï¼Œè¿™æ—¶å€™Xå’Œyå°±å¯ä»¥ç”¨,xæ˜¯æ¸…æ´—å¥½çš„æ•°æ®ï¼Œyæ˜¯æˆ‘ä»¬è¦é¢„æµ‹çš„å­˜æ´»æ•°æ®&#x27;Survived&#x27;</span></span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;clear_data.csv&#x27;</span>)</span><br><span class="line">train = pd.read_csv(<span class="string">&#x27;train.csv&#x27;</span>)</span><br><span class="line">X = data</span><br><span class="line">y = train[<span class="string">&#x27;Survived&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># å¯¹æ•°æ®é›†è¿›è¡Œåˆ‡å‰²</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, stratify=y, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># é»˜è®¤å‚æ•°é€»è¾‘å›å½’æ¨¡å‹</span></span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">lr.fit(X_train, y_train)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>/root/.pyenv/versions/3.11.1/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:465: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</code></pre><h3 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h3><ul>
<li>æ¨¡å‹è¯„ä¼°æ˜¯ä¸ºäº†çŸ¥é“æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</li>
<li>äº¤å‰éªŒè¯ï¼ˆcross-validationï¼‰æ˜¯ä¸€ç§è¯„ä¼°æ³›åŒ–æ€§èƒ½çš„ç»Ÿè®¡å­¦æ–¹æ³•ï¼Œå®ƒæ¯”å•æ¬¡åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ–¹æ³•æ›´åŠ ç¨³å®šã€å…¨é¢ã€‚</li>
<li>åœ¨äº¤å‰éªŒè¯ä¸­ï¼Œæ•°æ®è¢«å¤šæ¬¡åˆ’åˆ†ï¼Œå¹¶ä¸”éœ€è¦è®­ç»ƒå¤šä¸ªæ¨¡å‹ã€‚</li>
<li>æœ€å¸¸ç”¨çš„äº¤å‰éªŒè¯æ˜¯ k æŠ˜äº¤å‰éªŒè¯ï¼ˆk-fold cross-validationï¼‰ï¼Œå…¶ä¸­ k æ˜¯ç”±ç”¨æˆ·æŒ‡å®šçš„æ•°å­—ï¼Œé€šå¸¸å– 5 æˆ– 10ã€‚</li>
<li>å‡†ç¡®ç‡ï¼ˆprecisionï¼‰åº¦é‡çš„æ˜¯è¢«é¢„æµ‹ä¸ºæ­£ä¾‹çš„æ ·æœ¬ä¸­æœ‰å¤šå°‘æ˜¯çœŸæ­£çš„æ­£ä¾‹</li>
<li>å¬å›ç‡ï¼ˆrecallï¼‰åº¦é‡çš„æ˜¯æ­£ç±»æ ·æœ¬ä¸­æœ‰å¤šå°‘è¢«é¢„æµ‹ä¸ºæ­£ç±»</li>
<li>f-åˆ†æ•°æ˜¯å‡†ç¡®ç‡ä¸å¬å›ç‡çš„è°ƒå’Œå¹³å‡</li>
</ul>
<p>ã€æ€è€ƒã€‘ï¼šå°†ä¸Šé¢çš„æ¦‚å¿µè¿›ä¸€æ­¥çš„ç†è§£ï¼Œå¤§å®¶å¯ä»¥åšä¸€ä¸‹æ€»ç»“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”ï¼š</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡ä¸€ï¼šäº¤å‰éªŒè¯"><a href="#ä»»åŠ¡ä¸€ï¼šäº¤å‰éªŒè¯" class="headerlink" title="ä»»åŠ¡ä¸€ï¼šäº¤å‰éªŒè¯"></a>ä»»åŠ¡ä¸€ï¼šäº¤å‰éªŒè¯</h4><ul>
<li>ç”¨10æŠ˜äº¤å‰éªŒè¯æ¥è¯„ä¼°ä¹‹å‰çš„é€»è¾‘å›å½’æ¨¡å‹</li>
<li>è®¡ç®—äº¤å‰éªŒè¯ç²¾åº¦çš„å¹³å‡å€¼</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æç¤ºï¼šäº¤å‰éªŒè¯</span></span><br><span class="line">Image(<span class="string">&#x27;Snipaste_2020-01-05_16-37-56.png&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0---%E8%AF%84%E4%BB%B7-%E8%AF%BE%E7%A8%8B/ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_16_0.png" alt="ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_16_0"></p>
<h4 id="æç¤º4"><a href="#æç¤º4" class="headerlink" title="æç¤º4"></a>æç¤º4</h4><ul>
<li>äº¤å‰éªŒè¯åœ¨sklearnä¸­çš„æ¨¡å—ä¸º<code>sklearn.model_selection</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">lr = LogisticRegression(C=<span class="number">100</span>)</span><br><span class="line">scores = cross_val_score(lr, X_train, y_train, cv=<span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># å¹³å‡äº¤å‰éªŒè¯åˆ†æ•°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Average cross-validation score: &#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(scores.mean()))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Average cross-validation score: 0.78
</code></pre><h4 id="æ€è€ƒ4"><a href="#æ€è€ƒ4" class="headerlink" title="æ€è€ƒ4"></a>æ€è€ƒ4</h4><ul>
<li>kæŠ˜è¶Šå¤šçš„æƒ…å†µä¸‹ä¼šå¸¦æ¥ä»€ä¹ˆæ ·çš„å½±å“ï¼Ÿ</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="comment"># å½“ k è¶Šå¤§æ—¶ï¼š</span></span><br><span class="line"><span class="comment"># 1. æ¯æ¬¡è®­ç»ƒä½¿ç”¨çš„æ•°æ®æ›´å¤šï¼Œè¯„ä¼°åå·®ï¼ˆbiasï¼‰é™ä½</span></span><br><span class="line"><span class="comment"># 2. æ¯æ¬¡æµ‹è¯•é›†æ ·æœ¬æ›´å°‘ï¼Œè¯„ä¼°æ–¹å·®ï¼ˆvarianceï¼‰å¢å¤§</span></span><br><span class="line"><span class="comment"># 3. éœ€è¦è®­ç»ƒ k ä¸ªæ¨¡å‹ï¼Œè®¡ç®—å¼€é”€æ˜¾è‘—å¢åŠ </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡äºŒï¼šæ··æ·†çŸ©é˜µ"><a href="#ä»»åŠ¡äºŒï¼šæ··æ·†çŸ©é˜µ" class="headerlink" title="ä»»åŠ¡äºŒï¼šæ··æ·†çŸ©é˜µ"></a>ä»»åŠ¡äºŒï¼šæ··æ·†çŸ©é˜µ</h4><ul>
<li>è®¡ç®—äºŒåˆ†ç±»é—®é¢˜çš„æ··æ·†çŸ©é˜µ</li>
<li>è®¡ç®—ç²¾ç¡®ç‡ã€å¬å›ç‡ä»¥åŠf-åˆ†æ•°</li>
</ul>
<p>ã€æ€è€ƒã€‘ä»€ä¹ˆæ˜¯äºŒåˆ†ç±»é—®é¢˜çš„æ··æ·†çŸ©é˜µï¼Œç†è§£è¿™ä¸ªæ¦‚å¿µï¼ŒçŸ¥é“å®ƒä¸»è¦æ˜¯è¿ç®—åˆ°ä»€ä¹ˆä»»åŠ¡ä¸­çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="comment"># æ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰æ˜¯ä¸€ä¸ª 2Ã—2 çš„è¡¨æ ¼ï¼Œç”¨äºäºŒåˆ†ç±»ä»»åŠ¡ä¸­å±•ç¤ºæ¨¡å‹é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾çš„å¯¹åº”å…³ç³»ï¼š</span></span><br><span class="line"><span class="comment">#    - True Positive (TP)ï¼šçœŸå®ä¸ºæ­£ç±»ï¼Œé¢„æµ‹ä¹Ÿä¸ºæ­£ç±»</span></span><br><span class="line"><span class="comment">#    - False Positive (FP)ï¼šçœŸå®ä¸ºè´Ÿç±»ï¼Œå´è¢«è¯¯é¢„æµ‹ä¸ºæ­£ç±»</span></span><br><span class="line"><span class="comment">#    - False Negative (FN)ï¼šçœŸå®ä¸ºæ­£ç±»ï¼Œå´è¢«è¯¯é¢„æµ‹ä¸ºè´Ÿç±»</span></span><br><span class="line"><span class="comment">#    - True Negative (TN)ï¼šçœŸå®ä¸ºè´Ÿç±»ï¼Œé¢„æµ‹ä¹Ÿä¸ºè´Ÿç±»</span></span><br><span class="line"><span class="comment"># é€šè¿‡æ··æ·†çŸ©é˜µï¼Œå¯ä»¥è¿›ä¸€æ­¥è®¡ç®—ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰ã€å¬å›ç‡ï¼ˆRecallï¼‰ã€F1 åˆ†æ•°ç­‰æŒ‡æ ‡ï¼Œ</span></span><br><span class="line"><span class="comment"># å¸®åŠ©æˆ‘ä»¬è¯„ä¼°æ¨¡å‹åœ¨ä¸åŒç±»å‹é”™è¯¯ä¸Šçš„è¡¨ç°ï¼Œå¸¸ç”¨äºåˆ†ç±»æ¨¡å‹çš„æ€§èƒ½è¯„ä¼°å’Œé”™è¯¯åˆ†æã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æç¤ºï¼šæ··æ·†çŸ©é˜µ</span></span><br><span class="line">Image(<span class="string">&#x27;Snipaste_2020-01-05_16-38-26.png&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0---%E8%AF%84%E4%BB%B7-%E8%AF%BE%E7%A8%8B/ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_27_0.png" alt="ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_27_0"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æç¤ºï¼šå‡†ç¡®ç‡ (Accuracy),ç²¾ç¡®åº¦ï¼ˆPrecisionï¼‰,Recall,f-åˆ†æ•°è®¡ç®—æ–¹æ³•</span></span><br><span class="line">Image(<span class="string">&#x27;Snipaste_2020-01-05_16-39-27.png&#x27;</span>)</span><br><span class="line">â€‹    </span><br></pre></td></tr></table></figure>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0---%E8%AF%84%E4%BB%B7-%E8%AF%BE%E7%A8%8B/ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_28_0.png" alt="ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_28_0"></p>
<h4 id="æç¤º5"><a href="#æç¤º5" class="headerlink" title="æç¤º5"></a>æç¤º5</h4><ul>
<li>æ··æ·†çŸ©é˜µçš„æ–¹æ³•åœ¨sklearnä¸­çš„<code>sklearn.metrics</code>æ¨¡å—</li>
<li>æ··æ·†çŸ©é˜µéœ€è¦è¾“å…¥çœŸå®æ ‡ç­¾å’Œé¢„æµ‹æ ‡ç­¾</li>
<li>ç²¾ç¡®ç‡ã€å¬å›ç‡ä»¥åŠf-åˆ†æ•°å¯ä½¿ç”¨<code>classification_report</code>æ¨¡å—</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">lr = LogisticRegression(C=<span class="number">100</span>)</span><br><span class="line">lr.fit(X_train, y_train)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>/root/.pyenv/versions/3.11.1/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:465: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹ç»“æœ</span></span><br><span class="line">pred = lr.predict(X_train)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># æ··æ·†çŸ©é˜µ</span></span><br><span class="line">confusion_matrix(y_train, pred)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>array([[355,  57],
       [ 82, 174]])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line"><span class="comment"># ç²¾ç¡®ç‡ã€å¬å›ç‡ä»¥åŠf1-score</span></span><br><span class="line"><span class="built_in">print</span>(classification_report(y_train, pred))</span><br></pre></td></tr></table></figure>
<pre><code>              precision    recall  f1-score   support

           0       0.81      0.86      0.84       412
           1       0.75      0.68      0.71       256

    accuracy                           0.79       668
   macro avg       0.78      0.77      0.78       668
weighted avg       0.79      0.79      0.79       668
</code></pre><p>ã€æ€è€ƒã€‘</p>
<ul>
<li>å¦‚æœè‡ªå·±å®ç°æ··æ·†çŸ©é˜µçš„æ—¶å€™è¯¥æ³¨æ„ä»€ä¹ˆé—®é¢˜</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="comment"># å¦‚æœè‡ªå·±å®ç°æ··æ·†çŸ©é˜µï¼Œéœ€è¦æ³¨æ„ï¼š</span></span><br><span class="line"><span class="comment"># 1. æ˜ç¡®è¡Œåˆ—å«ä¹‰ï¼šé€šå¸¸è¡Œæ˜¯çœŸå®æ ‡ç­¾ï¼Œåˆ—æ˜¯é¢„æµ‹æ ‡ç­¾ï¼Œå¹¶ä¿æŒä¸€è‡´ã€‚</span></span><br><span class="line"><span class="comment"># 2. ç±»åˆ«é¡ºåºè¦å›ºå®šï¼šæœ€å¥½æŒ‡å®š labels åˆ—è¡¨ï¼Œé¿å…ç±»åˆ«ç¨€ç–æ—¶é”™ä½ã€‚</span></span><br><span class="line"><span class="comment"># 3. åˆå§‹åŒ–å¤§å°ä¸º n_classesÃ—n_classes çš„é›¶çŸ©é˜µã€‚</span></span><br><span class="line"><span class="comment"># 4. ç´¢å¼•æ—¶ä½¿ç”¨æ•´æ•°æˆ–ç»Ÿä¸€çš„ç±»åˆ«æ˜ å°„ï¼Œé¿å…ç±»å‹ä¸ä¸€è‡´ã€‚</span></span><br><span class="line"><span class="comment"># 5. å¯¹æ¯ä¸ªæ ·æœ¬ç´¯åŠ åˆ°å¯¹åº”çš„ [çœŸå®, é¢„æµ‹] å•å…ƒæ ¼ï¼Œæœ€åçŸ©é˜µå…ƒç´ ä¹‹å’Œåº”ç­‰äºæ ·æœ¬æ•°ã€‚</span></span><br><span class="line"><span class="comment"># 6. å¯¹äºæœªå‡ºç°çš„ç±»åˆ«ï¼ŒçŸ©é˜µå¯¹åº”è¡Œæˆ–åˆ—åº”ä¿ç•™ 0ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡ä¸‰ï¼šROCæ›²çº¿"><a href="#ä»»åŠ¡ä¸‰ï¼šROCæ›²çº¿" class="headerlink" title="ä»»åŠ¡ä¸‰ï¼šROCæ›²çº¿"></a>ä»»åŠ¡ä¸‰ï¼šROCæ›²çº¿</h4><ul>
<li>ç»˜åˆ¶ROCæ›²çº¿</li>
</ul>
<p>ã€æ€è€ƒã€‘ä»€ä¹ˆæ˜¯ROCæ›²çº¿ï¼ŒOCRæ›²çº¿çš„å­˜åœ¨æ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒ</span></span><br><span class="line"><span class="comment"># ROCæ›²çº¿ï¼ˆReceiver Operating Characteristic Curveï¼‰æ˜¯ä¸€æ¡ä»¥å‡æ­£ä¾‹ç‡ï¼ˆFPRï¼‰ä¸ºæ¨ªåæ ‡ã€</span></span><br><span class="line"><span class="comment"># çœŸæ­£ä¾‹ç‡ï¼ˆTPRï¼‰ä¸ºçºµåæ ‡ç»˜åˆ¶çš„æ›²çº¿ï¼Œå±•ç¤ºæ¨¡å‹åœ¨ä¸åŒé˜ˆå€¼ä¸‹çš„åˆ†ç±»æ€§èƒ½å˜åŒ–ã€‚</span></span><br><span class="line"><span class="comment"># å®ƒè§£å†³äº†å•ä¸€é˜ˆå€¼ä¸‹è¯„ä¼°ä¸å…¨é¢çš„é—®é¢˜ï¼Œé€šè¿‡æ›²çº¿ä¸‹çš„é¢ç§¯ï¼ˆAUCï¼‰èƒ½å¤Ÿè¡¡é‡æ¨¡å‹æ•´ä½“åŒºåˆ†æ­£è´Ÿæ ·æœ¬çš„èƒ½åŠ›ï¼›</span></span><br><span class="line"><span class="comment"># å¯¹ç±»åˆ«ä¸å¹³è¡¡æ›´ç¨³å¥ï¼Œå¯åœ¨ä¸åŒæ¨¡å‹æˆ–å‚æ•°è®¾ç½®é—´è¿›è¡Œå®¢è§‚æ¯”è¾ƒã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="æç¤º6"><a href="#æç¤º6" class="headerlink" title="æç¤º6"></a>æç¤º6</h4><ul>
<li>ROCæ›²çº¿åœ¨sklearnä¸­çš„æ¨¡å—ä¸º<code>sklearn.metrics</code></li>
<li>ROCæ›²çº¿ä¸‹é¢æ‰€åŒ…å›´çš„é¢ç§¯è¶Šå¤§è¶Šå¥½</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_curve</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(lr.decision_function(X_test))</span><br></pre></td></tr></table></figure>
<pre><code>[-1.7776276  -1.68901519 -2.9343385  -2.73339993 -0.7425476   0.1771919
  0.42300886 -0.95177507 -2.19297241 -2.09492243 -2.09876666 -2.24379328
 -0.72898893 -0.74448703  1.55206252  2.26736362 -3.0615053  -1.45551632
  1.82143942  1.10174703  2.80348253  2.20862227 -2.08595792 -1.98565326
 -2.62459231  2.61608127  2.52054836  0.46386814 -2.26805651 -1.89799476
 -4.40221097 -2.45118004 -2.11507984  0.25727282  1.56507901 -3.49922092
  0.09517543  3.1727335  -0.66659502 -2.16889122 -2.31738004 -0.75154631
  1.34173247 -0.68691348 -2.38317701 -1.48352807  3.30441868  0.37836543
  0.15120699 -2.39554116  0.71230509 -2.94049784  0.0526656  -0.12124772
  0.21937853 -0.95736671 -2.91315052  1.73227025 -2.30451919 -0.11949728
 -2.40406452 -1.23217853 -3.04709277 -2.51149884 -2.91275507  0.36741872
  1.88515182 -1.73344723  1.61180838 -2.64456699 -2.82671595 -1.32885535
 -1.89201447 -2.38194062  1.14830497  0.7324757   3.41575634 -0.04718518
  1.99047031  0.71098531 -2.5002286   2.11220527  1.35687779 -4.65208202
 -0.50164169 -2.21847127 -0.27744568 -2.1098023  -2.28203956 -2.24087733
  1.49913758 -0.46745632 -1.76590269 -3.13694507 -2.48969764 -2.52447108
 -0.31359417 -2.62456277  0.10812447 -3.22505518 -0.54301462 -1.31398633
 -2.45637232 -0.9392769  -1.99910791 -0.01952273  0.16386412  1.17043699
  0.83571934 -0.30892412 -2.56236834 -2.52630696 -2.15878988  3.38005162
 -1.63316112 -2.0470374   1.16802525  1.96428556 -0.85542758 -0.84711271
 -2.3923425  -2.27467461  1.27340371 -0.16738478  2.77379952 -0.91636487
  3.49337899  2.22265823 -1.03898765 -1.79576035  3.05405598 -1.72625544
 -2.08233698  0.14427761 -2.03826492 -1.87510703 -2.43040363  0.88364821
 -2.31722422  1.21479438 -2.19509856 -1.96948465  2.90456606  1.22909197
 -0.60993113 -2.40508898  1.79832298 -2.33619419 -1.76964851  0.54894164
  0.56920781 -1.65544357 -2.18783672 -2.51890544 -1.1167812   1.85506633
 -2.14366192  2.56003678  1.79741811  2.22038003 -0.93948297  2.11029939
  3.66773152  3.37255532 -1.62079149 -0.21922341 -2.93532548 -1.8851028
 -0.11223495 -0.89402373 -2.79168773  0.58319665 -1.20213471  2.11583429
 -1.78550619 -1.21648746 -2.91538781 -2.80005448 -2.74359191 -0.06775047
 -1.28645408 -1.17048578 -0.1176852  -1.59958242 -0.65901928 -2.40701243
  0.57575073 -3.0756839   1.53932753 -2.49031769 -3.03266822  0.30539932
 -0.05523861 -0.24431132 -2.36483723  3.25595248 -2.11664845 -1.97728592
 -2.04509461 -3.07727841 -1.11942703 -3.38920295 -2.59088459 -3.55978164
  0.22449105 -0.3214215   0.05735696  0.02061023 -3.01544378 -0.77973619
 -1.39798016 -3.10075724 -4.80621573 -3.01948006  3.44366918 -2.88193813
 -2.01992513 -0.09559774  0.91447527 -1.13270082 -2.45426968 -1.91415803
 -0.08403516]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># è®¡ç®—ROCæ›²çº¿çš„å‡æ­£ä¾‹ç‡(FPR)ã€çœŸæ­£ä¾‹ç‡(TPR)å’Œé˜ˆå€¼</span></span><br><span class="line">fpr, tpr, thresholds = roc_curve(y_test, lr.decision_function(X_test))</span><br><span class="line">plt.plot(fpr, tpr, label=<span class="string">&quot;ROC Curve&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;FPR&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;TPR (recall)&quot;</span>)</span><br><span class="line"><span class="comment"># æ‰¾åˆ°æœ€æ¥è¿‘äº0çš„é˜ˆå€¼</span></span><br><span class="line">close_zero = np.argmin(np.<span class="built_in">abs</span>(thresholds))</span><br><span class="line">plt.plot(fpr[close_zero], tpr[close_zero], <span class="string">&#x27;o&#x27;</span>, markersize=<span class="number">10</span>, label=<span class="string">&quot;threshold zero&quot;</span>, fillstyle=<span class="string">&quot;none&quot;</span>, c=<span class="string">&#x27;k&#x27;</span>, mew=<span class="number">2</span>)</span><br><span class="line">plt.legend(loc=<span class="number">4</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0---%E8%AF%84%E4%BB%B7-%E8%AF%BE%E7%A8%8B/ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_44_3.png" alt="ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°---è¯„ä»·-è¯¾ç¨‹_44_3"></p>
<h4 id="æ€è€ƒ6"><a href="#æ€è€ƒ6" class="headerlink" title="æ€è€ƒ6"></a>æ€è€ƒ6</h4><ul>
<li>å¯¹äºå¤šåˆ†ç±»é—®é¢˜å¦‚ä½•ç»˜åˆ¶ROCæ›²çº¿</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ã€æ€è€ƒã€‘ä½ èƒ½ä»è¿™æ¡OCRæ›²çº¿çš„åˆ°ä»€ä¹ˆä¿¡æ¯ï¼Ÿè¿™äº›ä¿¡æ¯å¯ä»¥åšä»€ä¹ˆï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="comment"># ä»ROCæ›²çº¿ä¸­å¯ä»¥å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</span></span><br><span class="line"><span class="comment"># 1. æ¨¡å‹æ•´ä½“æ€§èƒ½ï¼šæ›²çº¿ä¸‹çš„é¢ç§¯ (AUC - Area Under the Curve) æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„è¯„ä¼°æŒ‡æ ‡ã€‚</span></span><br><span class="line"><span class="comment">#    - AUC = 1ï¼šå®Œç¾åˆ†ç±»å™¨ã€‚</span></span><br><span class="line"><span class="comment">#    - AUC = 0.5ï¼šéšæœºåˆ†ç±»å™¨ï¼ˆæ— åŒºåˆ†èƒ½åŠ›ï¼ŒROCæ›²çº¿æ¥è¿‘å¯¹è§’çº¿ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#    - AUC &gt; 0.5ï¼šæ¨¡å‹ä¼˜äºéšæœºçŒœæµ‹ã€‚AUCè¶Šå¤§ï¼Œæ¨¡å‹åŒºåˆ†æ­£è´Ÿæ ·æœ¬çš„èƒ½åŠ›è¶Šå¼ºã€‚</span></span><br><span class="line"><span class="comment">#    - AUC &lt; 0.5ï¼šæ¨¡å‹è¡¨ç°å·®äºéšæœºçŒœæµ‹ï¼ˆå¯èƒ½æ ‡ç­¾åäº†æˆ–è€…æ¨¡å‹éå¸¸å·®ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># 2. ä¸åŒé˜ˆå€¼ä¸‹çš„æƒè¡¡ï¼šROCæ›²çº¿å±•ç¤ºäº†åœ¨æ‰€æœ‰å¯èƒ½çš„åˆ†ç±»é˜ˆå€¼ä¸‹ï¼ŒçœŸæ­£ä¾‹ç‡ (TPR) ä¸å‡æ­£ä¾‹ç‡ (FPR) ä¹‹é—´çš„å…³ç³»ã€‚</span></span><br><span class="line"><span class="comment">#    - æ›²çº¿ä¸Šçš„æ¯ä¸ªç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å®šçš„é˜ˆå€¼ã€‚</span></span><br><span class="line"><span class="comment">#    - æ›²çº¿è¶Šé è¿‘å·¦ä¸Šè§’ (FPRä½, TPRé«˜)ï¼Œè¯´æ˜æ¨¡å‹åœ¨è¾ƒä½çš„å‡æ­£ä¾‹ç‡ä¸‹èƒ½è¾¾åˆ°è¾ƒé«˜çš„çœŸæ­£ä¾‹ç‡ï¼Œæ€§èƒ½è¶Šå¥½ã€‚</span></span><br><span class="line"><span class="comment"># 3. æ¨¡å‹çš„åŒºåˆ†èƒ½åŠ›ï¼šæ›²çº¿çš„å½¢çŠ¶å¯ä»¥åæ˜ æ¨¡å‹åŒºåˆ†æ­£è´Ÿæ ·æœ¬çš„èƒ½åŠ›ã€‚å¦‚æœæ›²çº¿æ˜¾è‘—é«˜äºå¯¹è§’çº¿ï¼Œè¯´æ˜æ¨¡å‹å…·æœ‰è¾ƒå¥½çš„åŒºåˆ†èƒ½åŠ›ã€‚</span></span><br><span class="line"><span class="comment"># 4. é˜ˆå€¼é€‰æ‹©çš„ä¾æ®ï¼šå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œåœ¨ROCæ›²çº¿ä¸Šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å¹³è¡¡ç‚¹ï¼ˆå³é€‰æ‹©ä¸€ä¸ªé˜ˆå€¼ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#    - ä¾‹å¦‚ï¼Œå¦‚æœæ›´å…³æ³¨å‡å°‘æ¼æŠ¥ï¼ˆæé«˜TPRï¼‰ï¼Œå¯ä»¥é€‰æ‹©æ›²çº¿ä¸ŠTPRè¾ƒé«˜çš„ç‚¹ï¼Œå³ä½¿FPRå¯èƒ½ç•¥é«˜ã€‚</span></span><br><span class="line"><span class="comment">#    - å¦‚æœæ›´å…³æ³¨å‡å°‘è¯¯æŠ¥ï¼ˆé™ä½FPRï¼‰ï¼Œå¯ä»¥é€‰æ‹©æ›²çº¿ä¸ŠFPRè¾ƒä½çš„ç‚¹ï¼Œå³ä½¿TPRå¯èƒ½ç•¥ä½ã€‚</span></span><br><span class="line"><span class="comment">#    - å›¾ä¸­æ ‡è®°çš„ &quot;threshold zero&quot; ç‚¹é€šå¸¸æ˜¯æ¨¡å‹é»˜è®¤çš„åˆ†ç±»é˜ˆå€¼å¯¹åº”çš„æ€§èƒ½ç‚¹ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%B8%89%E8%8A%82%E6%95%B0%E6%8D%AE%E9%87%8D%E6%9E%842-%E8%AF%BE%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%B8%89%E8%8A%82%E6%95%B0%E6%8D%AE%E9%87%8D%E6%9E%842-%E8%AF%BE%E7%A8%8B/" class="post-title-link" itemprop="url">æ•°æ®åˆ†æâ€”â€”ç¬¬äºŒç« ï¼šç¬¬ä¸‰èŠ‚æ•°æ®é‡æ„2</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00 / ä¿®æ”¹æ—¶é—´ï¼š17:06:45" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/" itemprop="url" rel="index"><span itemprop="name">kaggle</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/titanic/" itemprop="url" rel="index"><span itemprop="name">titanic</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>å¤ä¹ ï¼š</strong>åœ¨å‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†PandasåŸºç¡€ï¼Œç¬¬äºŒç« æˆ‘ä»¬å¼€å§‹è¿›å…¥æ•°æ®åˆ†æçš„ä¸šåŠ¡éƒ¨åˆ†ï¼Œåœ¨ç¬¬äºŒç« ç¬¬ä¸€èŠ‚çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†<strong>æ•°æ®çš„æ¸…æ´—</strong>ï¼Œè¿™ä¸€éƒ¨åˆ†ååˆ†é‡è¦ï¼Œåªæœ‰æ•°æ®å˜å¾—ç›¸å¯¹å¹²å‡€ï¼Œæˆ‘ä»¬ä¹‹åå¯¹æ•°æ®çš„åˆ†ææ‰å¯ä»¥æ›´æœ‰åŠ›ã€‚è€Œè¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯æ•°æ®é‡æ„ï¼Œæ•°æ®é‡æ„ä¾æ—§å±äºæ•°æ®ç†è§£ï¼ˆå‡†å¤‡ï¼‰çš„èŒƒå›´ã€‚</p>
<h4 id="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®"><a href="#å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®" class="headerlink" title="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®"></a>å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥åŸºæœ¬åº“</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½½å…¥ä¸Šä¸€ä¸ªä»»åŠ¡äººä¿å­˜çš„æ–‡ä»¶ä¸­:result.csvï¼Œå¹¶æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line">text = pd.read_csv(<span class="string">&#x27;result.csv&#x27;</span>)</span><br><span class="line">text.head()</span><br></pre></td></tr></table></figure>
<p><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table></p>
<h1 id="2-ç¬¬äºŒç« ï¼šæ•°æ®é‡æ„"><a href="#2-ç¬¬äºŒç« ï¼šæ•°æ®é‡æ„" class="headerlink" title="2 ç¬¬äºŒç« ï¼šæ•°æ®é‡æ„"></a>2 ç¬¬äºŒç« ï¼šæ•°æ®é‡æ„</h1><h2 id="ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®èšåˆä¸è¿ç®—"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®èšåˆä¸è¿ç®—" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®èšåˆä¸è¿ç®—"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®èšåˆä¸è¿ç®—</h2><h3 id="2-6-æ•°æ®è¿ç”¨"><a href="#2-6-æ•°æ®è¿ç”¨" class="headerlink" title="2.6 æ•°æ®è¿ç”¨"></a>2.6 æ•°æ®è¿ç”¨</h3><h4 id="2-6-1-ä»»åŠ¡ä¸€ï¼šé€šè¿‡æ•™æã€ŠPython-for-Data-Analysisã€‹P303ã€Google-or-anythingæ¥å­¦ä¹ äº†è§£GroupByæœºåˆ¶"><a href="#2-6-1-ä»»åŠ¡ä¸€ï¼šé€šè¿‡æ•™æã€ŠPython-for-Data-Analysisã€‹P303ã€Google-or-anythingæ¥å­¦ä¹ äº†è§£GroupByæœºåˆ¶" class="headerlink" title="2.6.1 ä»»åŠ¡ä¸€ï¼šé€šè¿‡æ•™æã€ŠPython for Data Analysisã€‹P303ã€Google or anythingæ¥å­¦ä¹ äº†è§£GroupByæœºåˆ¶"></a>2.6.1 ä»»åŠ¡ä¸€ï¼šé€šè¿‡æ•™æã€ŠPython for Data Analysisã€‹P303ã€Google or anythingæ¥å­¦ä¹ äº†è§£GroupByæœºåˆ¶</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥å¿ƒå¾—</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">GroupByæœºåˆ¶æ˜¯Pandasä¸­ç”¨äºæ•°æ®åˆ†ç»„ä¸èšåˆçš„æ ¸å¿ƒæ“ä½œï¼Œå…¶æœ¬è´¨æ˜¯éµå¾ª&quot;Split-Apply-Combine&quot;æ¨¡å¼ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Splitï¼šæŒ‰æŒ‡å®šé”®ï¼ˆåˆ—ã€å‡½æ•°ã€æ•°ç»„ç­‰ï¼‰å°†æ•°æ®åˆ†å‰²æˆå¤šä¸ªå­é›†</span></span><br><span class="line"><span class="string">Applyï¼šå¯¹æ¯ä¸ªå­é›†ç‹¬ç«‹åº”ç”¨èšåˆå‡½æ•°ï¼ˆå¦‚mean/maxï¼‰ã€è½¬æ¢å‡½æ•°ï¼ˆå¦‚æ ‡å‡†åŒ–ï¼‰æˆ–è¿‡æ»¤æ“ä½œ</span></span><br><span class="line"><span class="string">Combineï¼šå°†ç»“æœåˆå¹¶ä¸ºæ–°çš„æ•°æ®ç»“æ„</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-4-2ï¼šä»»åŠ¡äºŒï¼šè®¡ç®—æ³°å¦å°¼å…‹å·ç”·æ€§ä¸å¥³æ€§çš„å¹³å‡ç¥¨ä»·"><a href="#2-4-2ï¼šä»»åŠ¡äºŒï¼šè®¡ç®—æ³°å¦å°¼å…‹å·ç”·æ€§ä¸å¥³æ€§çš„å¹³å‡ç¥¨ä»·" class="headerlink" title="2.4.2ï¼šä»»åŠ¡äºŒï¼šè®¡ç®—æ³°å¦å°¼å…‹å·ç”·æ€§ä¸å¥³æ€§çš„å¹³å‡ç¥¨ä»·"></a>2.4.2ï¼šä»»åŠ¡äºŒï¼šè®¡ç®—æ³°å¦å°¼å…‹å·ç”·æ€§ä¸å¥³æ€§çš„å¹³å‡ç¥¨ä»·</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line">df  = text[<span class="string">&#x27;Fare&#x27;</span>].groupby(text[<span class="string">&#x27;Sex&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df.groups)</span><br><span class="line">means = df.mean()</span><br><span class="line">means</span><br></pre></td></tr></table></figure>
<pre><code>&#123;&#39;female&#39;: [1, 2, 3, 8, 9, 10, 11, 14, 15, 18, 19, 22, 24, 25, 28, 31, 32, 38, 39, 40, 41, 43, 44, 47, 49, 52, 53, 56, 58, 61, 66, 68, 71, 79, 82, 84, 85, 88, 98, 100, 106, 109, 111, 113, 114, 119, 123, 128, 132, 133, 136, 140, 141, 142, 147, 151, 156, 161, 166, 167, 172, 177, 180, 184, 186, 190, 192, 194, 195, 198, 199, 205, 208, 211, 215, 216, 218, 229, 230, 233, 235, 237, 240, 241, 246, 247, 251, 254, 255, 256, 257, 258, 259, 264, 268, 269, 272, 274, 275, 276, ...], &#39;male&#39;: [0, 4, 5, 6, 7, 12, 13, 16, 17, 20, 21, 23, 26, 27, 29, 30, 33, 34, 35, 36, 37, 42, 45, 46, 48, 50, 51, 54, 55, 57, 59, 60, 62, 63, 64, 65, 67, 69, 70, 72, 73, 74, 75, 76, 77, 78, 80, 81, 83, 86, 87, 89, 90, 91, 92, 93, 94, 95, 96, 97, 99, 101, 102, 103, 104, 105, 107, 108, 110, 112, 115, 116, 117, 118, 120, 121, 122, 124, 125, 126, 127, 129, 130, 131, 134, 135, 137, 138, 139, 143, 144, 145, 146, 148, 149, 150, 152, 153, 154, 155, ...]&#125;

Sex
female    44.479818
male      25.523893
Name: Fare, dtype: float64
</code></pre><p>åœ¨äº†è§£GroupByæœºåˆ¶ä¹‹åï¼Œè¿ç”¨è¿™ä¸ªæœºåˆ¶å®Œæˆä¸€ç³»åˆ—çš„æ“ä½œï¼Œæ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚</p>
<p>ä¸‹é¢é€šè¿‡å‡ ä¸ªä»»åŠ¡æ¥ç†Ÿæ‚‰GroupByæœºåˆ¶ã€‚</p>
<h4 id="2-4-3ï¼šä»»åŠ¡ä¸‰ï¼šç»Ÿè®¡æ³°å¦å°¼å…‹å·ä¸­ç”·å¥³çš„å­˜æ´»äººæ•°"><a href="#2-4-3ï¼šä»»åŠ¡ä¸‰ï¼šç»Ÿè®¡æ³°å¦å°¼å…‹å·ä¸­ç”·å¥³çš„å­˜æ´»äººæ•°" class="headerlink" title="2.4.3ï¼šä»»åŠ¡ä¸‰ï¼šç»Ÿè®¡æ³°å¦å°¼å…‹å·ä¸­ç”·å¥³çš„å­˜æ´»äººæ•°"></a>2.4.3ï¼šä»»åŠ¡ä¸‰ï¼šç»Ÿè®¡æ³°å¦å°¼å…‹å·ä¸­ç”·å¥³çš„å­˜æ´»äººæ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line">survived_sex = text[<span class="string">&#x27;Survived&#x27;</span>].groupby(text[<span class="string">&#x27;Sex&#x27;</span>]).<span class="built_in">sum</span>()</span><br><span class="line">survived_sex.head()</span><br></pre></td></tr></table></figure>
<pre><code>Sex
female    233
male      109
Name: Survived, dtype: int64
</code></pre><h4 id="2-4-4ï¼šä»»åŠ¡å››ï¼šè®¡ç®—å®¢èˆ±ä¸åŒç­‰çº§çš„å­˜æ´»äººæ•°"><a href="#2-4-4ï¼šä»»åŠ¡å››ï¼šè®¡ç®—å®¢èˆ±ä¸åŒç­‰çº§çš„å­˜æ´»äººæ•°" class="headerlink" title="2.4.4ï¼šä»»åŠ¡å››ï¼šè®¡ç®—å®¢èˆ±ä¸åŒç­‰çº§çš„å­˜æ´»äººæ•°"></a>2.4.4ï¼šä»»åŠ¡å››ï¼šè®¡ç®—å®¢èˆ±ä¸åŒç­‰çº§çš„å­˜æ´»äººæ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line">survived_pclass = text[<span class="string">&#x27;Survived&#x27;</span>].groupby(text[<span class="string">&#x27;Pclass&#x27;</span>])</span><br><span class="line">survived_pclass.<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>
<pre><code>Pclass
1    136
2     87
3    119
Name: Survived, dtype: int64
</code></pre><p>ã€<strong>æç¤ºï¼š</strong>ã€‘è¡¨ä¸­çš„å­˜æ´»é‚£ä¸€æ ï¼Œå¯ä»¥å‘ç°å¦‚æœè¿˜æ´»ç€è®°ä¸º1ï¼Œæ­»äº¡è®°ä¸º0</p>
<p>ã€<strong>æ€è€ƒ</strong>ã€‘ä»æ•°æ®åˆ†æçš„è§’åº¦ï¼Œä¸Šé¢çš„ç»Ÿè®¡ç»“æœå¯ä»¥å¾—å‡ºé‚£äº›ç»“è®º</p>
<p>ã€æ€è€ƒã€‘ä»ä»»åŠ¡äºŒåˆ°ä»»åŠ¡ä¸‰ä¸­ï¼Œè¿™äº›è¿ç®—å¯ä»¥é€šè¿‡agg()å‡½æ•°æ¥åŒæ—¶è®¡ç®—ã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨renameå‡½æ•°ä¿®æ”¹åˆ—åã€‚ä½ å¯ä»¥æŒ‰ç…§æç¤ºå†™å‡ºè¿™ä¸ªè¿‡ç¨‹å—ï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå¿ƒå¾—</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">agg() å‡½æ•°æ˜¯ Pandas ä¸­ç”¨äºå¯¹åˆ†ç»„åçš„æ•°æ® åŒæ—¶æ‰§è¡Œå¤šä¸ªèšåˆæ“ä½œ çš„æ ¸å¿ƒå·¥å…·ï¼Œå…¶å…¨ç§°ä¸º Aggregateï¼ˆèšåˆï¼‰ã€‚å®ƒå…è®¸ä½ å¯¹ä¸åŒåˆ—åº”ç”¨ä¸åŒçš„èšåˆå‡½æ•°ï¼Œå¹¶æ”¯æŒè‡ªå®šä¹‰å‡½æ•°ï¼Œæå¤§æå‡æ•°æ®åˆ†ææ•ˆç‡ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">text.groupby(<span class="string">&#x27;Sex&#x27;</span>).agg(&#123;<span class="string">&#x27;Fare&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;Pclass&#x27;</span>: <span class="string">&#x27;count&#x27;</span>&#125;).rename(columns=</span><br><span class="line">                            &#123;<span class="string">&#x27;Fare&#x27;</span>: <span class="string">&#x27;mean_fare&#x27;</span>, <span class="string">&#x27;Pclass&#x27;</span>: <span class="string">&#x27;count_pclass&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>
<p><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_fare</th>
      <th>count_pclass</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>44.479818</td>
      <td>314</td>
    </tr>
    <tr>
      <th>male</th>
      <td>25.523893</td>
      <td>577</td>
    </tr>
  </tbody>
</table></p>
<h4 id="2-4-5ï¼šä»»åŠ¡äº”ï¼šç»Ÿè®¡åœ¨ä¸åŒç­‰çº§çš„ç¥¨ä¸­çš„ä¸åŒå¹´é¾„çš„èˆ¹ç¥¨èŠ±è´¹çš„å¹³å‡å€¼"><a href="#2-4-5ï¼šä»»åŠ¡äº”ï¼šç»Ÿè®¡åœ¨ä¸åŒç­‰çº§çš„ç¥¨ä¸­çš„ä¸åŒå¹´é¾„çš„èˆ¹ç¥¨èŠ±è´¹çš„å¹³å‡å€¼" class="headerlink" title="2.4.5ï¼šä»»åŠ¡äº”ï¼šç»Ÿè®¡åœ¨ä¸åŒç­‰çº§çš„ç¥¨ä¸­çš„ä¸åŒå¹´é¾„çš„èˆ¹ç¥¨èŠ±è´¹çš„å¹³å‡å€¼"></a>2.4.5ï¼šä»»åŠ¡äº”ï¼šç»Ÿè®¡åœ¨ä¸åŒç­‰çº§çš„ç¥¨ä¸­çš„ä¸åŒå¹´é¾„çš„èˆ¹ç¥¨èŠ±è´¹çš„å¹³å‡å€¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line">temp=text.groupby([<span class="string">&#x27;Pclass&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])[<span class="string">&#x27;Fare&#x27;</span>]</span><br><span class="line">temp.groups</span><br><span class="line">temp.mean().head()</span><br></pre></td></tr></table></figure>
<pre><code>Pclass  Age  
1       0.92     151.5500
        2.00     151.5500
        4.00      81.8583
        11.00    120.0000
        14.00    120.0000
Name: Fare, dtype: float64
</code></pre><h4 id="2-4-6ï¼šä»»åŠ¡å…­ï¼šå°†ä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„æ•°æ®åˆå¹¶ï¼Œå¹¶ä¿å­˜åˆ°sex-fare-survived-csv"><a href="#2-4-6ï¼šä»»åŠ¡å…­ï¼šå°†ä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„æ•°æ®åˆå¹¶ï¼Œå¹¶ä¿å­˜åˆ°sex-fare-survived-csv" class="headerlink" title="2.4.6ï¼šä»»åŠ¡å…­ï¼šå°†ä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„æ•°æ®åˆå¹¶ï¼Œå¹¶ä¿å­˜åˆ°sex_fare_survived.csv"></a>2.4.6ï¼šä»»åŠ¡å…­ï¼šå°†ä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„æ•°æ®åˆå¹¶ï¼Œå¹¶ä¿å­˜åˆ°sex_fare_survived.csv</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line">result = pd.merge(means,survived_sex,on=<span class="string">&#x27;Sex&#x27;</span>)</span><br><span class="line">result</span><br><span class="line">result.to_csv(<span class="string">&#x27;sex_fare_survived.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2-4-7ï¼šä»»åŠ¡ä¸ƒï¼šå¾—å‡ºä¸åŒå¹´é¾„çš„æ€»çš„å­˜æ´»äººæ•°ï¼Œç„¶åæ‰¾å‡ºå­˜æ´»äººæ•°æœ€å¤šçš„å¹´é¾„æ®µï¼Œæœ€åè®¡ç®—å­˜æ´»äººæ•°æœ€é«˜çš„å­˜æ´»ç‡ï¼ˆå­˜æ´»äººæ•°-æ€»äººæ•°ï¼‰"><a href="#2-4-7ï¼šä»»åŠ¡ä¸ƒï¼šå¾—å‡ºä¸åŒå¹´é¾„çš„æ€»çš„å­˜æ´»äººæ•°ï¼Œç„¶åæ‰¾å‡ºå­˜æ´»äººæ•°æœ€å¤šçš„å¹´é¾„æ®µï¼Œæœ€åè®¡ç®—å­˜æ´»äººæ•°æœ€é«˜çš„å­˜æ´»ç‡ï¼ˆå­˜æ´»äººæ•°-æ€»äººæ•°ï¼‰" class="headerlink" title="2.4.7ï¼šä»»åŠ¡ä¸ƒï¼šå¾—å‡ºä¸åŒå¹´é¾„çš„æ€»çš„å­˜æ´»äººæ•°ï¼Œç„¶åæ‰¾å‡ºå­˜æ´»äººæ•°æœ€å¤šçš„å¹´é¾„æ®µï¼Œæœ€åè®¡ç®—å­˜æ´»äººæ•°æœ€é«˜çš„å­˜æ´»ç‡ï¼ˆå­˜æ´»äººæ•°/æ€»äººæ•°ï¼‰"></a>2.4.7ï¼šä»»åŠ¡ä¸ƒï¼šå¾—å‡ºä¸åŒå¹´é¾„çš„æ€»çš„å­˜æ´»äººæ•°ï¼Œç„¶åæ‰¾å‡ºå­˜æ´»äººæ•°æœ€å¤šçš„å¹´é¾„æ®µï¼Œæœ€åè®¡ç®—å­˜æ´»äººæ•°æœ€é«˜çš„å­˜æ´»ç‡ï¼ˆå­˜æ´»äººæ•°/æ€»äººæ•°ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line">survived_age = text[<span class="string">&#x27;Survived&#x27;</span>].groupby(text[<span class="string">&#x27;Age&#x27;</span>]).<span class="built_in">sum</span>()</span><br><span class="line">survived_age.head()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Age
0.42    1
0.67    1
0.75    2
0.83    2
0.92    1
Name: Survived, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line">survived_age[survived_age.values==survived_age.<span class="built_in">max</span>()]</span><br></pre></td></tr></table></figure>
<pre><code>Age
24.0    15
Name: Survived, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_<span class="built_in">sum</span> = text[<span class="string">&#x27;Survived&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(_<span class="built_in">sum</span>)</span><br></pre></td></tr></table></figure>
<pre><code>342
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sum of person:&quot;</span>+<span class="built_in">str</span>(_<span class="built_in">sum</span>))</span><br><span class="line"></span><br><span class="line">precetn =survived_age.<span class="built_in">max</span>()/_<span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ€å¤§å­˜æ´»ç‡ï¼š&quot;</span>+<span class="built_in">str</span>(precetn))</span><br></pre></td></tr></table></figure>
<pre><code>sum of person:342
æœ€å¤§å­˜æ´»ç‡ï¼š0.043859649122807015
</code></pre>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%B8%80%E8%8A%82%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E5%8F%8A%E7%89%B9%E5%BE%81%E5%A4%84%E7%90%86-%E8%AF%BE%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%B8%80%E8%8A%82%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E5%8F%8A%E7%89%B9%E5%BE%81%E5%A4%84%E7%90%86-%E8%AF%BE%E7%A8%8B/" class="post-title-link" itemprop="url">æ•°æ®åˆ†æâ€”â€”ç¬¬äºŒç« ï¼šç¬¬ä¸€èŠ‚æ•°æ®æ¸…æ´—åŠç‰¹å¾å¤„ç†</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00 / ä¿®æ”¹æ—¶é—´ï¼š17:00:20" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/" itemprop="url" rel="index"><span itemprop="name">kaggle</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/titanic/" itemprop="url" rel="index"><span itemprop="name">titanic</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>ã€å›é¡¾&amp;å¼•è¨€ã€‘å‰é¢ä¸€ç« çš„å†…å®¹å¤§å®¶å¯ä»¥æ„Ÿè§‰åˆ°æˆ‘ä»¬ä¸»è¦æ˜¯å¯¹åŸºç¡€çŸ¥è¯†åšä¸€ä¸ªæ¢³ç†ï¼Œè®©å¤§å®¶äº†è§£æ•°æ®åˆ†æçš„ä¸€äº›æ“ä½œï¼Œä¸»è¦åšäº†æ•°æ®çš„å„ä¸ªè§’åº¦çš„è§‚å¯Ÿã€‚é‚£ä¹ˆåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯åšæ•°æ®åˆ†æçš„æµç¨‹æ€§å­¦ä¹ ï¼Œä¸»è¦æ˜¯åŒ…æ‹¬äº†æ•°æ®æ¸…æ´—ä»¥åŠæ•°æ®çš„ç‰¹å¾å¤„ç†ï¼Œæ•°æ®é‡æ„ä»¥åŠæ•°æ®å¯è§†åŒ–ã€‚è¿™äº›å†…å®¹æ˜¯ä¸ºæ•°æ®åˆ†ææœ€åçš„å»ºæ¨¡å’Œæ¨¡å‹è¯„ä»·åšä¸€ä¸ªé“ºå«ã€‚</p>
<h4 id="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®"><a href="#å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®" class="headerlink" title="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®"></a>å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŠ è½½æ‰€éœ€çš„åº“</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŠ è½½æ•°æ®train.csv</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./titanic/train.csv&#x27;</span>)</span><br><span class="line">df.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
## 2 ç¬¬äºŒç« ï¼šæ•°æ®æ¸…æ´—åŠç‰¹å¾å¤„ç†
æˆ‘ä»¬æ‹¿åˆ°çš„æ•°æ®é€šå¸¸æ˜¯ä¸å¹²å‡€çš„ï¼Œæ‰€è°“çš„ä¸å¹²å‡€ï¼Œå°±æ˜¯æ•°æ®ä¸­æœ‰ç¼ºå¤±å€¼ï¼Œæœ‰ä¸€äº›å¼‚å¸¸ç‚¹ç­‰ï¼Œéœ€è¦ç»è¿‡ä¸€å®šçš„å¤„ç†æ‰èƒ½ç»§ç»­åšåé¢çš„åˆ†ææˆ–å»ºæ¨¡ï¼Œæ‰€ä»¥æ‹¿åˆ°æ•°æ®çš„ç¬¬ä¸€æ­¥æ˜¯è¿›è¡Œæ•°æ®æ¸…æ´—ï¼Œæœ¬ç« æˆ‘ä»¬å°†å­¦ä¹ ç¼ºå¤±å€¼ã€é‡å¤å€¼ã€å­—ç¬¦ä¸²å’Œæ•°æ®è½¬æ¢ç­‰æ“ä½œï¼Œå°†æ•°æ®æ¸…æ´—æˆå¯ä»¥åˆ†ææˆ–å»ºæ¨¡çš„äºšå­ã€‚

### 2.1 ç¼ºå¤±å€¼è§‚å¯Ÿä¸å¤„ç†
æˆ‘ä»¬æ‹¿åˆ°çš„æ•°æ®ç»å¸¸ä¼šæœ‰å¾ˆå¤šç¼ºå¤±å€¼ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Cabinåˆ—å­˜åœ¨NaNï¼Œé‚£å…¶ä»–åˆ—è¿˜æœ‰æ²¡æœ‰ç¼ºå¤±å€¼ï¼Œè¿™äº›ç¼ºå¤±å€¼è¦æ€ä¹ˆå¤„ç†å‘¢

#### 2.1.1 ä»»åŠ¡ä¸€ï¼šç¼ºå¤±å€¼è§‚å¯Ÿ
(1) è¯·æŸ¥çœ‹æ¯ä¸ªç‰¹å¾ç¼ºå¤±å€¼ä¸ªæ•°  
(2) è¯·æŸ¥çœ‹Ageï¼Œ Cabinï¼Œ Embarkedåˆ—çš„æ•°æ®
ä»¥ä¸Šæ–¹å¼éƒ½æœ‰å¤šç§æ–¹å¼ï¼Œæ‰€ä»¥å¤§å®¶å¤šå¤šç›Šå–„


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df.info()</span><br></pre></td></tr></table></figure>

    <class 'pandas.core.frame.dataframe'>
    RangeIndex: 891 entries, 0 to 890
    Data columns (total 12 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   PassengerId  891 non-null    int64  
     1   Survived     891 non-null    int64  
     2   Pclass       891 non-null    int64  
     3   Name         891 non-null    object 
     4   Sex          891 non-null    object 
     5   Age          714 non-null    float64
     6   SibSp        891 non-null    int64  
     7   Parch        891 non-null    int64  
     8   Ticket       891 non-null    object 
     9   Fare         891 non-null    float64
     10  Cabin        204 non-null    object 
     11  Embarked     889 non-null    object 
    dtypes: float64(2), int64(5), object(5)
    memory usage: 83.7+ KB

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df.isnull().<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>




    PassengerId      0
    Survived         0
    Pclass           0
    Name             0
    Sex              0
    Age            177
    SibSp            0
    Parch            0
    Ticket           0
    Fare             0
    Cabin          687
    Embarked         2
    dtype: int64




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df[[<span class="string">&#x27;Age&#x27;</span>,<span class="string">&#x27;Cabin&#x27;</span>,<span class="string">&#x27;Embarked&#x27;</span>]].head(<span class="number">3</span>)</span><br><span class="line"><span class="comment">#df[&#x27;Age&#x27;].head(3)</span></span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
å¤–å±‚ [] æ˜¯ DataFrame çš„ç´¢å¼•æ“ä½œç¬¦ã€‚
å†…å±‚ [] æ˜¯ Python åŸç”Ÿçš„åˆ—è¡¨è¯­æ³•ï¼Œç”¨äºä¼ é€’å¤šä¸ªåˆ—åã€‚

#### 2.1.2 ä»»åŠ¡äºŒï¼šå¯¹ç¼ºå¤±å€¼è¿›è¡Œå¤„ç†
(1)å¤„ç†ç¼ºå¤±å€¼ä¸€èˆ¬æœ‰å‡ ç§æ€è·¯

(2) è¯·å°è¯•å¯¹Ageåˆ—çš„æ•°æ®çš„ç¼ºå¤±å€¼è¿›è¡Œå¤„ç†

(3) è¯·å°è¯•ä½¿ç”¨ä¸åŒçš„æ–¹æ³•ç›´æ¥å¯¹æ•´å¼ è¡¨çš„ç¼ºå¤±å€¼è¿›è¡Œå¤„ç†  

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¤„ç†ç¼ºå¤±å€¼çš„ä¸€èˆ¬æ€è·¯ï¼š</span></span><br><span class="line"><span class="comment">#æé†’ï¼šå¯ä½¿ç”¨çš„å‡½æ•°æœ‰---&gt;dropnaå‡½æ•°ä¸fillnaå‡½æ•°</span></span><br><span class="line"><span class="comment">#print(df.head(3))</span></span><br><span class="line">df[df[<span class="string">&#x27;Age&#x27;</span>]==<span class="literal">None</span>]=<span class="number">0</span></span><br><span class="line">df.head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df[df[<span class="string">&#x27;Age&#x27;</span>].isnull()]</span><br><span class="line">df[df[<span class="string">&#x27;Age&#x27;</span>].isnull()] = <span class="number">0</span> </span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df[df[<span class="string">&#x27;Age&#x27;</span>] == np.nan] = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>ã€æ€è€ƒ1ã€‘dropnaå’Œfillnaæœ‰å“ªäº›å‚æ•°ï¼Œåˆ†åˆ«å¦‚ä½•ä½¿ç”¨å‘¢?  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#dropna() æ˜¯ Pandas ä¸­ç”¨äºåˆ é™¤åŒ…å«ç¼ºå¤±å€¼ï¼ˆNaN æˆ– Noneï¼‰çš„è¡Œæˆ–åˆ—çš„å‡½æ•°ã€‚å…¶æ ¸å¿ƒä½œç”¨æ˜¯æ¸…ç†æ•°æ®ä¸­çš„ç¼ºå¤±å€¼ï¼Œé€‚ç”¨äºæ•°æ®æ¸…æ´—é˜¶æ®µã€‚</span></span><br><span class="line">df.dropna().head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0000</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#fillna() æ˜¯ Pandas ä¸­ç”¨äºå¡«å……ç¼ºå¤±å€¼ï¼ˆNaN æˆ– Noneï¼‰çš„æ ¸å¿ƒå‡½æ•°ï¼Œå¸¸ç”¨äºæ•°æ®æ¸…æ´—é˜¶æ®µã€‚å…¶æ ¸å¿ƒä½œç”¨æ˜¯å°†ç¼ºå¤±å€¼æ›¿æ¢ä¸ºåˆç†å€¼ï¼Œä»¥ä¾¿åç»­åˆ†ææˆ–å»ºæ¨¡ã€‚</span></span><br><span class="line">df.fillna(<span class="number">0</span>).head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>0</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>0</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>



<p>ã€æ€è€ƒã€‘æ£€ç´¢ç©ºç¼ºå€¼ç”¨<code>np.nan</code>,<code>None</code>ä»¥åŠ<code>.isnull()</code>å“ªä¸ªæ›´å¥½ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿå¦‚æœå…¶ä¸­æŸä¸ªæ–¹å¼æ— æ³•æ‰¾åˆ°ç¼ºå¤±å€¼ï¼ŒåŸå› åˆæ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p>
<p>ã€å‚è€ƒã€‘<a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html</a></p>
<p>ã€å‚è€ƒã€‘<a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html</a></p>
<h3 id="2-2-é‡å¤å€¼è§‚å¯Ÿä¸å¤„ç†"><a href="#2-2-é‡å¤å€¼è§‚å¯Ÿä¸å¤„ç†" class="headerlink" title="2.2 é‡å¤å€¼è§‚å¯Ÿä¸å¤„ç†"></a>2.2 é‡å¤å€¼è§‚å¯Ÿä¸å¤„ç†</h3><p>ç”±äºè¿™æ ·é‚£æ ·çš„åŸå› ï¼Œæ•°æ®ä¸­ä¼šä¸ä¼šå­˜åœ¨é‡å¤å€¼å‘¢ï¼Œå¦‚æœå­˜åœ¨è¦æ€æ ·å¤„ç†å‘¢</p>
<h4 id="2-2-1-ä»»åŠ¡ä¸€ï¼šè¯·æŸ¥çœ‹æ•°æ®ä¸­çš„é‡å¤å€¼"><a href="#2-2-1-ä»»åŠ¡ä¸€ï¼šè¯·æŸ¥çœ‹æ•°æ®ä¸­çš„é‡å¤å€¼" class="headerlink" title="2.2.1 ä»»åŠ¡ä¸€ï¼šè¯·æŸ¥çœ‹æ•°æ®ä¸­çš„é‡å¤å€¼"></a>2.2.1 ä»»åŠ¡ä¸€ï¼šè¯·æŸ¥çœ‹æ•°æ®ä¸­çš„é‡å¤å€¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#df.duplicated()è¿”å›ä¸€ä¸ªå¸ƒå°”åºåˆ— (Series)ï¼Œæ ‡è®°æ¯ä¸€è¡Œæ˜¯å¦ä¸ºé‡å¤è¡Œ</span></span><br><span class="line">df[df.duplicated()]</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>17</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>859</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>863</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>868</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>878</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>888</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>176 rows Ã— 12 columns</p>


#### 2.2.2 ä»»åŠ¡äºŒï¼šå¯¹é‡å¤å€¼è¿›è¡Œå¤„ç†
(1)é‡å¤å€¼æœ‰å“ªäº›å¤„ç†æ–¹å¼å‘¢ï¼Ÿ

(2)å¤„ç†æˆ‘ä»¬æ•°æ®çš„é‡å¤å€¼

æ–¹æ³•å¤šå¤šç›Šå–„


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é‡å¤å€¼æœ‰å“ªäº›å¤„ç†æ–¹å¼ï¼š</span></span><br><span class="line"><span class="comment">#åˆ é™¤ DataFrame ä¸­çš„é‡å¤è¡Œï¼ˆå®Œå…¨ç›¸åŒçš„è¡Œåªä¿ç•™ä¸€æ¬¡ï¼‰ã€‚</span></span><br><span class="line">df = df.drop_duplicates()</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>


<h4 id="2-2-3-ä»»åŠ¡ä¸‰ï¼šå°†å‰é¢æ¸…æ´—çš„æ•°æ®ä¿å­˜ä¸ºcsvæ ¼å¼"><a href="#2-2-3-ä»»åŠ¡ä¸‰ï¼šå°†å‰é¢æ¸…æ´—çš„æ•°æ®ä¿å­˜ä¸ºcsvæ ¼å¼" class="headerlink" title="2.2.3 ä»»åŠ¡ä¸‰ï¼šå°†å‰é¢æ¸…æ´—çš„æ•°æ®ä¿å­˜ä¸ºcsvæ ¼å¼"></a>2.2.3 ä»»åŠ¡ä¸‰ï¼šå°†å‰é¢æ¸…æ´—çš„æ•°æ®ä¿å­˜ä¸ºcsvæ ¼å¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"></span><br><span class="line">df.to_csv(<span class="string">&#x27;test_clear.csv&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="2-3-ç‰¹å¾è§‚å¯Ÿä¸å¤„ç†"><a href="#2-3-ç‰¹å¾è§‚å¯Ÿä¸å¤„ç†" class="headerlink" title="2.3 ç‰¹å¾è§‚å¯Ÿä¸å¤„ç†"></a>2.3 ç‰¹å¾è§‚å¯Ÿä¸å¤„ç†</h3><p>æˆ‘ä»¬å¯¹ç‰¹å¾è¿›è¡Œä¸€ä¸‹è§‚å¯Ÿï¼Œå¯ä»¥æŠŠç‰¹å¾å¤§æ¦‚åˆ†ä¸ºä¸¤å¤§ç±»ï¼š<br>æ•°å€¼å‹ç‰¹å¾ï¼šSurvived ï¼ŒPclassï¼Œ Age ï¼ŒSibSpï¼Œ Parchï¼Œ Fareï¼Œå…¶ä¸­Survivedï¼Œ Pclassä¸ºç¦»æ•£å‹æ•°å€¼ç‰¹å¾ï¼ŒAgeï¼ŒSibSpï¼Œ Parchï¼Œ Fareä¸ºè¿ç»­å‹æ•°å€¼ç‰¹å¾<br>æ–‡æœ¬å‹ç‰¹å¾ï¼šNameï¼Œ Sexï¼Œ Cabinï¼ŒEmbarkedï¼Œ Ticketï¼Œå…¶ä¸­Sexï¼Œ Cabinï¼Œ Embarkedï¼Œ Ticketä¸ºç±»åˆ«å‹æ–‡æœ¬ç‰¹å¾ï¼Œæ•°å€¼å‹ç‰¹å¾ä¸€èˆ¬å¯ä»¥ç›´æ¥ç”¨äºæ¨¡å‹çš„è®­ç»ƒï¼Œä½†æœ‰æ—¶å€™ä¸ºäº†æ¨¡å‹çš„ç¨³å®šæ€§åŠé²æ£’æ€§ä¼šå¯¹è¿ç»­å˜é‡è¿›è¡Œç¦»æ•£åŒ–ã€‚æ–‡æœ¬å‹ç‰¹å¾å¾€å¾€éœ€è¦è½¬æ¢æˆæ•°å€¼å‹ç‰¹å¾æ‰èƒ½ç”¨äºå»ºæ¨¡åˆ†æã€‚</p>
<h4 id="2-3-1-ä»»åŠ¡ä¸€ï¼šå¯¹å¹´é¾„è¿›è¡Œåˆ†ç®±ï¼ˆç¦»æ•£åŒ–ï¼‰å¤„ç†"><a href="#2-3-1-ä»»åŠ¡ä¸€ï¼šå¯¹å¹´é¾„è¿›è¡Œåˆ†ç®±ï¼ˆç¦»æ•£åŒ–ï¼‰å¤„ç†" class="headerlink" title="2.3.1 ä»»åŠ¡ä¸€ï¼šå¯¹å¹´é¾„è¿›è¡Œåˆ†ç®±ï¼ˆç¦»æ•£åŒ–ï¼‰å¤„ç†"></a>2.3.1 ä»»åŠ¡ä¸€ï¼šå¯¹å¹´é¾„è¿›è¡Œåˆ†ç®±ï¼ˆç¦»æ•£åŒ–ï¼‰å¤„ç†</h4><p>(1) åˆ†ç®±æ“ä½œæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>(2) å°†è¿ç»­å˜é‡Ageå¹³å‡åˆ†ç®±æˆ5ä¸ªå¹´é¾„æ®µï¼Œå¹¶åˆ†åˆ«ç”¨ç±»åˆ«å˜é‡12345è¡¨ç¤º  </p>
<p>(3) å°†è¿ç»­å˜é‡Ageåˆ’åˆ†ä¸º[0,5) [5,15) [15,30) [30,50) [50,80)äº”ä¸ªå¹´é¾„æ®µï¼Œå¹¶åˆ†åˆ«ç”¨ç±»åˆ«å˜é‡12345è¡¨ç¤º  </p>
<p>(4) å°†è¿ç»­å˜é‡AgeæŒ‰10% 30% 50% 70% 90%äº”ä¸ªå¹´é¾„æ®µï¼Œå¹¶ç”¨åˆ†ç±»å˜é‡12345è¡¨ç¤º</p>
<p>(5) å°†ä¸Šé¢çš„è·å¾—çš„æ•°æ®åˆ†åˆ«è¿›è¡Œä¿å­˜ï¼Œä¿å­˜ä¸ºcsvæ ¼å¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆ†ç®±æ“ä½œæ˜¯ä»€ä¹ˆï¼š</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">åˆ†ç®±æ“ä½œï¼ˆBinningï¼‰æ˜¯æ•°æ®é¢„å¤„ç†ä¸­çš„ä¸€ç§å¸¸ç”¨æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå°†è¿ç»­å‹æ•°å€¼è½¬æ¢ä¸ºç¦»æ•£çš„åŒºé—´ï¼ˆå³â€œç®±å­â€æˆ–â€œåˆ†ç»„â€ï¼‰</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#å°†è¿ç»­å˜é‡Ageå¹³å‡åˆ†ç®±æˆ5ä¸ªå¹´é¾„æ®µï¼Œå¹¶åˆ†åˆ«ç”¨ç±»åˆ«å˜é‡12345è¡¨ç¤º</span></span><br><span class="line">df[<span class="string">&#x27;AgeBand&#x27;</span>] = pd.cut(df[<span class="string">&#x27;Age&#x27;</span>], <span class="number">5</span>,labels = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">df.head()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>AgeBand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>3</td>
    </tr>
  </tbody>
</table>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#å°†è¿ç»­å˜é‡Ageåˆ’åˆ†ä¸º(0,5] (5,15] (15,30] (30,50] (50,80]äº”ä¸ªå¹´é¾„æ®µï¼Œå¹¶åˆ†åˆ«ç”¨ç±»åˆ«å˜é‡12345è¡¨ç¤º</span></span><br><span class="line">df[<span class="string">&#x27;AgeBand&#x27;</span>] = pd.cut(df[<span class="string">&#x27;Age&#x27;</span>],[<span class="number">0</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">30</span>,<span class="number">50</span>,<span class="number">80</span>],labels = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">df.head(<span class="number">3</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>AgeBand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>3</td>
    </tr>
  </tbody>
</table>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#å°†è¿ç»­å˜é‡AgeæŒ‰10% 30% 50 70% 90%äº”ä¸ªå¹´é¾„æ®µï¼Œå¹¶ç”¨åˆ†ç±»å˜é‡12345è¡¨ç¤º</span></span><br><span class="line">df[<span class="string">&#x27;AgeBand&#x27;</span>] = pd.qcut(df[<span class="string">&#x27;Age&#x27;</span>],[<span class="number">0</span>,<span class="number">0.1</span>,<span class="number">0.3</span>,<span class="number">0.5</span>,<span class="number">0.7</span>,<span class="number">0.9</span>],labels = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<p><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>AgeBand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>4</td>
    </tr>
  </tbody>
</table><br>ã€å‚è€ƒã€‘<a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html</a></p>
<p>ã€å‚è€ƒã€‘<a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.qcut.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.qcut.html</a></p>
<h4 id="2-3-2-ä»»åŠ¡äºŒï¼šå¯¹æ–‡æœ¬å˜é‡è¿›è¡Œè½¬æ¢"><a href="#2-3-2-ä»»åŠ¡äºŒï¼šå¯¹æ–‡æœ¬å˜é‡è¿›è¡Œè½¬æ¢" class="headerlink" title="2.3.2 ä»»åŠ¡äºŒï¼šå¯¹æ–‡æœ¬å˜é‡è¿›è¡Œè½¬æ¢"></a>2.3.2 ä»»åŠ¡äºŒï¼šå¯¹æ–‡æœ¬å˜é‡è¿›è¡Œè½¬æ¢</h4><p>(1) æŸ¥çœ‹æ–‡æœ¬å˜é‡ååŠç§ç±»<br>(2) å°†æ–‡æœ¬å˜é‡Sexï¼Œ Cabin ï¼ŒEmbarkedç”¨æ•°å€¼å˜é‡12345è¡¨ç¤º<br>(3) å°†æ–‡æœ¬å˜é‡Sexï¼Œ Cabinï¼Œ Embarkedç”¨one-hotç¼–ç è¡¨ç¤º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#æ–¹æ³•ä¸€: value_counts</span></span><br><span class="line"><span class="built_in">print</span>(</span><br><span class="line">df[<span class="string">&#x27;Sex&#x27;</span>].value_counts(),</span><br><span class="line">df[<span class="string">&#x27;Cabin&#x27;</span>].value_counts(),</span><br><span class="line">df[<span class="string">&#x27;Embarked&#x27;</span>].value_counts())</span><br></pre></td></tr></table></figure>
<pre><code>Sex
male      453
female    261
0           1
Name: count, dtype: int64 Cabin
B96 B98        4
G6             4
C23 C25 C27    4
F2             3
C22 C26        3
              ..
E36            1
D7             1
C118           1
C99            1
D37            1
Name: count, Length: 135, dtype: int64 Embarked
S    554
C    130
Q     28
0      1
Name: count, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">df[<span class="string">&#x27;Sex&#x27;</span>].unique()</span><br><span class="line">df[<span class="string">&#x27;Sex&#x27;</span>].nunique()</span><br></pre></td></tr></table></figure>
<pre><code>3
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#å°†ç±»åˆ«æ–‡æœ¬è½¬æ¢ä¸º12345</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ–¹æ³•ä¸€: replace</span></span><br><span class="line">df[<span class="string">&#x27;Sex_num&#x27;</span>] = df[<span class="string">&#x27;Sex&#x27;</span>].replace([<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>],[<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">df.head()</span><br><span class="line"><span class="comment">#æ–¹æ³•äºŒ: map</span></span><br><span class="line">df[<span class="string">&#x27;Sex_num&#x27;</span>] = df[<span class="string">&#x27;Sex&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="string">&#x27;male&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;female&#x27;</span>: <span class="number">2</span>&#125;)</span><br><span class="line">df.head()</span><br><span class="line"><span class="comment">#æ–¹æ³•ä¸‰: ä½¿ç”¨sklearn.preprocessingçš„LabelEncoder</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"><span class="keyword">for</span> feat <span class="keyword">in</span> [<span class="string">&#x27;Cabin&#x27;</span>, <span class="string">&#x27;Ticket&#x27;</span>]:</span><br><span class="line">    lbl = LabelEncoder()  </span><br><span class="line">    label_dict = <span class="built_in">dict</span>(<span class="built_in">zip</span>(df[feat].unique(), <span class="built_in">range</span>(df[feat].nunique())))</span><br><span class="line">    <span class="comment">#print(label_dict)</span></span><br><span class="line">    df[feat + <span class="string">&quot;_labelEncode&quot;</span>] = df[feat].<span class="built_in">map</span>(label_dict)</span><br><span class="line">    df[feat + <span class="string">&quot;_labelEncode&quot;</span>] = lbl.fit_transform(df[feat].astype(<span class="built_in">str</span>))</span><br><span class="line"></span><br><span class="line">df.head()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>/tmp/ipykernel_1400/2627332835.py:5: FutureWarning: Downcasting behavior in `replace` is deprecated and will be removed in a future version. To retain the old behavior, explicitly call `result.infer_objects(copy=False)`. To opt-in to the future behavior, set `pd.set_option(&#39;future.no_silent_downcasting&#39;, True)`
  df[&#39;Sex_num&#39;] = df[&#39;Sex&#39;].replace([&#39;male&#39;,&#39;female&#39;],[1,2])
</code></pre><p><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>...</th>
      <th>Age_66.0</th>
      <th>Age_70.0</th>
      <th>Age_70.5</th>
      <th>Age_71.0</th>
      <th>Age_74.0</th>
      <th>Age_80.0</th>
      <th>Embarked_0</th>
      <th>Embarked_C</th>
      <th>Embarked_Q</th>
      <th>Embarked_S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table></p>
<p>5 rows Ã— 109 columns</p>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å°†ç±»åˆ«æ–‡æœ¬è½¬æ¢ä¸ºone-hotç¼–ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ–¹æ³•ä¸€: OneHotEncoder</span></span><br><span class="line"><span class="keyword">for</span> feat <span class="keyword">in</span> [<span class="string">&quot;Age&quot;</span>, <span class="string">&quot;Embarked&quot;</span>]:</span><br><span class="line">    x = pd.get_dummies(df[<span class="string">&quot;Age&quot;</span>] // <span class="number">6</span>)</span><br><span class="line"><span class="comment">#     x = pd.get_dummies(pd.cut(df[&#x27;Age&#x27;],5))</span></span><br><span class="line">    x = pd.get_dummies(df[feat], prefix=feat)</span><br><span class="line">    df = pd.concat([df, x], axis=<span class="number">1</span>)</span><br><span class="line">    <span class="comment">#df[feat] = pd.get_dummies(df[feat], prefix=feat)</span></span><br><span class="line">    </span><br><span class="line">df.head()</span><br><span class="line">df.to_csv(<span class="string">&#x27;temp.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2-3-3-ä»»åŠ¡ä¸‰ï¼šä»çº¯æ–‡æœ¬Nameç‰¹å¾é‡Œæå–å‡ºTitlesçš„ç‰¹å¾-æ‰€è°“çš„Titleså°±æ˜¯Mr-Miss-Mrsç­‰"><a href="#2-3-3-ä»»åŠ¡ä¸‰ï¼šä»çº¯æ–‡æœ¬Nameç‰¹å¾é‡Œæå–å‡ºTitlesçš„ç‰¹å¾-æ‰€è°“çš„Titleså°±æ˜¯Mr-Miss-Mrsç­‰" class="headerlink" title="2.3.3 ä»»åŠ¡ä¸‰ï¼šä»çº¯æ–‡æœ¬Nameç‰¹å¾é‡Œæå–å‡ºTitlesçš„ç‰¹å¾(æ‰€è°“çš„Titleså°±æ˜¯Mr,Miss,Mrsç­‰)"></a>2.3.3 ä»»åŠ¡ä¸‰ï¼šä»çº¯æ–‡æœ¬Nameç‰¹å¾é‡Œæå–å‡ºTitlesçš„ç‰¹å¾(æ‰€è°“çš„Titleså°±æ˜¯Mr,Miss,Mrsç­‰)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¿å­˜æœ€ç»ˆä½ å®Œæˆçš„å·²ç»æ¸…ç†å¥½çš„æ•°æ®</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</class>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0--%E5%BB%BA%E6%A8%A1-%E8%AF%BE%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0--%E5%BB%BA%E6%A8%A1-%E8%AF%BE%E7%A8%8B/" class="post-title-link" itemprop="url">æ•°æ®åˆ†æâ€”â€”ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°--å»ºæ¨¡</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-06-12 18:45:38" itemprop="dateModified" datetime="2025-06-12T18:45:38+08:00">2025-06-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/" itemprop="url" rel="index"><span itemprop="name">kaggle</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/titanic/" itemprop="url" rel="index"><span itemprop="name">titanic</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ç¬¬ä¸‰ç« -æ¨¡å‹æ­å»ºå’Œè¯„ä¼°â€”å»ºæ¨¡"><a href="#ç¬¬ä¸‰ç« -æ¨¡å‹æ­å»ºå’Œè¯„ä¼°â€”å»ºæ¨¡" class="headerlink" title="ç¬¬ä¸‰ç«  æ¨¡å‹æ­å»ºå’Œè¯„ä¼°â€”å»ºæ¨¡"></a>ç¬¬ä¸‰ç«  æ¨¡å‹æ­å»ºå’Œè¯„ä¼°â€”å»ºæ¨¡</h2><p>ç»è¿‡å‰é¢çš„ä¸¤ç« çš„çŸ¥è¯†ç‚¹çš„å­¦ä¹ ï¼Œæˆ‘å¯ä»¥å¯¹æ•°æ•°æ®çš„æœ¬èº«è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æ•°æ®æœ¬èº«çš„å¢åˆ æŸ¥è¡¥ï¼Œè¿˜å¯ä»¥åšå¿…è¦çš„æ¸…æ´—å·¥ä½œã€‚é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±è¦å¼€å§‹ä½¿ç”¨æˆ‘ä»¬å‰é¢å¤„ç†å¥½çš„æ•°æ®äº†ã€‚è¿™ä¸€ç« æˆ‘ä»¬è¦åšçš„å°±æ˜¯ä½¿ç”¨æ•°æ®ï¼Œæˆ‘ä»¬åšæ•°æ®åˆ†æçš„ç›®çš„ä¹Ÿå°±æ˜¯ï¼Œè¿ç”¨æˆ‘ä»¬çš„æ•°æ®ä»¥åŠç»“åˆæˆ‘çš„ä¸šåŠ¡æ¥å¾—åˆ°æŸäº›æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ç»“æœã€‚é‚£ä¹ˆåˆ†æçš„ç¬¬ä¸€æ­¥å°±æ˜¯å»ºæ¨¡ï¼Œæ­å»ºä¸€ä¸ªé¢„æµ‹æ¨¡å‹æˆ–è€…å…¶ä»–æ¨¡å‹ï¼›æˆ‘ä»¬ä»è¿™ä¸ªæ¨¡å‹çš„åˆ°ç»“æœä¹‹åï¼Œæˆ‘ä»¬è¦åˆ†ææˆ‘çš„æ¨¡å‹æ˜¯ä¸æ˜¯è¶³å¤Ÿçš„å¯é ï¼Œé‚£æˆ‘å°±éœ€è¦è¯„ä¼°è¿™ä¸ªæ¨¡å‹ã€‚ä»Šå¤©æˆ‘ä»¬å­¦ä¹ å»ºæ¨¡ï¼Œä¸‹ä¸€èŠ‚æˆ‘ä»¬å­¦ä¹ è¯„ä¼°ã€‚</p>
<p>æˆ‘ä»¬æ‹¥æœ‰çš„æ³°å¦å°¼å…‹å·çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™æ¬¡çš„ç›®çš„å°±æ˜¯ï¼Œå®Œæˆæ³°å¦å°¼å…‹å·å­˜æ´»é¢„æµ‹è¿™ä¸ªä»»åŠ¡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> IPython.display <span class="keyword">import</span> Image</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span>  <span class="comment"># ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;figure.figsize&#x27;</span>] = (<span class="number">10</span>, <span class="number">6</span>)  <span class="comment"># è®¾ç½®è¾“å‡ºå›¾ç‰‡å¤§å°</span></span><br></pre></td></tr></table></figure>
<p>è½½å…¥è¿™äº›åº“ï¼Œå¦‚æœç¼ºå°‘æŸäº›åº“ï¼Œè¯·å®‰è£…ä»–ä»¬</p>
<p>ã€æ€è€ƒã€‘è¿™äº›åº“çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä½ éœ€è¦æŸ¥ä¸€æŸ¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒé¢˜å›ç­”</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Image æ˜¯ IPython.display æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåœ¨ Jupyter Notebook æˆ– IPython ç¯å¢ƒä¸­ç›´æ¥æ˜¾ç¤ºå›¾åƒã€‚æ”¯æŒä»æœ¬åœ°è·¯å¾„æˆ–ç½‘ç»œ URL åŠ è½½å›¾åƒï¼Œå¹¶æ§åˆ¶æ˜¾ç¤ºæ ¼å¼ï¼ˆå¦‚å®½åº¦ã€é«˜åº¦ã€æ ¼å¼ç±»å‹ï¼‰</span></span><br><span class="line"><span class="string">seaborn æ˜¯ä¸€ä¸ªåŸºäº Matplotlib çš„é«˜çº§æ•°æ®å¯è§†åŒ–åº“ï¼Œä¸“æ³¨äºç»Ÿè®¡å›¾å½¢çš„ç»˜åˆ¶ï¼ˆå¦‚åˆ†å¸ƒå›¾ã€ç›¸å…³æ€§å›¾ã€åˆ†ç±»å›¾ç­‰ï¼‰ï¼Œèƒ½å¿«é€Ÿç”Ÿæˆç¾è§‚ä¸”ä¿¡æ¯ä¸°å¯Œçš„å›¾è¡¨</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>&#39;\nImage æ˜¯ IPython.display æ¨¡å—çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºåœ¨ Jupyter Notebook æˆ– IPython ç¯å¢ƒä¸­ç›´æ¥æ˜¾ç¤ºå›¾åƒã€‚æ”¯æŒä»æœ¬åœ°è·¯å¾„æˆ–ç½‘ç»œ URL åŠ è½½å›¾åƒï¼Œå¹¶æ§åˆ¶æ˜¾ç¤ºæ ¼å¼ï¼ˆå¦‚å®½åº¦ã€é«˜åº¦ã€æ ¼å¼ç±»å‹ï¼‰\nseaborn æ˜¯ä¸€ä¸ªåŸºäº Matplotlib çš„é«˜çº§æ•°æ®å¯è§†åŒ–åº“ï¼Œä¸“æ³¨äºç»Ÿè®¡å›¾å½¢çš„ç»˜åˆ¶ï¼ˆå¦‚åˆ†å¸ƒå›¾ã€ç›¸å…³æ€§å›¾ã€åˆ†ç±»å›¾ç­‰ï¼‰ï¼Œèƒ½å¿«é€Ÿç”Ÿæˆç¾è§‚ä¸”ä¿¡æ¯ä¸°å¯Œçš„å›¾è¡¨\n&#39;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>
<p> <strong>è½½å…¥æˆ‘ä»¬æä¾›æ¸…æ´—ä¹‹åçš„æ•°æ®(clear_data.csv)ï¼Œå¤§å®¶ä¹Ÿå°†åŸå§‹æ•°æ®è½½å…¥ï¼ˆtrain.csvï¼‰ï¼Œè¯´è¯´ä»–ä»¬æœ‰ä»€ä¹ˆä¸åŒ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">train = pd.read_csv(<span class="string">&#x27;train.csv&#x27;</span>)</span><br><span class="line">train.shape</span><br></pre></td></tr></table></figure>
<pre><code>(891, 12)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">train.head()</span><br></pre></td></tr></table></figure>
<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre><p>&lt;/style&gt;</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;clear_data.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Sex_female</th>
      <th>Sex_male</th>
      <th>Embarked_C</th>
      <th>Embarked_Q</th>
      <th>Embarked_S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>3</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>


<h3 id="æ¨¡å‹æ­å»º"><a href="#æ¨¡å‹æ­å»º" class="headerlink" title="æ¨¡å‹æ­å»º"></a>æ¨¡å‹æ­å»º</h3><ul>
<li>å¤„ç†å®Œå‰é¢çš„æ•°æ®æˆ‘ä»¬å°±å¾—åˆ°å»ºæ¨¡æ•°æ®ï¼Œä¸‹ä¸€æ­¥æ˜¯é€‰æ‹©åˆé€‚æ¨¡å‹</li>
<li>åœ¨è¿›è¡Œæ¨¡å‹é€‰æ‹©ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“æ•°æ®é›†æœ€ç»ˆæ˜¯è¿›è¡Œ<strong>ç›‘ç£å­¦ä¹ </strong>è¿˜æ˜¯<strong>æ— ç›‘ç£å­¦ä¹ </strong></li>
<li>æ¨¡å‹çš„é€‰æ‹©ä¸€æ–¹é¢æ˜¯é€šè¿‡æˆ‘ä»¬çš„ä»»åŠ¡æ¥å†³å®šçš„ã€‚</li>
<li>é™¤äº†æ ¹æ®æˆ‘ä»¬ä»»åŠ¡æ¥é€‰æ‹©æ¨¡å‹å¤–ï¼Œè¿˜å¯ä»¥æ ¹æ®æ•°æ®æ ·æœ¬é‡ä»¥åŠç‰¹å¾çš„ç¨€ç–æ€§æ¥å†³å®š</li>
<li>åˆšå¼€å§‹æˆ‘ä»¬æ€»æ˜¯å…ˆå°è¯•ä½¿ç”¨ä¸€ä¸ªåŸºæœ¬çš„æ¨¡å‹æ¥ä½œä¸ºå…¶baselineï¼Œè¿›è€Œå†è®­ç»ƒå…¶ä»–æ¨¡å‹åšå¯¹æ¯”ï¼Œæœ€ç»ˆé€‰æ‹©æ³›åŒ–èƒ½åŠ›æˆ–æ€§èƒ½æ¯”è¾ƒå¥½çš„æ¨¡å‹</li>
</ul>
<p>è¿™é‡Œæˆ‘çš„å»ºæ¨¡ï¼Œå¹¶ä¸æ˜¯ä»é›¶å¼€å§‹ï¼Œè‡ªå·±ä¸€ä¸ªäººå®Œæˆå®Œæˆæ‰€æœ‰ä»£ç çš„ç¼–è¯‘ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ä¸€ä¸ªæœºå™¨å­¦ä¹ æœ€å¸¸ç”¨çš„ä¸€ä¸ªåº“ï¼ˆsklearnï¼‰æ¥å®Œæˆæˆ‘ä»¬çš„æ¨¡å‹çš„æ­å»º</p>
<p><strong>ä¸‹é¢ç»™å‡ºsklearnçš„ç®—æ³•é€‰æ‹©è·¯å¾„ï¼Œä¾›å¤§å®¶å‚è€ƒ</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sklearnæ¨¡å‹ç®—æ³•é€‰æ‹©è·¯å¾„å›¾</span></span><br><span class="line">Image(<span class="string">&#x27;sklearn.png&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%B8%89%E7%AB%A0%E6%A8%A1%E5%9E%8B%E5%BB%BA%E7%AB%8B%E5%92%8C%E8%AF%84%E4%BC%B0--%E5%BB%BA%E6%A8%A1-%E8%AF%BE%E7%A8%8B/ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°--å»ºæ¨¡-è¯¾ç¨‹_17_0.png" alt="ç¬¬ä¸‰ç« æ¨¡å‹å»ºç«‹å’Œè¯„ä¼°--å»ºæ¨¡-è¯¾ç¨‹_17_0"></p>
<p>ã€æ€è€ƒã€‘æ•°æ®é›†å“ªäº›å·®å¼‚ä¼šå¯¼è‡´æ¨¡å‹åœ¨æ‹Ÿåˆæ•°æ®æ˜¯å‘ç”Ÿå˜åŒ–</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡ä¸€ï¼šåˆ‡å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†"><a href="#ä»»åŠ¡ä¸€ï¼šåˆ‡å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†" class="headerlink" title="ä»»åŠ¡ä¸€ï¼šåˆ‡å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†"></a>ä»»åŠ¡ä¸€ï¼šåˆ‡å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†</h4><p>è¿™é‡Œä½¿ç”¨ç•™å‡ºæ³•åˆ’åˆ†æ•°æ®é›†</p>
<ul>
<li>å°†æ•°æ®é›†åˆ†ä¸ºè‡ªå˜é‡å’Œå› å˜é‡</li>
<li>æŒ‰æ¯”ä¾‹åˆ‡å‰²è®­ç»ƒé›†å’Œæµ‹è¯•é›†(ä¸€èˆ¬æµ‹è¯•é›†çš„æ¯”ä¾‹æœ‰30%ã€25%ã€20%ã€15%å’Œ10%)</li>
<li>ä½¿ç”¨åˆ†å±‚æŠ½æ ·</li>
<li>è®¾ç½®éšæœºç§å­ä»¥ä¾¿ç»“æœèƒ½å¤ç°</li>
</ul>
<p>ã€æ€è€ƒã€‘</p>
<ul>
<li>åˆ’åˆ†æ•°æ®é›†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆä½¿ç”¨åˆ†å±‚æŠ½æ ·ï¼Œè¿™æ ·çš„å¥½å¤„æœ‰ä»€ä¹ˆï¼Ÿ</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ’åˆ†æ•°æ®é›†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</span></span><br><span class="line"><span class="comment"># 1.  **ç•™å‡ºæ³• (Hold-out Cross Validation)**ï¼š</span></span><br><span class="line"><span class="comment">#     *   ç›´æ¥å°†æ•°æ®é›†Dåˆ’åˆ†ä¸ºä¸¤ä¸ªäº’æ–¥çš„é›†åˆï¼šè®­ç»ƒé›†Så’Œæµ‹è¯•é›†Tã€‚</span></span><br><span class="line"><span class="comment">#     *   ä¾‹å¦‚ï¼Œ70%çš„æ•°æ®ç”¨äºè®­ç»ƒï¼Œ30%ç”¨äºæµ‹è¯•ã€‚</span></span><br><span class="line"><span class="comment">#     *   ä¼˜ç‚¹ï¼šç®€å•ã€è®¡ç®—å¼€é”€å°ã€‚</span></span><br><span class="line"><span class="comment">#     *   ç¼ºç‚¹ï¼šåˆ’åˆ†å…·æœ‰éšæœºæ€§ï¼Œå•æ¬¡åˆ’åˆ†çš„ç»“æœå¯èƒ½ä¸å¤Ÿç¨³å®šå’Œå‡†ç¡®ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é›†è¾ƒå°æ—¶ã€‚è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ ·æœ¬æ¯”ä¾‹ä¼šå½±å“è¯„ä¼°ç»“æœã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.  **äº¤å‰éªŒè¯æ³• (Cross Validation)**ï¼š</span></span><br><span class="line"><span class="comment">#     *   **kæŠ˜äº¤å‰éªŒè¯ (k-Fold Cross Validation)**ï¼š</span></span><br><span class="line"><span class="comment">#         *   å°†æ•°æ®é›†Dåˆ’åˆ†ä¸ºkä¸ªå¤§å°ç›¸ä¼¼çš„äº’æ–¥å­é›† D1, D2, ..., Dkã€‚</span></span><br><span class="line"><span class="comment">#         *   æ¯æ¬¡ç”¨k-1ä¸ªå­é›†çš„å¹¶é›†ä½œä¸ºè®­ç»ƒé›†ï¼Œä½™ä¸‹çš„é‚£ä¸ªå­é›†ä½œä¸ºæµ‹è¯•é›†ã€‚</span></span><br><span class="line"><span class="comment">#         *   è¿™æ ·å¯ä»¥è·å¾—kç»„è®­ç»ƒ/æµ‹è¯•é›†ï¼Œä»è€Œå¯è¿›è¡Œkæ¬¡è®­ç»ƒå’Œæµ‹è¯•ï¼Œæœ€ç»ˆè¿”å›çš„æ˜¯è¿™kä¸ªæµ‹è¯•ç»“æœçš„å‡å€¼ã€‚</span></span><br><span class="line"><span class="comment">#         *   å¸¸ç”¨çš„kå€¼ä¸º5æˆ–10ã€‚</span></span><br><span class="line"><span class="comment">#         *   ä¼˜ç‚¹ï¼šæ¯”ç•™å‡ºæ³•æ›´ç¨³å®šï¼Œæ›´å……åˆ†åœ°åˆ©ç”¨äº†æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment">#         *   ç¼ºç‚¹ï¼šè®¡ç®—å¼€é”€æ˜¯kå€ã€‚</span></span><br><span class="line"><span class="comment">#     *   **ç•™ä¸€æ³• (Leave-One-Out Cross Validation, LOOCV)**ï¼š</span></span><br><span class="line"><span class="comment">#         *   kæŠ˜äº¤å‰éªŒè¯çš„ç‰¹ä¾‹ï¼Œå½“kç­‰äºæ ·æœ¬æ•°Næ—¶ã€‚</span></span><br><span class="line"><span class="comment">#         *   æ¯æ¬¡åªç•™ä¸‹ä¸€ä¸ªæ ·æœ¬ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™N-1ä¸ªæ ·æœ¬ä½œä¸ºè®­ç»ƒé›†ã€‚</span></span><br><span class="line"><span class="comment">#         *   ä¼˜ç‚¹ï¼šè¯„ä¼°ç»“æœé€šå¸¸è¢«è®¤ä¸ºæ¯”è¾ƒå‡†ç¡®ï¼Œå› ä¸ºå‡ ä¹æ‰€æœ‰æ•°æ®éƒ½ç”¨äºè®­ç»ƒã€‚</span></span><br><span class="line"><span class="comment">#         *   ç¼ºç‚¹ï¼šè®¡ç®—å¼€é”€éå¸¸å¤§ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é›†å¾ˆå¤§æ—¶ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.  **è‡ªåŠ©æ³• (Bootstrapping)**ï¼š</span></span><br><span class="line"><span class="comment">#     *   ä»¥è‡ªåŠ©é‡‡æ ·æ³•ä¸ºåŸºç¡€ã€‚ç»™å®šåŒ…å«mä¸ªæ ·æœ¬çš„æ•°æ®é›†Dï¼Œå¯¹å®ƒè¿›è¡Œé‡‡æ ·äº§ç”Ÿæ•°æ®é›†D&#x27;ï¼šæ¯æ¬¡éšæœºä»Dä¸­æŒ‘é€‰ä¸€ä¸ªæ ·æœ¬ï¼Œå°†å…¶æ‹·è´æ”¾å…¥D&#x27;ï¼Œç„¶åå†å°†è¯¥æ ·æœ¬æ”¾å›åˆå§‹æ•°æ®é›†Dä¸­ï¼Œä½¿å¾—è¯¥æ ·æœ¬åœ¨ä¸‹æ¬¡é‡‡æ ·æ—¶ä»æœ‰å¯èƒ½è¢«é‡‡åˆ°ã€‚è¿™ä¸ªè¿‡ç¨‹é‡å¤æ‰§è¡Œmæ¬¡åï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†åŒ…å«mä¸ªæ ·æœ¬çš„æ•°æ®é›†D&#x27;ã€‚</span></span><br><span class="line"><span class="comment">#     *   å¯ä»¥è¯æ˜ï¼Œåˆå§‹æ•°æ®é›†Dä¸­çº¦æœ‰36.8%çš„æ ·æœ¬æœªå‡ºç°åœ¨é‡‡æ ·æ•°æ®é›†D&#x27;ä¸­ã€‚äºæ˜¯æˆ‘ä»¬å¯å°†D&#x27;ç”¨ä½œè®­ç»ƒé›†ï¼ŒD\D&#x27;ç”¨ä½œæµ‹è¯•é›†ã€‚</span></span><br><span class="line"><span class="comment">#     *   ä¼˜ç‚¹ï¼šåœ¨æ•°æ®é›†è¾ƒå°ã€éš¾ä»¥æœ‰æ•ˆåˆ’åˆ†è®­ç»ƒ/æµ‹è¯•é›†æ—¶å¾ˆæœ‰ç”¨ï¼›èƒ½ä»åˆå§‹æ•°æ®é›†ä¸­äº§ç”Ÿå¤šä¸ªä¸åŒçš„è®­ç»ƒé›†ã€‚</span></span><br><span class="line"><span class="comment">#     *   ç¼ºç‚¹ï¼šè‡ªåŠ©æ³•äº§ç”Ÿçš„æ•°æ®é›†æ”¹å˜äº†åˆå§‹æ•°æ®é›†çš„åˆ†å¸ƒï¼Œä¼šå¼•å…¥ä¼°è®¡åå·®ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºä»€ä¹ˆä½¿ç”¨åˆ†å±‚æŠ½æ ·ï¼Œè¿™æ ·çš„å¥½å¤„æœ‰ä»€ä¹ˆï¼Ÿ</span></span><br><span class="line"><span class="comment"># **åˆ†å±‚æŠ½æ · (Stratified Sampling)** æ˜¯ä¸€ç§æŠ½æ ·æŠ€æœ¯ï¼Œå®ƒå°†æ€»ä½“ï¼ˆæ•°æ®é›†ï¼‰åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªäº’ä¸é‡å çš„å­ç¾¤ï¼ˆç§°ä¸ºâ€œå±‚â€ï¼‰ï¼Œç„¶åä»æ¯ä¸ªå±‚ä¸­ç‹¬ç«‹åœ°è¿›è¡Œç®€å•éšæœºæŠ½æ ·ã€‚åœ¨åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†æ—¶ï¼Œç‰¹åˆ«æ˜¯å¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œé€šå¸¸æ˜¯æ ¹æ®ç›®æ ‡å˜é‡çš„ç±»åˆ«è¿›è¡Œåˆ†å±‚ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># **å¥½å¤„ï¼š**</span></span><br><span class="line"><span class="comment"># 1.  **ä¿æŒç±»åˆ«æ¯”ä¾‹ä¸€è‡´æ€§**ï¼š</span></span><br><span class="line"><span class="comment">#     *   ç¡®ä¿è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„å„ä¸ªç±»åˆ«çš„æ ·æœ¬æ¯”ä¾‹ä¸åŸå§‹æ•°æ®é›†ä¸­å„ä¸ªç±»åˆ«çš„æ ·æœ¬æ¯”ä¾‹å¤§è‡´ç›¸åŒã€‚</span></span><br><span class="line"><span class="comment">#     *   è¿™å¯¹äºç±»åˆ«ä¸å¹³è¡¡çš„æ•°æ®é›†å°¤ä¸ºé‡è¦ã€‚å¦‚æœè¿›è¡Œçº¯éšæœºæŠ½æ ·ï¼Œå¯èƒ½ä¼šå¯¼è‡´è®­ç»ƒé›†æˆ–æµ‹è¯•é›†ä¸­æŸäº›å°‘æ•°ç±»åˆ«çš„æ ·æœ¬è¿‡å°‘ï¼Œç”šè‡³æ²¡æœ‰ï¼Œä»è€Œå½±å“æ¨¡å‹çš„è®­ç»ƒæ•ˆæœå’Œè¯„ä¼°çš„å¯é æ€§ã€‚</span></span><br><span class="line"><span class="comment"># 2.  **æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œè¯„ä¼°çš„å‡†ç¡®æ€§**ï¼š</span></span><br><span class="line"><span class="comment">#     *   ç”±äºè®­ç»ƒé›†å’Œæµ‹è¯•é›†éƒ½è¾ƒå¥½åœ°ä»£è¡¨äº†åŸå§‹æ•°æ®çš„ç±»åˆ«åˆ†å¸ƒï¼Œæ¨¡å‹åœ¨è®­ç»ƒæ—¶èƒ½å­¦ä¹ åˆ°å„ä¸ªç±»åˆ«çš„ç‰¹å¾ï¼Œè¯„ä¼°æ—¶ä¹Ÿèƒ½æ›´å‡†ç¡®åœ°åæ˜ æ¨¡å‹åœ¨æ‰€æœ‰ç±»åˆ«ä¸Šçš„è¡¨ç°ã€‚</span></span><br><span class="line"><span class="comment">#     *   é¿å…äº†å› éšæœºåˆ’åˆ†å¯¼è‡´è®­ç»ƒé›†å’Œæµ‹è¯•é›†åœ¨ç±»åˆ«åˆ†å¸ƒä¸Šäº§ç”Ÿè¾ƒå¤§å·®å¼‚ï¼Œä»è€Œä½¿å¾—æ¨¡å‹è¯„ä¼°ç»“æœæ›´åŠ ç¨³å®šå’Œå¯ä¿¡ã€‚</span></span><br><span class="line"><span class="comment"># 3.  **å‡å°‘æŠ½æ ·è¯¯å·®**ï¼š</span></span><br><span class="line"><span class="comment">#     *   ç›¸æ¯”äºç®€å•éšæœºæŠ½æ ·ï¼Œåˆ†å±‚æŠ½æ ·é€šå¸¸èƒ½å¾—åˆ°æ›´å…·ä»£è¡¨æ€§çš„æ ·æœ¬ï¼Œä»è€Œå‡å°‘å› æŠ½æ ·å¸¦æ¥çš„è¯¯å·®ï¼Œä½¿å¾—åŸºäºæ ·æœ¬çš„æ¨æ–­æ›´åŠ ç²¾ç¡®ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡æç¤º1"><a href="#ä»»åŠ¡æç¤º1" class="headerlink" title="ä»»åŠ¡æç¤º1"></a>ä»»åŠ¡æç¤º1</h4><ul>
<li>åˆ‡å‰²æ•°æ®é›†æ˜¯ä¸ºäº†åç»­èƒ½è¯„ä¼°æ¨¡å‹æ³›åŒ–èƒ½åŠ›</li>
<li>sklearnä¸­åˆ‡å‰²æ•°æ®é›†çš„æ–¹æ³•ä¸º<code>train_test_split</code></li>
<li>æŸ¥çœ‹å‡½æ•°æ–‡æ¡£å¯ä»¥åœ¨jupyter notebooé‡Œé¢ä½¿ç”¨<code>train_test_split?</code>åå›è½¦å³å¯çœ‹åˆ°</li>
<li>åˆ†å±‚å’Œéšæœºç§å­åœ¨å‚æ•°é‡Œå¯»æ‰¾</li>
</ul>
<p>è¦ä»clear_data.csvå’Œtrain.csvä¸­æå–train_test_split()æ‰€éœ€çš„å‚æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="comment"># ä¸€èˆ¬å…ˆå–å‡ºXå’Œyåå†åˆ‡å‰²ï¼Œæœ‰äº›æƒ…å†µä¼šä½¿ç”¨åˆ°æœªåˆ‡å‰²çš„ï¼Œè¿™æ—¶å€™Xå’Œyå°±å¯ä»¥ç”¨,xæ˜¯æ¸…æ´—å¥½çš„æ•°æ®ï¼Œyæ˜¯æˆ‘ä»¬è¦é¢„æµ‹çš„å­˜æ´»æ•°æ®&#x27;Survived&#x27;</span></span><br><span class="line">X = data</span><br><span class="line">y = train[<span class="string">&#x27;Survived&#x27;</span>]</span><br><span class="line"><span class="comment"># å¯¹æ•°æ®é›†è¿›è¡Œåˆ‡å‰²</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, stratify=y, random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"></span><br><span class="line">X_train.shape, X_test.shape</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>((668, 11), (223, 11))
</code></pre><p>ã€æ€è€ƒã€‘</p>
<ul>
<li>ä»€ä¹ˆæƒ…å†µä¸‹åˆ‡å‰²æ•°æ®é›†çš„æ—¶å€™ä¸ç”¨è¿›è¡Œéšæœºé€‰å–</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="comment"># åœ¨ä»¥ä¸‹æƒ…å†µä¸‹åˆ‡å‰²æ•°æ®é›†æ—¶å¯èƒ½ä¸éœ€è¦æˆ–ä¸é€‚åˆè¿›è¡Œéšæœºé€‰å–ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.  **æ—¶é—´åºåˆ—æ•°æ® (Time Series Data)**ï¼š</span></span><br><span class="line"><span class="comment">#     *   å¯¹äºæ—¶é—´åºåˆ—æ•°æ®ï¼Œæ•°æ®çš„é¡ºåºè‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒåŒ…å«äº†æ—¶é—´ä¾èµ–æ€§ã€‚éšæœºæ‰“ä¹±é¡ºåºä¼šç ´åè¿™ç§ä¾èµ–å…³ç³»ã€‚</span></span><br><span class="line"><span class="comment">#     *   é€šå¸¸çš„åšæ³•æ˜¯æŒ‰æ—¶é—´é¡ºåºåˆ’åˆ†ï¼Œä¾‹å¦‚ï¼Œå°†è¾ƒæ—©çš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†ï¼Œè¾ƒæ™šçš„æ•°æ®ä½œä¸ºæµ‹è¯•é›†ï¼ˆæˆ–éªŒè¯é›†ï¼‰ã€‚è¿™æ›´ç¬¦åˆå®é™…åº”ç”¨ä¸­ç”¨è¿‡å»é¢„æµ‹æœªæ¥çš„åœºæ™¯ã€‚</span></span><br><span class="line"><span class="comment">#     *   ä¾‹å¦‚ï¼Œç”¨å‰å‡ å¹´çš„è‚¡ç¥¨æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œç”¨æœ€è¿‘ä¸€å¹´çš„æ•°æ®æµ‹è¯•æ¨¡å‹ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.  **æ•°æ®å·²ç»é¢„å…ˆæ’åºæˆ–å…·æœ‰ç‰¹å®šç»“æ„**ï¼š</span></span><br><span class="line"><span class="comment">#     *   å¦‚æœæ•°æ®é›†å·²ç»æŒ‰ç…§æŸç§å¯¹åˆ†ææœ‰æ„ä¹‰çš„é¡ºåºæ’åˆ—ï¼ˆä¾‹å¦‚ï¼ŒæŒ‰åœ°ç†åŒºåŸŸã€æŒ‰å®éªŒæ‰¹æ¬¡ç­‰ï¼‰ï¼Œå¹¶ä¸”ä½ å¸Œæœ›æµ‹è¯•é›†æ¥è‡ªä¸è®­ç»ƒé›†ä¸åŒçš„ã€ç‰¹å®šçš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦æŒ‰é¡ºåºæˆ–æŒ‰ç‰¹å®šè§„åˆ™åˆ’åˆ†ï¼Œè€Œä¸æ˜¯éšæœºåˆ’åˆ†ã€‚</span></span><br><span class="line"><span class="comment">#     *   ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªå…¨å›½æ€§çš„è°ƒæŸ¥æ•°æ®ä¸­ï¼Œä½ å¯èƒ½æƒ³ç”¨æŸäº›çœä»½çš„æ•°æ®åšè®­ç»ƒï¼Œç”¨å¦ä¸€äº›çœä»½çš„æ•°æ®åšæµ‹è¯•ï¼Œä»¥æ£€éªŒæ¨¡å‹çš„åœ°åŸŸæ³›åŒ–èƒ½åŠ›ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.  **æ•°æ®é›†éå¸¸å¤§ä¸”åˆ†å¸ƒå‡åŒ€**ï¼š</span></span><br><span class="line"><span class="comment">#     *   å½“æ•°æ®é›†éå¸¸åºå¤§ï¼Œå¹¶ä¸”å¯ä»¥åˆç†å‡è®¾æ•°æ®æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒ (i.i.d.) ä¸”åˆ†å¸ƒå‡åŒ€æ—¶ï¼Œç®€å•åœ°æŒ‰é¡ºåºå–ä¸€éƒ¨åˆ†ä½œä¸ºè®­ç»ƒé›†ï¼Œå¦ä¸€éƒ¨åˆ†ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶æ•ˆæœå¯èƒ½ä¸éšæœºé€‰å–ç›¸å·®ä¸å¤§ã€‚éšæœºé€‰å–çš„è®¡ç®—å¼€é”€åœ¨è¿™ç§æƒ…å†µä¸‹å¯èƒ½æ˜¾å¾—ä¸å¿…è¦ã€‚</span></span><br><span class="line"><span class="comment">#     *   ç„¶è€Œï¼Œå³ä½¿åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéšæœºé€‰å–é€šå¸¸ä»ç„¶æ˜¯æ›´ç¨³å¦¥çš„åšæ³•ï¼Œä»¥é¿å…æ½œåœ¨çš„æœªçŸ¥åå·®ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.  **ç‰¹å®šçš„äº¤å‰éªŒè¯ç­–ç•¥**ï¼š</span></span><br><span class="line"><span class="comment">#     *   æŸäº›äº¤å‰éªŒè¯æ–¹æ³•æœ¬èº«å°±å®šä¹‰äº†ééšæœºçš„åˆ’åˆ†æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œåœ¨kæŠ˜äº¤å‰éªŒè¯ä¸­ï¼Œè™½ç„¶æ•´ä½“ä¸Šæ•°æ®è¢«åˆ†æˆäº†kæŠ˜ï¼Œä½†æ¯ä¸€æŠ˜çš„é€‰æ‹©æ˜¯ç¡®å®šçš„ï¼ˆé€šå¸¸æ˜¯æŒ‰é¡ºåºåˆ†å‰²ï¼‰ã€‚ç•™ä¸€æ³•äº¤å‰éªŒè¯æ›´æ˜¯æ¯æ¬¡åªç•™ä¸€ä¸ªç‰¹å®šçš„æ ·æœ¬ä½œä¸ºæµ‹è¯•é›†ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.  **å½“éœ€è¦å®Œå…¨å¤ç°ç‰¹å®šçš„ã€ééšæœºçš„åˆ’åˆ†ç»“æœæ—¶**ï¼š</span></span><br><span class="line"><span class="comment">#     *   å¦‚æœä¹‹å‰çš„ç ”ç©¶æˆ–å®éªŒä½¿ç”¨äº†æŸç§ç‰¹å®šçš„ééšæœºåˆ’åˆ†æ–¹å¼ï¼Œä¸ºäº†æ¯”è¾ƒæˆ–å¤ç°ç»“æœï¼Œä¹Ÿéœ€è¦é‡‡ç”¨ç›¸åŒçš„åˆ’åˆ†æ–¹å¼ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.  **æµå¼æ•°æ®æˆ–åœ¨çº¿å­¦ä¹ åœºæ™¯**ï¼š</span></span><br><span class="line"><span class="comment">#     *   åœ¨æ•°æ®æŒç»­ä¸æ–­æµå…¥çš„åœºæ™¯ä¸­ï¼Œæ¨¡å‹å¯èƒ½éœ€è¦ç”¨æ–°åˆ°è¾¾çš„æ•°æ®è¿›è¡Œæµ‹è¯•æˆ–æŒç»­è®­ç»ƒã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæµ‹è¯•é›†è‡ªç„¶æ˜¯æœ€æ–°çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè€Œä¸æ˜¯ä»å†å²æ•°æ®ä¸­éšæœºæŠ½å–çš„ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡äºŒï¼šæ¨¡å‹åˆ›å»º"><a href="#ä»»åŠ¡äºŒï¼šæ¨¡å‹åˆ›å»º" class="headerlink" title="ä»»åŠ¡äºŒï¼šæ¨¡å‹åˆ›å»º"></a>ä»»åŠ¡äºŒï¼šæ¨¡å‹åˆ›å»º</h4><ul>
<li>åˆ›å»ºåŸºäºçº¿æ€§æ¨¡å‹çš„åˆ†ç±»æ¨¡å‹ï¼ˆé€»è¾‘å›å½’ï¼‰</li>
<li>åˆ›å»ºåŸºäºæ ‘çš„åˆ†ç±»æ¨¡å‹ï¼ˆå†³ç­–æ ‘ã€éšæœºæ£®æ—ï¼‰</li>
<li>åˆ†åˆ«ä½¿ç”¨è¿™äº›æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œåˆ†åˆ«çš„åˆ°è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„å¾—åˆ†</li>
<li>æŸ¥çœ‹æ¨¡å‹çš„å‚æ•°ï¼Œå¹¶æ›´æ”¹å‚æ•°å€¼ï¼Œè§‚å¯Ÿæ¨¡å‹å˜åŒ–</li>
</ul>
<h4 id="æç¤º"><a href="#æç¤º" class="headerlink" title="æç¤º"></a>æç¤º</h4><ul>
<li>é€»è¾‘å›å½’ä¸æ˜¯å›å½’æ¨¡å‹è€Œæ˜¯åˆ†ç±»æ¨¡å‹ï¼Œä¸è¦ä¸<code>LinearRegression</code>æ··æ·†</li>
<li>éšæœºæ£®æ—å…¶å®æ˜¯å†³ç­–æ ‘é›†æˆä¸ºäº†é™ä½å†³ç­–æ ‘è¿‡æ‹Ÿåˆçš„æƒ…å†µ</li>
<li>çº¿æ€§æ¨¡å‹æ‰€åœ¨çš„æ¨¡å—ä¸º<code>sklearn.linear_model</code></li>
<li>æ ‘æ¨¡å‹æ‰€åœ¨çš„æ¨¡å—ä¸º<code>sklearn.ensemble</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># é»˜è®¤å‚æ•°é€»è¾‘å›å½’æ¨¡å‹</span></span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">lr.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>/root/.pyenv/versions/3.11.1/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:465: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è®­ç»ƒé›†å’Œæµ‹è¯•é›†scoreå€¼</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Training set score: &#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(lr.score(X_train, y_train)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Testing set score: &#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(lr.score(X_test, y_test)))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Training set score: 0.80
Testing set score: 0.79
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># è°ƒæ•´å‚æ•°åçš„é€»è¾‘å›å½’æ¨¡å‹</span></span><br><span class="line">lr2 = LogisticRegression(C=<span class="number">100</span>)</span><br><span class="line">lr2.fit(X_train, y_train)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Training set score: &#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(lr2.score(X_train, y_train)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Testing set score: &#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(lr2.score(X_test, y_test)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Training set score: 0.79
Testing set score: 0.78


/root/.pyenv/versions/3.11.1/lib/python3.11/site-packages/sklearn/linear_model/_logistic.py:465: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. OF ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤å‚æ•°çš„éšæœºæ£®æ—åˆ†ç±»æ¨¡å‹</span></span><br><span class="line">rfc = RandomForestClassifier()</span><br><span class="line">rfc.fit(X_train, y_train)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Training set score: &#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(rfc.score(X_train, y_train)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Testing set score: &#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(rfc.score(X_test, y_test)))</span><br></pre></td></tr></table></figure>
<pre><code>Training set score: 1.00
Testing set score: 0.82
</code></pre><p>ã€æ€è€ƒã€‘</p>
<ul>
<li>ä¸ºä»€ä¹ˆçº¿æ€§æ¨¡å‹å¯ä»¥è¿›è¡Œåˆ†ç±»ä»»åŠ¡ï¼ŒèƒŒåæ˜¯æ€ä¹ˆçš„æ•°å­¦å…³ç³»</li>
<li>å¯¹äºå¤šåˆ†ç±»é—®é¢˜ï¼Œçº¿æ€§æ¨¡å‹æ˜¯æ€ä¹ˆè¿›è¡Œåˆ†ç±»çš„</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="comment"># ä¸ºä»€ä¹ˆçº¿æ€§æ¨¡å‹å¯ä»¥è¿›è¡Œåˆ†ç±»ä»»åŠ¡ï¼ŒèƒŒåæ˜¯æ€ä¹ˆçš„æ•°å­¦å…³ç³»</span></span><br><span class="line"><span class="comment"># çº¿æ€§æ¨¡å‹ï¼ˆå¦‚é€»è¾‘å›å½’ Logistic Regressionï¼Œæˆ–è€…æ”¯æŒå‘é‡æœº SVM çš„çº¿æ€§æ ¸ï¼‰ä¹‹æ‰€ä»¥èƒ½ç”¨äºåˆ†ç±»ä»»åŠ¡ï¼Œæ˜¯å› ä¸ºå®ƒä»¬é€šè¿‡ä»¥ä¸‹æ–¹å¼å°†çº¿æ€§ç»„åˆçš„è¾“å…¥ç‰¹å¾æ˜ å°„åˆ°ç±»åˆ«é¢„æµ‹ï¼š</span></span><br><span class="line"><span class="comment"># 1.  **çº¿æ€§ç»„åˆ**ï¼šé¦–å…ˆï¼Œæ¨¡å‹è®¡ç®—è¾“å…¥ç‰¹å¾çš„çº¿æ€§ç»„åˆï¼Œå½¢å¼é€šå¸¸ä¸º `z = w_1*x_1 + w_2*x_2 + ... + w_n*x_n + b`ï¼Œæˆ–è€…ç”¨å‘é‡è¡¨ç¤ºä¸º `z = w^T * x + b`ã€‚</span></span><br><span class="line"><span class="comment">#     *   `x` æ˜¯è¾“å…¥ç‰¹å¾å‘é‡ã€‚</span></span><br><span class="line"><span class="comment">#     *   `w` æ˜¯æ¨¡å‹å­¦ä¹ åˆ°çš„æƒé‡ï¼ˆæˆ–ç³»æ•°ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#     *   `b` æ˜¯åç½®é¡¹ï¼ˆæˆ–æˆªè·ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#     è¿™ä¸ª `z` å€¼å¯ä»¥çœ‹ä½œæ˜¯æ ·æœ¬ç‚¹åˆ°å†³ç­–è¾¹ç•Œçš„æŸç§åº¦é‡ã€‚</span></span><br><span class="line"><span class="comment"># 2.  **å†³ç­–å‡½æ•°/æ¿€æ´»å‡½æ•°**ï¼šç„¶åï¼Œè¿™ä¸ªçº¿æ€§ç»„åˆçš„ç»“æœ `z` ä¼šè¢«ä¼ é€’ç»™ä¸€ä¸ªå†³ç­–å‡½æ•°æˆ–æ¿€æ´»å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†å…¶è½¬æ¢ä¸ºç±»åˆ«é¢„æµ‹æˆ–ç±»åˆ«æ¦‚ç‡ã€‚</span></span><br><span class="line"><span class="comment">#     *   **å¯¹äºé€»è¾‘å›å½’ (Logistic Regression)**ï¼š</span></span><br><span class="line"><span class="comment">#         *   å®ƒä½¿ç”¨ Sigmoid (Logistic) å‡½æ•°ï¼š`p = 1 / (1 + e^(-z))`ã€‚</span></span><br><span class="line"><span class="comment">#         *   Sigmoid å‡½æ•°å°†ä»»æ„å®æ•°å€¼ `z` æ˜ å°„åˆ° (0, 1) åŒºé—´ï¼Œè¿™ä¸ªè¾“å‡º `p` å¯ä»¥è§£é‡Šä¸ºæ ·æœ¬å±äºæ­£ç±»ï¼ˆé€šå¸¸æ˜¯ç±»åˆ«1ï¼‰çš„æ¦‚ç‡ã€‚</span></span><br><span class="line"><span class="comment">#         *   é€šè¿‡è®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼ˆé€šå¸¸æ˜¯0.5ï¼‰ï¼Œå¦‚æœ `p &gt; 0.5` (å³ `z &gt; 0`)ï¼Œåˆ™é¢„æµ‹ä¸ºæ­£ç±»ï¼›å¦åˆ™é¢„æµ‹ä¸ºè´Ÿç±»ã€‚</span></span><br><span class="line"><span class="comment">#         *   å› æ­¤ï¼Œå†³ç­–è¾¹ç•Œæ˜¯ `z = 0`ï¼Œå³ `w^T * x + b = 0`ï¼Œè¿™æ˜¯ä¸€ä¸ªè¶…å¹³é¢ã€‚</span></span><br><span class="line"><span class="comment">#     *   **å¯¹äºçº¿æ€§æ”¯æŒå‘é‡æœº (Linear SVM)**ï¼š</span></span><br><span class="line"><span class="comment">#         *   å®ƒç›´æ¥ä½¿ç”¨ `z` çš„ç¬¦å·æ¥å†³å®šç±»åˆ«ã€‚å¦‚æœ `z &gt; 0`ï¼Œé¢„æµ‹ä¸ºä¸€ç±»ï¼›å¦‚æœ `z &lt; 0`ï¼Œé¢„æµ‹ä¸ºå¦ä¸€ç±»ã€‚</span></span><br><span class="line"><span class="comment">#         *   SVM çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªèƒ½æœ€å¤§åŒ–ä¸¤ç±»æ ·æœ¬ä¹‹é—´é—´éš”ï¼ˆmarginï¼‰çš„å†³ç­–è¾¹ç•Œï¼ˆè¶…å¹³é¢ï¼‰ã€‚</span></span><br><span class="line"><span class="comment"># æ€»ç»“æ¥è¯´ï¼Œçº¿æ€§æ¨¡å‹é€šè¿‡å­¦ä¹ ä¸€ä¸ªçº¿æ€§å†³ç­–è¾¹ç•Œï¼ˆç›´çº¿ã€å¹³é¢æˆ–è¶…å¹³é¢ï¼‰æ¥åˆ†éš”ä¸åŒç±»åˆ«çš„æ ·æœ¬ã€‚å®ƒä»¬é¦–å…ˆè®¡ç®—ä¸€ä¸ªçº¿æ€§å¾—åˆ†ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªéçº¿æ€§å‡½æ•°ï¼ˆå¦‚Sigmoidï¼‰æˆ–ç›´æ¥æ ¹æ®å¾—åˆ†çš„ç¬¦å·æ¥åšå‡ºåˆ†ç±»å†³ç­–ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹äºå¤šåˆ†ç±»é—®é¢˜ï¼Œçº¿æ€§æ¨¡å‹æ˜¯æ€ä¹ˆè¿›è¡Œåˆ†ç±»çš„</span></span><br><span class="line"><span class="comment"># å½“ç±»åˆ«æ•°é‡å¤§äºä¸¤ä¸ªæ—¶ï¼ˆå³å¤šåˆ†ç±»é—®é¢˜ï¼‰ï¼Œçº¿æ€§æ¨¡å‹é€šå¸¸é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§ä¸»è¦ç­–ç•¥ä¹‹ä¸€å°†é—®é¢˜è½¬åŒ–ä¸ºå¤šä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼š</span></span><br><span class="line"><span class="comment"># 1.  **ä¸€å¯¹ä½™ (One-vs-Rest, OvR) æˆ– ä¸€å¯¹æ‰€æœ‰ (One-vs-All, OvA)**ï¼š</span></span><br><span class="line"><span class="comment">#     *   **åŸç†**ï¼šå¦‚æœæœ‰ä¸ª `K` ä¸ªç±»åˆ«ï¼ŒOvR ç­–ç•¥ä¼šè®­ç»ƒ `K` ä¸ªç‹¬ç«‹çš„äºŒåˆ†ç±»å™¨ã€‚</span></span><br><span class="line"><span class="comment">#     *   ç¬¬ `i` ä¸ªåˆ†ç±»å™¨ (`i` ä» 1 åˆ° `K`) ä¼šå°†ç±»åˆ« `i` çš„æ ·æœ¬è§†ä¸ºæ­£ç±»ï¼Œè€Œå°†æ‰€æœ‰å…¶ä»– `K-1` ä¸ªç±»åˆ«çš„æ ·æœ¬è§†ä¸ºè´Ÿç±»ã€‚</span></span><br><span class="line"><span class="comment">#     *   **é¢„æµ‹**ï¼šå¯¹äºä¸€ä¸ªæ–°çš„æ ·æœ¬ï¼Œå®ƒä¼šè¢«è¾“å…¥åˆ°æ‰€æœ‰ `K` ä¸ªåˆ†ç±»å™¨ä¸­ã€‚æ¯ä¸ªåˆ†ç±»å™¨éƒ½ä¼šè¾“å‡ºä¸€ä¸ªåˆ†æ•°æˆ–æ¦‚ç‡ï¼Œè¡¨ç¤ºè¯¥æ ·æœ¬å±äºå…¶å¯¹åº”â€œæ­£ç±»â€çš„ç½®ä¿¡åº¦ã€‚æœ€ç»ˆï¼Œæ ·æœ¬è¢«åˆ†é…ç»™é‚£ä¸ªç»™å‡ºæœ€é«˜ç½®ä¿¡åº¦åˆ†æ•°çš„ç±»åˆ«ã€‚</span></span><br><span class="line"><span class="comment">#     *   **ä¼˜ç‚¹**ï¼šç›´è§‚ï¼Œå®ç°ç›¸å¯¹ç®€å•ï¼Œè®¡ç®—æ•ˆç‡è¾ƒé«˜ï¼ˆåªéœ€è¦è®­ç»ƒKä¸ªåˆ†ç±»å™¨ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">#     *   **ç¼ºç‚¹**ï¼šå½“ç±»åˆ«æ•°é‡å¾ˆå¤šæ—¶ï¼Œæ¯ä¸ªäºŒåˆ†ç±»å™¨çš„è´Ÿç±»å¯èƒ½åŒ…å«éå¸¸å¤šæ ·åŒ–çš„æ ·æœ¬ï¼Œå¯èƒ½å¯¼è‡´ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.  **ä¸€å¯¹ä¸€ (One-vs-One, OvO)**ï¼š</span></span><br><span class="line"><span class="comment">#     *   **åŸç†**ï¼šå¦‚æœæœ‰ä¸ª `K` ä¸ªç±»åˆ«ï¼ŒOvO ç­–ç•¥ä¼šä¸ºæ¯ä¸€å¯¹ç±»åˆ« `(i, j)` è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»å™¨ï¼Œå…¶ä¸­ `i != j`ã€‚æ€»å…±éœ€è¦è®­ç»ƒ `K * (K-1) / 2` ä¸ªåˆ†ç±»å™¨ã€‚</span></span><br><span class="line"><span class="comment">#     *   æ¯ä¸ªåˆ†ç±»å™¨åªè´Ÿè´£åŒºåˆ†ä¸¤ä¸ªç‰¹å®šçš„ç±»åˆ«ã€‚</span></span><br><span class="line"><span class="comment">#     *   **é¢„æµ‹**ï¼šå¯¹äºä¸€ä¸ªæ–°çš„æ ·æœ¬ï¼Œå®ƒä¼šè¢«è¾“å…¥åˆ°æ‰€æœ‰ `K * (K-1) / 2` ä¸ªåˆ†ç±»å™¨ä¸­ã€‚æ¯ä¸ªåˆ†ç±»å™¨éƒ½ä¼šå¯¹æ ·æœ¬å±äºå…¶ä¸¤ä¸ªç±»åˆ«ä¸­çš„å“ªä¸€ä¸ªè¿›è¡ŒæŠ•ç¥¨ã€‚æœ€ç»ˆï¼Œæ ·æœ¬è¢«åˆ†é…ç»™è·å¾—æœ€å¤šæŠ•ç¥¨çš„ç±»åˆ«ã€‚</span></span><br><span class="line"><span class="comment">#     *   **ä¼˜ç‚¹**ï¼šæ¯ä¸ªåˆ†ç±»å™¨åªéœ€è¦å¤„ç†ä¸¤ä¸ªç±»åˆ«çš„æ•°æ®ï¼Œé€šå¸¸è®­ç»ƒé€Ÿåº¦æ›´å¿«ï¼Œä¸”å¯¹äºæŸäº›å¯¹ç±»åˆ«ä¸å¹³è¡¡ä¸æ•æ„Ÿçš„ç®—æ³•ï¼ˆå¦‚SVMï¼‰å¯èƒ½è¡¨ç°æ›´å¥½ã€‚</span></span><br><span class="line"><span class="comment">#     *   **ç¼ºç‚¹**ï¼šå½“ç±»åˆ«æ•°é‡ `K` å¾ˆå¤§æ—¶ï¼Œéœ€è¦è®­ç»ƒçš„åˆ†ç±»å™¨æ•°é‡ä¼šæ€¥å‰§å¢åŠ ï¼Œå¯¼è‡´è®¡ç®—æˆæœ¬å’Œå­˜å‚¨æˆæœ¬è¾ƒé«˜ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># **åœ¨ scikit-learn ä¸­**ï¼š</span></span><br><span class="line"><span class="comment"># *   `LogisticRegression` é»˜è®¤ä½¿ç”¨ OvR ç­–ç•¥è¿›è¡Œå¤šåˆ†ç±» (å¯ä»¥é€šè¿‡ `multi_class` å‚æ•°è®¾ç½®ä¸º `&#x27;multinomial&#x27;` æ¥ä½¿ç”¨ Softmax å›å½’ï¼Œè¿™æ˜¯ä¸€ç§ç›´æ¥å¤„ç†å¤šåˆ†ç±»çš„æ–¹æ³•ï¼Œä½†å…¶åŸºç¡€ä»ç„¶æ˜¯çº¿æ€§çš„)ã€‚</span></span><br><span class="line"><span class="comment"># *   `LinearSVC` (çº¿æ€§æ”¯æŒå‘é‡æœº) é»˜è®¤ä½¿ç”¨ OvR ç­–ç•¥ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ä»»åŠ¡ä¸‰ï¼šè¾“å‡ºæ¨¡å‹é¢„æµ‹ç»“æœ"><a href="#ä»»åŠ¡ä¸‰ï¼šè¾“å‡ºæ¨¡å‹é¢„æµ‹ç»“æœ" class="headerlink" title="ä»»åŠ¡ä¸‰ï¼šè¾“å‡ºæ¨¡å‹é¢„æµ‹ç»“æœ"></a>ä»»åŠ¡ä¸‰ï¼šè¾“å‡ºæ¨¡å‹é¢„æµ‹ç»“æœ</h4><ul>
<li>è¾“å‡ºæ¨¡å‹é¢„æµ‹åˆ†ç±»æ ‡ç­¾</li>
<li>è¾“å‡ºä¸åŒåˆ†ç±»æ ‡ç­¾çš„é¢„æµ‹æ¦‚ç‡</li>
</ul>
<h4 id="æç¤º3"><a href="#æç¤º3" class="headerlink" title="æç¤º3"></a>æç¤º3</h4><ul>
<li>ä¸€èˆ¬ç›‘ç£æ¨¡å‹åœ¨sklearné‡Œé¢æœ‰ä¸ª<code>predict</code>èƒ½è¾“å‡ºé¢„æµ‹æ ‡ç­¾ï¼Œ<code>predict_proba</code>åˆ™å¯ä»¥è¾“å‡ºæ ‡ç­¾æ¦‚ç‡</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">pred = lr.predict(X_train)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">pred[:<span class="number">10</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([0, 1, 1, 1, 0, 0, 1, 0, 1, 1])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">pred_proba = lr.predict_proba(X_train)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">pred_proba[:<span class="number">10</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.60887905, 0.39112095],
       [0.17668722, 0.82331278],
       [0.40624596, 0.59375404],
       [0.18896449, 0.81103551],
       [0.87984221, 0.12015779],
       [0.91385758, 0.08614242],
       [0.13282516, 0.86717484],
       [0.90555878, 0.09444122],
       [0.05280619, 0.94719381],
       [0.10934565, 0.89065435]])
</code></pre><p>ã€æ€è€ƒã€‘</p>
<ul>
<li>é¢„æµ‹æ ‡ç­¾çš„æ¦‚ç‡å¯¹æˆ‘ä»¬æœ‰ä»€ä¹ˆå¸®åŠ©</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%E6%95%B0%E6%8D%AE%E9%87%8D%E6%9E%841-%E8%AF%BE%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E4%BA%8C%E8%8A%82%E6%95%B0%E6%8D%AE%E9%87%8D%E6%9E%841-%E8%AF%BE%E7%A8%8B/" class="post-title-link" itemprop="url">æ•°æ®åˆ†æâ€”â€”ç¬¬äºŒç« ï¼šç¬¬äºŒèŠ‚æ•°æ®é‡æ„1</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00 / ä¿®æ”¹æ—¶é—´ï¼š17:06:05" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/" itemprop="url" rel="index"><span itemprop="name">kaggle</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/titanic/" itemprop="url" rel="index"><span itemprop="name">titanic</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>å¤ä¹ ï¼š</strong>åœ¨å‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†PandasåŸºç¡€ï¼Œç¬¬äºŒç« æˆ‘ä»¬å¼€å§‹è¿›å…¥æ•°æ®åˆ†æçš„ä¸šåŠ¡éƒ¨åˆ†ï¼Œåœ¨ç¬¬äºŒç« ç¬¬ä¸€èŠ‚çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†<strong>æ•°æ®çš„æ¸…æ´—</strong>ï¼Œè¿™ä¸€éƒ¨åˆ†ååˆ†é‡è¦ï¼Œåªæœ‰æ•°æ®å˜å¾—ç›¸å¯¹å¹²å‡€ï¼Œæˆ‘ä»¬ä¹‹åå¯¹æ•°æ®çš„åˆ†ææ‰å¯ä»¥æ›´æœ‰åŠ›ã€‚è€Œè¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯æ•°æ®é‡æ„ï¼Œæ•°æ®é‡æ„ä¾æ—§å±äºæ•°æ®ç†è§£ï¼ˆå‡†å¤‡ï¼‰çš„èŒƒå›´ã€‚</p>
<h4 id="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®"><a href="#å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®" class="headerlink" title="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®"></a>å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasåŒ…å’Œæ•°æ®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥åŸºæœ¬åº“</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½½å…¥dataæ–‡ä»¶ä¸­çš„:train-left-up.csv</span></span><br><span class="line">text=pd.read_csv(<span class="string">&#x27;../ç¬¬äºŒç« é¡¹ç›®é›†åˆ/data/train-left-up.csv&#x27;</span>)</span><br><span class="line">text.head()</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
    </tr>
  </tbody>
</table>
# 2 ç¬¬äºŒç« ï¼šæ•°æ®é‡æ„


### 2.4 æ•°æ®çš„åˆå¹¶

#### 2.4.1 ä»»åŠ¡ä¸€ï¼šå°†dataæ–‡ä»¶å¤¹é‡Œé¢çš„æ‰€æœ‰æ•°æ®éƒ½è½½å…¥ï¼Œè§‚å¯Ÿæ•°æ®çš„ä¹‹é—´çš„å…³ç³»


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">text_left_up=pd.read_csv(<span class="string">&#x27;../ç¬¬äºŒç« é¡¹ç›®é›†åˆ/data/train-left-up.csv&#x27;</span>)</span><br><span class="line">text_left_down=pd.read_csv(<span class="string">&#x27;../ç¬¬äºŒç« é¡¹ç›®é›†åˆ/data/train-left-down.csv&#x27;</span>)</span><br><span class="line">text_right_up=pd.read_csv(<span class="string">&#x27;../ç¬¬äºŒç« é¡¹ç›®é›†åˆ/data/train-right-up.csv&#x27;</span>)</span><br><span class="line">text_right_down=pd.read_csv(<span class="string">&#x27;../ç¬¬äºŒç« é¡¹ç›®é›†åˆ/data/train-right-down.csv&#x27;</span>)</span><br><span class="line">text_left_up.head()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
    </tr>
  </tbody>
</table>
ã€æç¤ºã€‘ç»“åˆä¹‹å‰æˆ‘ä»¬åŠ è½½çš„train.csvæ•°æ®ï¼Œå¤§è‡´é¢„æµ‹ä¸€ä¸‹ä¸Šé¢çš„æ•°æ®æ˜¯ä»€ä¹ˆ

#### 2.4.2ï¼šä»»åŠ¡äºŒï¼šä½¿ç”¨concatæ–¹æ³•ï¼šå°†æ•°æ®train-left-up.csvå’Œtrain-right-up.csvæ¨ªå‘åˆå¹¶ä¸ºä¸€å¼ è¡¨ï¼Œå¹¶ä¿å­˜è¿™å¼ è¡¨ä¸ºresult_up


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#pandas.concat æ˜¯ Pandas ä¸­ç”¨äºè¿æ¥ Series æˆ– DataFrame å¯¹è±¡çš„æ ¸å¿ƒæ–¹æ³•ï¼Œæ”¯æŒæ¨ªå‘ï¼ˆåˆ—æ–¹å‘ï¼‰æˆ–çºµå‘ï¼ˆè¡Œæ–¹å‘ï¼‰æ‹¼æ¥</span></span><br><span class="line">list_up = [text_left_up,text_right_up]</span><br><span class="line">result_up = pd.concat(list_up,axis=<span class="number">1</span>)</span><br><span class="line">result_up.head()</span><br></pre></td></tr></table></figure>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>


<h4 id="2-4-3-ä»»åŠ¡ä¸‰ï¼šä½¿ç”¨concatæ–¹æ³•ï¼šå°†train-left-downå’Œtrain-right-downæ¨ªå‘åˆå¹¶ä¸ºä¸€å¼ è¡¨ï¼Œå¹¶ä¿å­˜è¿™å¼ è¡¨ä¸ºresult-downã€‚ç„¶åå°†ä¸Šè¾¹çš„result-upå’Œresult-downçºµå‘åˆå¹¶ä¸ºresultã€‚"><a href="#2-4-3-ä»»åŠ¡ä¸‰ï¼šä½¿ç”¨concatæ–¹æ³•ï¼šå°†train-left-downå’Œtrain-right-downæ¨ªå‘åˆå¹¶ä¸ºä¸€å¼ è¡¨ï¼Œå¹¶ä¿å­˜è¿™å¼ è¡¨ä¸ºresult-downã€‚ç„¶åå°†ä¸Šè¾¹çš„result-upå’Œresult-downçºµå‘åˆå¹¶ä¸ºresultã€‚" class="headerlink" title="2.4.3 ä»»åŠ¡ä¸‰ï¼šä½¿ç”¨concatæ–¹æ³•ï¼šå°†train-left-downå’Œtrain-right-downæ¨ªå‘åˆå¹¶ä¸ºä¸€å¼ è¡¨ï¼Œå¹¶ä¿å­˜è¿™å¼ è¡¨ä¸ºresult_downã€‚ç„¶åå°†ä¸Šè¾¹çš„result_upå’Œresult_downçºµå‘åˆå¹¶ä¸ºresultã€‚"></a>2.4.3 ä»»åŠ¡ä¸‰ï¼šä½¿ç”¨concatæ–¹æ³•ï¼šå°†train-left-downå’Œtrain-right-downæ¨ªå‘åˆå¹¶ä¸ºä¸€å¼ è¡¨ï¼Œå¹¶ä¿å­˜è¿™å¼ è¡¨ä¸ºresult_downã€‚ç„¶åå°†ä¸Šè¾¹çš„result_upå’Œresult_downçºµå‘åˆå¹¶ä¸ºresultã€‚</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">list_down=[text_left_down,text_right_down]</span><br><span class="line">result_down = pd.concat(list_down,axis=<span class="number">1</span>)</span><br><span class="line">result = pd.concat([result_up,result_down])</span><br><span class="line">result.head()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>



<h4 id="2-4-4-ä»»åŠ¡å››ï¼šä½¿ç”¨DataFrameè‡ªå¸¦çš„æ–¹æ³•joinæ–¹æ³•å’Œappendï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡"><a href="#2-4-4-ä»»åŠ¡å››ï¼šä½¿ç”¨DataFrameè‡ªå¸¦çš„æ–¹æ³•joinæ–¹æ³•å’Œappendï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡" class="headerlink" title="2.4.4 ä»»åŠ¡å››ï¼šä½¿ç”¨DataFrameè‡ªå¸¦çš„æ–¹æ³•joinæ–¹æ³•å’Œappendï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡"></a>2.4.4 ä»»åŠ¡å››ï¼šä½¿ç”¨DataFrameè‡ªå¸¦çš„æ–¹æ³•joinæ–¹æ³•å’Œappendï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line">resul_up = text_left_up.join(text_right_up)</span><br><span class="line">result_down = text_left_down.join(text_right_down)</span><br><span class="line">result = result_up.append(result_down)</span><br><span class="line">result.head()</span><br></pre></td></tr></table></figure>
<h4 id="2-4-5-ä»»åŠ¡äº”ï¼šä½¿ç”¨Panadsçš„mergeæ–¹æ³•å’ŒDataFrameçš„appendæ–¹æ³•ï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡"><a href="#2-4-5-ä»»åŠ¡äº”ï¼šä½¿ç”¨Panadsçš„mergeæ–¹æ³•å’ŒDataFrameçš„appendæ–¹æ³•ï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡" class="headerlink" title="2.4.5 ä»»åŠ¡äº”ï¼šä½¿ç”¨Panadsçš„mergeæ–¹æ³•å’ŒDataFrameçš„appendæ–¹æ³•ï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡"></a>2.4.5 ä»»åŠ¡äº”ï¼šä½¿ç”¨Panadsçš„mergeæ–¹æ³•å’ŒDataFrameçš„appendæ–¹æ³•ï¼šå®Œæˆä»»åŠ¡äºŒå’Œä»»åŠ¡ä¸‰çš„ä»»åŠ¡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¯¥ä»£ç ä½¿ç”¨ pandas.merge æ–¹æ³•ï¼Œä»¥ç´¢å¼•ï¼ˆindexï¼‰ä¸ºé”®ï¼Œå°†ä¸¤ä¸ª DataFrame (text_left_up å’Œ text_right_up) æ¨ªå‘åˆå¹¶ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">result_up = pd.merge(text_left_up,text_right_up,left_index=<span class="literal">True</span>,right_index=<span class="literal">True</span>)</span><br><span class="line">result_down = pd.merge(text_left_down,text_right_down,left_index=<span class="literal">True</span>,right_index=<span class="literal">True</span>)</span><br><span class="line">result = resul_up.append(result_down)</span><br><span class="line">result.head()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ã€æ€è€ƒã€‘å¯¹æ¯”mergeã€joinä»¥åŠconcatçš„æ–¹æ³•çš„ä¸åŒä»¥åŠç›¸åŒã€‚æ€è€ƒä¸€ä¸‹åœ¨ä»»åŠ¡å››å’Œä»»åŠ¡äº”çš„æƒ…å†µä¸‹ï¼Œä¸ºä»€ä¹ˆéƒ½è¦æ±‚ä½¿ç”¨DataFrameçš„appendæ–¹æ³•ï¼Œå¦‚ä½•åªè¦æ±‚ä½¿ç”¨mergeæˆ–è€…joinå¯ä¸å¯ä»¥å®Œæˆä»»åŠ¡å››å’Œä»»åŠ¡äº”å‘¢ï¼Ÿ</p>
<h4 id="2-4-6-ä»»åŠ¡å…­ï¼šå®Œæˆçš„æ•°æ®ä¿å­˜ä¸ºresult-csv"><a href="#2-4-6-ä»»åŠ¡å…­ï¼šå®Œæˆçš„æ•°æ®ä¿å­˜ä¸ºresult-csv" class="headerlink" title="2.4.6 ä»»åŠ¡å…­ï¼šå®Œæˆçš„æ•°æ®ä¿å­˜ä¸ºresult.csv"></a>2.4.6 ä»»åŠ¡å…­ï¼šå®Œæˆçš„æ•°æ®ä¿å­˜ä¸ºresult.csv</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"></span><br><span class="line">result.to_csv(<span class="string">&#x27;result.csv&#x27;</span>)</span><br><span class="line">result.head()</span><br></pre></td></tr></table></figure>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>



<h3 id="2-5-æ¢ä¸€ç§è§’åº¦çœ‹æ•°æ®"><a href="#2-5-æ¢ä¸€ç§è§’åº¦çœ‹æ•°æ®" class="headerlink" title="2.5 æ¢ä¸€ç§è§’åº¦çœ‹æ•°æ®"></a>2.5 æ¢ä¸€ç§è§’åº¦çœ‹æ•°æ®</h3><h4 id="2-5-1-ä»»åŠ¡ä¸€ï¼šå°†æˆ‘ä»¬çš„æ•°æ®å˜ä¸ºSeriesç±»å‹çš„æ•°æ®"><a href="#2-5-1-ä»»åŠ¡ä¸€ï¼šå°†æˆ‘ä»¬çš„æ•°æ®å˜ä¸ºSeriesç±»å‹çš„æ•°æ®" class="headerlink" title="2.5.1 ä»»åŠ¡ä¸€ï¼šå°†æˆ‘ä»¬çš„æ•°æ®å˜ä¸ºSeriesç±»å‹çš„æ•°æ®"></a>2.5.1 ä»»åŠ¡ä¸€ï¼šå°†æˆ‘ä»¬çš„æ•°æ®å˜ä¸ºSeriesç±»å‹çš„æ•°æ®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment">#text.stack() æ˜¯ Pandas ä¸­ç”¨äºå°† DataFrame çš„åˆ—æ—‹è½¬ä¸ºè¡Œçš„æ–¹æ³•</span></span><br><span class="line">text = pd.read_csv(<span class="string">&#x27;result.csv&#x27;</span>)</span><br><span class="line">unit_result=text.stack().head(<span class="number">20</span>)</span><br><span class="line">unit_result.head()</span><br></pre></td></tr></table></figure>
<pre><code>0  Unnamed: 0                           0
   PassengerId                          1
   Survived                             0
   Pclass                               3
   Name           Braund, Mr. Owen Harris
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥ä»£ç </span></span><br><span class="line"></span><br><span class="line">unit_result.to_csv(<span class="string">&#x27;unit_result.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E8%AF%BE%E7%A8%8B%20(copy)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E8%AF%BE%E7%A8%8B%20(copy)/" class="post-title-link" itemprop="url">æ•°æ®åˆ†æâ€”â€”ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-06-12 18:45:25" itemprop="dateModified" datetime="2025-06-12T18:45:25+08:00">2025-06-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/" itemprop="url" rel="index"><span itemprop="name">kaggle</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/kaggle/titanic/" itemprop="url" rel="index"><span itemprop="name">titanic</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>å¤ä¹ ï¼š</strong>å›é¡¾å­¦ä¹ å®Œç¬¬ä¸€ç« ï¼Œæˆ‘ä»¬å¯¹æ³°å¦å°¼å…‹å·æ•°æ®æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œä¹Ÿå­¦åˆ°äº†ä¸€äº›åŸºæœ¬çš„ç»Ÿè®¡æ–¹æ³•ï¼Œç¬¬äºŒç« ä¸­æˆ‘ä»¬å­¦ä¹ äº†æ•°æ®çš„æ¸…ç†å’Œé‡æ„ï¼Œä½¿å¾—æ•°æ®æ›´åŠ çš„æ˜“äºç†è§£ï¼›ä»Šå¤©æˆ‘ä»¬è¦å­¦ä¹ çš„æ˜¯ç¬¬äºŒç« ç¬¬ä¸‰èŠ‚ï¼š<strong>æ•°æ®å¯è§†åŒ–</strong>ï¼Œä¸»è¦ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹Pythonæ•°æ®å¯è§†åŒ–åº“Matplotlibï¼Œåœ¨æœ¬ç« å­¦ä¹ ä¸­ï¼Œä½ ä¹Ÿè®¸ä¼šè§‰å¾—æ•°æ®å¾ˆæœ‰è¶£ã€‚åœ¨æ‰“æ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®å¯è§†åŒ–å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½çš„çœ‹åˆ°æ¯ä¸€ä¸ªå…³é”®æ­¥éª¤çš„ç»“æœå¦‚ä½•ï¼Œå¯ä»¥ç”¨æ¥ä¼˜åŒ–æ–¹æ¡ˆï¼Œæ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æŠ€å·§ã€‚</p>
<h1 id="2-ç¬¬äºŒç« ï¼šæ•°æ®å¯è§†åŒ–"><a href="#2-ç¬¬äºŒç« ï¼šæ•°æ®å¯è§†åŒ–" class="headerlink" title="2 ç¬¬äºŒç« ï¼šæ•°æ®å¯è§†åŒ–"></a>2 ç¬¬äºŒç« ï¼šæ•°æ®å¯è§†åŒ–</h1><h4 id="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasä»¥åŠmatplotlibåŒ…å’Œæ•°æ®"><a href="#å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasä»¥åŠmatplotlibåŒ…å’Œæ•°æ®" class="headerlink" title="å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasä»¥åŠmatplotlibåŒ…å’Œæ•°æ®"></a>å¼€å§‹ä¹‹å‰ï¼Œå¯¼å…¥numpyã€pandasä»¥åŠmatplotlibåŒ…å’Œæ•°æ®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½æ‰€éœ€çš„åº“</span></span><br><span class="line"><span class="comment"># å¦‚æœå‡ºç° ModuleNotFoundError: No module named &#x27;xxxx&#x27;</span></span><br><span class="line"><span class="comment"># ä½ åªéœ€è¦åœ¨ç»ˆç«¯/cmdä¸‹ pip install xxxx å³å¯</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åŠ è½½result.csvè¿™ä¸ªæ•°æ®</span></span><br><span class="line">text = pd.read_csv(<span class="string">r&#x27;result.csv&#x27;</span>)</span><br><span class="line">text.head()</span><br></pre></td></tr></table></figure>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>


<h3 id="2-7-å¦‚ä½•è®©äººä¸€çœ¼çœ‹æ‡‚ä½ çš„æ•°æ®ï¼Ÿ"><a href="#2-7-å¦‚ä½•è®©äººä¸€çœ¼çœ‹æ‡‚ä½ çš„æ•°æ®ï¼Ÿ" class="headerlink" title="2.7 å¦‚ä½•è®©äººä¸€çœ¼çœ‹æ‡‚ä½ çš„æ•°æ®ï¼Ÿ"></a>2.7 å¦‚ä½•è®©äººä¸€çœ¼çœ‹æ‡‚ä½ çš„æ•°æ®ï¼Ÿ</h3><p>ã€ŠPython for Data Analysisã€‹ç¬¬ä¹ç« </p>
<h4 id="2-7-1-ä»»åŠ¡ä¸€ï¼šè·Ÿç€ä¹¦æœ¬ç¬¬ä¹ç« ï¼Œäº†è§£matplotlibï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªæ•°æ®é¡¹ï¼Œå¯¹å…¶è¿›è¡ŒåŸºæœ¬å¯è§†åŒ–"><a href="#2-7-1-ä»»åŠ¡ä¸€ï¼šè·Ÿç€ä¹¦æœ¬ç¬¬ä¹ç« ï¼Œäº†è§£matplotlibï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªæ•°æ®é¡¹ï¼Œå¯¹å…¶è¿›è¡ŒåŸºæœ¬å¯è§†åŒ–" class="headerlink" title="2.7.1 ä»»åŠ¡ä¸€ï¼šè·Ÿç€ä¹¦æœ¬ç¬¬ä¹ç« ï¼Œäº†è§£matplotlibï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªæ•°æ®é¡¹ï¼Œå¯¹å…¶è¿›è¡ŒåŸºæœ¬å¯è§†åŒ–"></a>2.7.1 ä»»åŠ¡ä¸€ï¼šè·Ÿç€ä¹¦æœ¬ç¬¬ä¹ç« ï¼Œäº†è§£matplotlibï¼Œè‡ªå·±åˆ›å»ºä¸€ä¸ªæ•°æ®é¡¹ï¼Œå¯¹å…¶è¿›è¡ŒåŸºæœ¬å¯è§†åŒ–</h4><p>ã€æ€è€ƒã€‘æœ€åŸºæœ¬çš„å¯è§†åŒ–å›¾æ¡ˆæœ‰å“ªäº›ï¼Ÿåˆ†åˆ«é€‚ç”¨äºé‚£äº›åœºæ™¯ï¼Ÿï¼ˆæ¯”å¦‚æŠ˜çº¿å›¾é€‚åˆå¯è§†åŒ–æŸä¸ªå±æ€§å€¼éšæ—¶é—´å˜åŒ–çš„èµ°åŠ¿ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒå›ç­”</span></span><br><span class="line"><span class="comment">#è¿™ä¸€éƒ¨åˆ†éœ€è¦äº†è§£å¯è§†åŒ–å›¾æ¡ˆçš„çš„é€»è¾‘ï¼ŒçŸ¥é“ä»€ä¹ˆæ ·çš„å›¾æ¡ˆå¯ä»¥è¡¨è¾¾ä»€ä¹ˆæ ·çš„ä¿¡å·b</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="2-7-2-ä»»åŠ¡äºŒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººæ•°åˆ†å¸ƒæƒ…å†µï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚"><a href="#2-7-2-ä»»åŠ¡äºŒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººæ•°åˆ†å¸ƒæƒ…å†µï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚" class="headerlink" title="2.7.2 ä»»åŠ¡äºŒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººæ•°åˆ†å¸ƒæƒ…å†µï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚"></a>2.7.2 ä»»åŠ¡äºŒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººæ•°åˆ†å¸ƒæƒ…å†µï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»£ç ç¼–å†™</span></span><br><span class="line">sex = text.groupby(<span class="string">&#x27;Sex&#x27;</span>)[<span class="string">&#x27;Survived&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">sex.plot.bar()</span><br><span class="line">plt.title(<span class="string">&#x27;survived_count&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>  <img src="./../../../../images/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹ (copy" alt="ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_10_0">/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_10_0.png)</p>
<p>ã€æ€è€ƒã€‘è®¡ç®—å‡ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­æ­»äº¡äººæ•°ï¼Œå¹¶å¯è§†åŒ–å±•ç¤ºï¼Ÿå¦‚ä½•å’Œç”·å¥³ç”Ÿå­˜äººæ•°å¯è§†åŒ–æŸ±çŠ¶å›¾ç»“åˆåˆ°ä¸€èµ·ï¼Ÿçœ‹åˆ°ä½ çš„æ•°æ®å¯è§†åŒ–ï¼Œè¯´è¯´ä½ çš„ç¬¬ä¸€æ„Ÿå—ï¼ˆæ¯”å¦‚ï¼šä½ ä¸€çœ¼çœ‹å‡ºç”·ç”Ÿå­˜æ´»äººæ•°æ›´å¤šï¼Œé‚£ä¹ˆæ€§åˆ«å¯èƒ½ä¼šå½±å“å­˜æ´»ç‡ï¼‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒé¢˜å›ç­”</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="2-7-3-ä»»åŠ¡ä¸‰ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººä¸æ­»äº¡äººæ•°çš„æ¯”ä¾‹å›¾ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚"><a href="#2-7-3-ä»»åŠ¡ä¸‰ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººä¸æ­»äº¡äººæ•°çš„æ¯”ä¾‹å›¾ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚" class="headerlink" title="2.7.3 ä»»åŠ¡ä¸‰ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººä¸æ­»äº¡äººæ•°çš„æ¯”ä¾‹å›¾ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚"></a>2.7.3 ä»»åŠ¡ä¸‰ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ç”·å¥³ä¸­ç”Ÿå­˜äººä¸æ­»äº¡äººæ•°çš„æ¯”ä¾‹å›¾ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰ã€‚</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»£ç ç¼–å†™</span></span><br><span class="line"><span class="comment"># æç¤ºï¼šè®¡ç®—ç”·å¥³ä¸­æ­»äº¡äººæ•° 1è¡¨ç¤ºç”Ÿå­˜ï¼Œ0è¡¨ç¤ºæ­»äº¡</span></span><br><span class="line">text.groupby([<span class="string">&#x27;Sex&#x27;</span>,<span class="string">&#x27;Survived&#x27;</span>])[<span class="string">&#x27;Survived&#x27;</span>].count().unstack().plot(kind=<span class="string">&#x27;bar&#x27;</span>,stacked=<span class="string">&#x27;True&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;survived_count&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;count&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Text(0, 0.5, &#39;count&#39;)
</code></pre><p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E8%AF%BE%E7%A8%8B%20(copy)/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_14_1.png" alt="ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_14_1"></p>
<p>ã€æç¤ºã€‘ç”·å¥³è¿™ä¸¤ä¸ªæ•°æ®è½´ï¼Œå­˜æ´»å’Œæ­»äº¡äººæ•°æŒ‰æ¯”ä¾‹ç”¨æŸ±çŠ¶å›¾è¡¨ç¤º</p>
<h4 id="2-7-4-ä»»åŠ¡å››ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒç¥¨ä»·çš„äººç”Ÿå­˜å’Œæ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰ï¼ˆæ¨ªè½´æ˜¯ä¸åŒç¥¨ä»·ï¼Œçºµè½´æ˜¯å­˜æ´»äººæ•°ï¼‰"><a href="#2-7-4-ä»»åŠ¡å››ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒç¥¨ä»·çš„äººç”Ÿå­˜å’Œæ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰ï¼ˆæ¨ªè½´æ˜¯ä¸åŒç¥¨ä»·ï¼Œçºµè½´æ˜¯å­˜æ´»äººæ•°ï¼‰" class="headerlink" title="2.7.4 ä»»åŠ¡å››ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒç¥¨ä»·çš„äººç”Ÿå­˜å’Œæ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰ï¼ˆæ¨ªè½´æ˜¯ä¸åŒç¥¨ä»·ï¼Œçºµè½´æ˜¯å­˜æ´»äººæ•°ï¼‰"></a>2.7.4 ä»»åŠ¡å››ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒç¥¨ä»·çš„äººç”Ÿå­˜å’Œæ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰ï¼ˆæ¨ªè½´æ˜¯ä¸åŒç¥¨ä»·ï¼Œçºµè½´æ˜¯å­˜æ´»äººæ•°ï¼‰</h4><p>ã€æç¤ºã€‘å¯¹äºè¿™ç§ç»Ÿè®¡æ€§è´¨çš„ä¸”ç”¨æŠ˜çº¿è¡¨ç¤ºçš„æ•°æ®ï¼Œä½ å¯ä»¥è€ƒè™‘å°†æ•°æ®æ’åºæˆ–è€…ä¸æ’åºæ¥åˆ†åˆ«è¡¨ç¤ºã€‚çœ‹çœ‹ä½ èƒ½å‘ç°ä»€ä¹ˆï¼Ÿ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»£ç ç¼–å†™</span></span><br><span class="line"><span class="comment"># è®¡ç®—ä¸åŒç¥¨ä»·ä¸­ç”Ÿå­˜ä¸æ­»äº¡äººæ•° 1è¡¨ç¤ºç”Ÿå­˜ï¼Œ0è¡¨ç¤ºæ­»äº¡</span></span><br><span class="line"><span class="comment">#print(text.groupby([&#x27;Fare&#x27;])[&#x27;Survived&#x27;].value_counts())</span></span><br><span class="line">fare_sur = text.groupby([<span class="string">&#x27;Fare&#x27;</span>])[<span class="string">&#x27;Survived&#x27;</span>].value_counts().sort_values(ascending=<span class="literal">False</span>)</span><br><span class="line">fare_sur</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>Fare     Survived
8.0500   0           38
7.8958   0           37
13.0000  0           26
7.7500   0           22
26.0000  0           16
                     ..
6.9500   0            1
6.9750   0            1
         1            1
7.0458   0            1
7.1417   1            1
Name: count, Length: 330, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ’åºåç»˜æŠ˜çº¿å›¾</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">18</span>))</span><br><span class="line">fare_sur.plot(grid=<span class="literal">True</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>   <img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E8%AF%BE%E7%A8%8B%20(copy)/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_19_0.png" alt="ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_19_0"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥ä»£ç </span></span><br><span class="line"><span class="comment"># æ’åºå‰ç»˜æŠ˜çº¿å›¾</span></span><br><span class="line">fare_sur1 = text.groupby([<span class="string">&#x27;Fare&#x27;</span>])[<span class="string">&#x27;Survived&#x27;</span>].value_counts()</span><br><span class="line">fare_sur1</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">20</span>, <span class="number">18</span>))</span><br><span class="line">fare_sur1.plot(grid=<span class="literal">True</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p> <img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E8%AF%BE%E7%A8%8B%20(copy)/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_20_0.png" alt="ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_20_0"></p>
<h4 id="2-7-5-ä»»åŠ¡äº”ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººç”Ÿå­˜å’Œæ­»äº¡äººå‘˜çš„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰"><a href="#2-7-5-ä»»åŠ¡äº”ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººç”Ÿå­˜å’Œæ­»äº¡äººå‘˜çš„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰" class="headerlink" title="2.7.5 ä»»åŠ¡äº”ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººç”Ÿå­˜å’Œæ­»äº¡äººå‘˜çš„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰"></a>2.7.5 ä»»åŠ¡äº”ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººç”Ÿå­˜å’Œæ­»äº¡äººå‘˜çš„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŸ±çŠ¶å›¾è¯•è¯•ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»£ç ç¼–å†™</span></span><br><span class="line"><span class="comment"># 1è¡¨ç¤ºç”Ÿå­˜ï¼Œ0è¡¨ç¤ºæ­»äº¡</span></span><br><span class="line">pclass_sur = text.groupby([<span class="string">&#x27;Pclass&#x27;</span>])[<span class="string">&#x27;Survived&#x27;</span>].value_counts()</span><br><span class="line">pclass_sur</span><br></pre></td></tr></table></figure>
<pre><code>Pclass  Survived
1       1           136
        0            80
2       0            97
        1            87
3       0           372
        1           119
Name: count, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line">sns.countplot(x=<span class="string">&quot;Pclass&quot;</span>, hue=<span class="string">&quot;Survived&quot;</span>, data=text)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;Axes: xlabel=&#39;Pclass&#39;, ylabel=&#39;count&#39;&gt;
</code></pre><p><img src="./../../../../images/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹ (copy" alt="ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_23_1">/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_23_1.png)</p>
<p>ã€æ€è€ƒã€‘çœ‹åˆ°è¿™ä¸ªå‰é¢å‡ ä¸ªæ•°æ®å¯è§†åŒ–ï¼Œè¯´è¯´ä½ çš„ç¬¬ä¸€æ„Ÿå—å’Œä½ çš„æ€»ç»“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ€è€ƒé¢˜å›ç­”</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="2-7-6-ä»»åŠ¡å…­ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒå¹´é¾„çš„äººç”Ÿå­˜ä¸æ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚-ä¸é™è¡¨è¾¾æ–¹å¼"><a href="#2-7-6-ä»»åŠ¡å…­ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒå¹´é¾„çš„äººç”Ÿå­˜ä¸æ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚-ä¸é™è¡¨è¾¾æ–¹å¼" class="headerlink" title="2.7.6 ä»»åŠ¡å…­ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒå¹´é¾„çš„äººç”Ÿå­˜ä¸æ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚(ä¸é™è¡¨è¾¾æ–¹å¼)"></a>2.7.6 ä»»åŠ¡å…­ï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒå¹´é¾„çš„äººç”Ÿå­˜ä¸æ­»äº¡äººæ•°åˆ†å¸ƒæƒ…å†µã€‚(ä¸é™è¡¨è¾¾æ–¹å¼)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»£ç ç¼–å†™</span></span><br><span class="line">facet = sns.FacetGrid(text, hue=<span class="string">&quot;Survived&quot;</span>,aspect=<span class="number">3</span>)</span><br><span class="line">facet.<span class="built_in">map</span>(sns.kdeplot,<span class="string">&#x27;Age&#x27;</span>,shade= <span class="literal">True</span>)</span><br><span class="line">facet.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, text[<span class="string">&#x27;Age&#x27;</span>].<span class="built_in">max</span>()))</span><br><span class="line">facet.add_legend()</span><br></pre></td></tr></table></figure>
<pre><code>/root/.pyenv/versions/3.11.1/lib/python3.11/site-packages/seaborn/axisgrid.py:854: FutureWarning: 

`shade` is now deprecated in favor of `fill`; setting `fill=True`.
This will become an error in seaborn v0.14.0; please update your code.

  func(*plot_args, **plot_kwargs)
/root/.pyenv/versions/3.11.1/lib/python3.11/site-packages/seaborn/axisgrid.py:854: FutureWarning: 

`shade` is now deprecated in favor of `fill`; setting `fill=True`.
This will become an error in seaborn v0.14.0; please update your code.

  func(*plot_args, **plot_kwargs)

&lt;seaborn.axisgrid.FacetGrid at 0x7f9c6bce1f50&gt;
</code></pre><p><img src="./../../../../images/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹ (copy" alt="ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_27_2">/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_27_2.png)</p>
<h4 id="2-7-7-ä»»åŠ¡ä¸ƒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººå¹´é¾„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰"><a href="#2-7-7-ä»»åŠ¡ä¸ƒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººå¹´é¾„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰" class="headerlink" title="2.7.7 ä»»åŠ¡ä¸ƒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººå¹´é¾„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰"></a>2.7.7 ä»»åŠ¡ä¸ƒï¼šå¯è§†åŒ–å±•ç¤ºæ³°å¦å°¼å…‹å·æ•°æ®é›†ä¸­ä¸åŒä»“ä½ç­‰çº§çš„äººå¹´é¾„åˆ†å¸ƒæƒ…å†µã€‚ï¼ˆç”¨æŠ˜çº¿å›¾è¯•è¯•ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»£ç ç¼–å†™</span></span><br><span class="line"></span><br><span class="line">text.Age[text.Pclass == <span class="number">1</span>].plot(kind=<span class="string">&#x27;kde&#x27;</span>)</span><br><span class="line">text.Age[text.Pclass == <span class="number">2</span>].plot(kind=<span class="string">&#x27;kde&#x27;</span>)</span><br><span class="line">text.Age[text.Pclass == <span class="number">3</span>].plot(kind=<span class="string">&#x27;kde&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">plt.legend((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),loc=<span class="string">&quot;best&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.legend.Legend at 0x7f9c69946e90&gt;
</code></pre><p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/kaggle/titanic/%E7%AC%AC%E4%BA%8C%E7%AB%A0%EF%BC%9A%E7%AC%AC%E5%9B%9B%E8%8A%82%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-%E8%AF%BE%E7%A8%8B%20(copy)/ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_29_1.png" alt="ç¬¬äºŒç« ï¼šç¬¬å››èŠ‚æ•°æ®å¯è§†åŒ–-è¯¾ç¨‹_29_1"></p>
<p>ã€æ€è€ƒã€‘ä¸Šé¢æ‰€æœ‰å¯è§†åŒ–çš„ä¾‹å­åšä¸€ä¸ªæ€»ä½“çš„åˆ†æï¼Œä½ çœ‹çœ‹ä½ èƒ½ä¸èƒ½æœ‰è‡ªå·±å‘ç°</p>
<p>ã€æ€»ç»“ã€‘åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„å¯è§†åŒ–å°±å‘Šä¸€æ®µè½å•¦ï¼Œå¦‚æœä½ å¯¹æ•°æ®å¯è§†åŒ–æå…¶æ„Ÿå…´è¶£ï¼Œä½ è¿˜å¯ä»¥äº†è§£ä¸€ä¸‹å…¶ä»–å¯è§†åŒ–æ¨¡å—ï¼Œå¦‚ï¼špyechartsï¼Œbokehç­‰ã€‚</p>
<p>å¦‚æœä½ åœ¨å·¥ä½œä¸­ä½¿ç”¨æ•°æ®å¯è§†åŒ–ï¼Œä½ å¿…é¡»çŸ¥é“æ•°æ®å¯è§†åŒ–æœ€å¤§çš„ä½œç”¨ä¸æ˜¯ç‚«é…·ï¼Œè€Œæ˜¯æœ€å¿«æœ€ç›´è§‚çš„ç†è§£æ•°æ®è¦è¡¨è¾¾ä»€ä¹ˆï¼Œä½ è§‰å¾—å‘¢ï¼Ÿ</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/" class="post-title-link" itemprop="url">python webâ€”â€”fastapi</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-14 00:00:00" itemprop="dateCreated datePublished" datetime="2025-05-14T00:00:00+08:00">2025-05-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-07-14 09:12:41" itemprop="dateModified" datetime="2025-07-14T09:12:41+08:00">2025-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python-web/" itemprop="url" rel="index"><span itemprop="name">python-web</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python-web/fastapi/" itemprop="url" rel="index"><span itemprop="name">fastapi</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>FastAPI æ˜¯ä¸€ä¸ªç”¨äºæ„å»º API çš„ç°ä»£ã€å¿«é€Ÿï¼ˆé«˜æ€§èƒ½ï¼‰çš„ web æ¡†æ¶ï¼Œä½¿ç”¨ Python å¹¶åŸºäºæ ‡å‡†çš„ Python ç±»å‹æç¤ºã€‚</p>
<p>å…³é”®ç‰¹æ€§:</p>
<ul>
<li><strong>å¿«é€Ÿ</strong>ï¼šå¯ä¸ <strong>NodeJS</strong> å’Œ <strong>Go</strong> å¹¶è‚©çš„æé«˜æ€§èƒ½ï¼ˆå½’åŠŸäº Starlette å’Œ Pydanticï¼‰ã€‚<a target="_blank" rel="noopener" href="https://fastapi.tiangolo.com/zh/#_11">æœ€å¿«çš„ Python web æ¡†æ¶ä¹‹ä¸€</a>ã€‚</li>
<li><strong>é«˜æ•ˆç¼–ç </strong>ï¼šæé«˜åŠŸèƒ½å¼€å‘é€Ÿåº¦çº¦ 200ï¼… è‡³ 300ï¼…ã€‚*</li>
<li><strong>æ›´å°‘ bug</strong>ï¼šå‡å°‘çº¦ 40ï¼… çš„äººä¸ºï¼ˆå¼€å‘è€…ï¼‰å¯¼è‡´é”™è¯¯ã€‚*</li>
<li><strong>æ™ºèƒ½</strong>ï¼šæä½³çš„ç¼–è¾‘å™¨æ”¯æŒã€‚å¤„å¤„çš†å¯è‡ªåŠ¨è¡¥å…¨ï¼Œå‡å°‘è°ƒè¯•æ—¶é—´ã€‚</li>
<li><strong>ç®€å•</strong>ï¼šè®¾è®¡çš„æ˜“äºä½¿ç”¨å’Œå­¦ä¹ ï¼Œé˜…è¯»æ–‡æ¡£çš„æ—¶é—´æ›´çŸ­ã€‚</li>
<li><strong>ç®€çŸ­</strong>ï¼šä½¿ä»£ç é‡å¤æœ€å°åŒ–ã€‚é€šè¿‡ä¸åŒçš„å‚æ•°å£°æ˜å®ç°ä¸°å¯ŒåŠŸèƒ½ã€‚bug æ›´å°‘ã€‚</li>
<li><strong>å¥å£®</strong>ï¼šç”Ÿäº§å¯ç”¨çº§åˆ«çš„ä»£ç ã€‚è¿˜æœ‰è‡ªåŠ¨ç”Ÿæˆçš„äº¤äº’å¼æ–‡æ¡£ã€‚</li>
<li><strong>æ ‡å‡†åŒ–</strong>ï¼šåŸºäºï¼ˆå¹¶å®Œå…¨å…¼å®¹ï¼‰API çš„ç›¸å…³å¼€æ”¾æ ‡å‡†ï¼š<a target="_blank" rel="noopener" href="https://github.com/OAI/OpenAPI-Specification">OpenAPI</a> (ä»¥å‰è¢«ç§°ä¸º Swagger) å’Œ <a target="_blank" rel="noopener" href="https://json-schema.org/">JSON Schema</a>ã€‚</li>
</ul>
<h3 id="ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šStarlette-å’Œ-Pydantic"><a href="#ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šStarlette-å’Œ-Pydantic" class="headerlink" title="ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šStarlette å’Œ Pydantic"></a>ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šStarlette å’Œ Pydantic</h3><p>Starlette è´Ÿè´£webéƒ¨åˆ†</p>
<p>Starlette æ˜¯ FastAPI çš„åº•å±‚ ASGIï¼ˆå¼‚æ­¥æœåŠ¡å™¨ç½‘å…³æ¥å£ï¼‰æ¡†æ¶ï¼Œä¸º FastAPI æä¾›äº†å¼‚æ­¥ç¼–ç¨‹èƒ½åŠ›å’Œé«˜æ€§èƒ½çš„ç½‘ç»œé€šä¿¡æ”¯æŒã€‚</p>
<p>ASGIï¼ˆ<strong>Asynchronous Server Gateway Interface</strong> ï¼‰æ˜¯ä¸€ç§ç”¨äºè¿æ¥ Python Web æœåŠ¡å™¨å’Œåº”ç”¨ç¨‹åºæ¡†æ¶çš„<strong>å¼‚æ­¥æ¥å£æ ‡å‡†</strong> ï¼Œæ—¨åœ¨æ”¯æŒç°ä»£ Web åè®®ï¼ˆå¦‚ WebSocketã€HTTP/2ï¼‰å’Œå¼‚æ­¥ç¼–ç¨‹æ¨¡å‹</p>
<p>Pydanticè´Ÿè´£</p>
<p>Pydantic è´Ÿè´£ FastAPI çš„æ•°æ®éªŒè¯ã€åºåˆ—åŒ–å’Œè‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ</p>
<h3 id="httpåè®®"><a href="#httpåè®®" class="headerlink" title="httpåè®®"></a>httpåè®®</h3><h4 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h4><p><strong>HTTPåè®®</strong> æ˜¯Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™ï¼Œæ˜¯ç”¨äºä¸‡ç»´ç½‘ï¼ˆWWW: World Wide Webï¼‰æœåŠ¡å™¨ä¸æœ¬åœ°æµè§ˆå™¨ä¹‹é—´ä¼ è¾“è¶…æ–‡æœ¬çš„ä¼ é€åè®®ã€‚HTTPæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚å®ƒäº1990å¹´æå‡ºï¼Œç»è¿‡å‡ å¹´çš„ä½¿ç”¨ä¸å‘å±•ï¼Œå¾—åˆ°ä¸æ–­åœ°å®Œå–„å’Œæ‰©å±•ã€‚HTTPåè®®å·¥ä½œäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯æ¶æ„ä¸ºä¸Šã€‚æµè§ˆå™¨ä½œä¸ºHTTPå®¢æˆ·ç«¯é€šè¿‡URLå‘HTTPæœåŠ¡ç«¯å³WEBæœåŠ¡å™¨å‘é€æ‰€æœ‰è¯·æ±‚ã€‚WebæœåŠ¡å™¨æ ¹æ®æ¥æ”¶åˆ°çš„è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯å‘é€å“åº”ä¿¡æ¯ã€‚</p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/1.png" alt="1"></p>
<h4 id="äºŒã€httpåè®®ç‰¹æ€§"><a href="#äºŒã€httpåè®®ç‰¹æ€§" class="headerlink" title="äºŒã€httpåè®®ç‰¹æ€§"></a>äºŒã€httpåè®®ç‰¹æ€§</h4><p>ï¼ˆ1ï¼‰åŸºäº TCP/IP åè®®</p>
<p>http åè®®æ˜¯åŸºäº <strong>TCP/IP åè®®</strong>ä¹‹ä¸Šçš„åº”ç”¨å±‚åè®®ã€‚</p>
<p>ï¼ˆ2ï¼‰åŸºäºè¯·æ±‚ - å“åº”æ¨¡å¼</p>
<p>HTTP åè®®è§„å®šï¼Œè¯·æ±‚ä»å®¢æˆ·ç«¯å‘å‡ºï¼Œæœ€åæœåŠ¡å™¨ç«¯å“åº”åº”è¯¥è¯·æ±‚å¹¶è¿”å›ã€‚æ¢å¥è¯è¯´ï¼Œè‚¯å®šæ˜¯å…ˆ<strong>ä»å®¢æˆ·ç«¯å¼€å§‹å»ºç«‹é€šä¿¡çš„ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ²¡æœ‰æ¥æ”¶åˆ°è¯·æ±‚ä¹‹å‰ä¸ä¼šå‘é€å“åº”</strong>ã€‚</p>
<p>ï¼ˆ3ï¼‰æ— çŠ¶æ€ä¿å­˜</p>
<p>HTTP æ˜¯ä¸€ç§ä¸ä¿å­˜çŠ¶æ€ï¼Œå³æ— çŠ¶æ€ï¼ˆstatelessï¼‰åè®®ã€‚HTTP åè®®è‡ªèº«ä¸å¯¹è¯·æ±‚å’Œå“åº”ä¹‹é—´çš„é€šä¿¡çŠ¶æ€è¿›è¡Œä¿å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ HTTP è¿™ä¸ªçº§åˆ«ï¼Œåè®®å¯¹äºå‘é€è¿‡çš„è¯·æ±‚æˆ–å“åº”éƒ½ä¸åšæŒä¹…åŒ–å¤„ç†ã€‚</p>
<p>ä½¿ç”¨ HTTP åè®®ï¼Œæ¯å½“æœ‰æ–°çš„è¯·æ±‚å‘é€æ—¶ï¼Œå°±ä¼šæœ‰å¯¹åº”çš„æ–°å“åº”äº§ç”Ÿã€‚åè®®æœ¬èº«å¹¶<strong>ä¸ä¿ç•™ä¹‹å‰ä¸€åˆ‡çš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡çš„ä¿¡æ¯</strong>ã€‚è¿™æ˜¯ä¸ºäº†æ›´å¿«åœ°å¤„ç†å¤§é‡äº‹åŠ¡ï¼Œç¡®ä¿åè®®çš„å¯ä¼¸ç¼©æ€§ï¼Œè€Œç‰¹æ„æŠŠ HTTP åè®®è®¾è®¡æˆå¦‚æ­¤ç®€å•çš„ã€‚</p>
<p>ï¼ˆ4ï¼‰çŸ­è¿æ¥</p>
<p>HTTP 1.0 é»˜è®¤ä½¿ç”¨çš„æ˜¯çŸ­è¿æ¥ã€‚æµè§ˆå™¨å’ŒæœåŠ¡å™¨æ¯è¿›è¡Œä¸€æ¬¡ HTTP æ“ä½œï¼Œå°±å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œä»»åŠ¡ç»“æŸå°±ä¸­æ–­è¿æ¥ã€‚ </p>
<p>HTTP 1.1 èµ·ï¼Œé»˜è®¤ä½¿ç”¨é•¿è¿æ¥ã€‚è¦ä½¿ç”¨é•¿è¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„ HTTP é¦–éƒ¨çš„ Connection éƒ½è¦è®¾ç½®ä¸º keep - aliveï¼Œæ‰èƒ½æ”¯æŒé•¿è¿æ¥ã€‚ </p>
<p>HTTP é•¿è¿æ¥ï¼ŒæŒ‡çš„æ˜¯å¤ç”¨ TCP è¿æ¥ã€‚å¤šä¸ª HTTP è¯·æ±‚å¯ä»¥å¤ç”¨åŒä¸€ä¸ª TCP è¿æ¥ï¼Œè¿™å°±èŠ‚çœäº† TCP è¿æ¥å»ºç«‹å’Œæ–­å¼€çš„æ¶ˆè€—ã€‚</p>
<h4 id="ä¸‰ã€httpè¯·æ±‚åè®®ä¸å“åº”åè®®"><a href="#ä¸‰ã€httpè¯·æ±‚åè®®ä¸å“åº”åè®®" class="headerlink" title="ä¸‰ã€httpè¯·æ±‚åè®®ä¸å“åº”åè®®"></a>ä¸‰ã€httpè¯·æ±‚åè®®ä¸å“åº”åè®®</h4><p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/2.png" alt="2"></p>
<blockquote>
<p>Socketï¼ˆå¥—æ¥å­—ï¼‰æ˜¯è®¡ç®—æœºç½‘ç»œä¸­ç”¨äºå®ç°è¿›ç¨‹é—´åŒå‘é€šä¿¡çš„ç«¯ç‚¹æŠ½è±¡ï¼Œå®ƒä¸ºåº”ç”¨å±‚è¿›ç¨‹é€šè¿‡ç½‘ç»œåè®®äº¤æ¢æ•°æ®æä¾›äº†ç»Ÿä¸€çš„æ¥å£ã€‚å…·ä½“æ¥è¯´ï¼ŒSocket æ˜¯åº”ç”¨å±‚ä¸ TCP/IP åè®®æ—é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç»„å°è£…äº†å¤æ‚ç½‘ç»œåè®®çš„æ¥å£ï¼Œç®€åŒ–äº†å¼€å‘è€…å¯¹åº•å±‚é€šä¿¡ç»†èŠ‚çš„æ“ä½œã€‚</p>
<p>ä»åŠŸèƒ½ä¸Šçœ‹ï¼ŒSocket å¯ä»¥çœ‹ä½œæ˜¯ç½‘ç»œé€šä¿¡çš„â€œç”µè¯æ’åº§â€ï¼šä¸¤ä¸ªè®¾å¤‡ï¼ˆå¦‚å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ï¼‰é€šè¿‡ Socket å»ºç«‹è¿æ¥åï¼Œå³å¯åƒç”µè¯é€šè¯ä¸€æ ·è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œè€Œç«¯å£å·åˆ™ç±»ä¼¼äºæ’åº§ä¸Šçš„æ’å­”ï¼Œç”¨äºæ ‡è¯†å…·ä½“çš„é€šä¿¡è¿›ç¨‹ï¼Œä¸”ä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹å ç”¨ã€‚æ­¤å¤–ï¼ŒSocket åŒ…å«ç½‘ç»œé€šä¿¡å¿…éœ€çš„äº”ç§æ ¸å¿ƒä¿¡æ¯ï¼Œä¾‹å¦‚ä½¿ç”¨çš„åè®®ï¼ˆTCP/UDPï¼‰ã€æœ¬åœ°ä¸è¿œç¨‹åœ°å€ã€ç«¯å£ç­‰ï¼Œæ„æˆäº†ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒã€‚</p>
<p>æ€»ç»“è€Œè¨€ï¼ŒSocket æ—¢æ˜¯é€šä¿¡ç«¯ç‚¹çš„é€»è¾‘æ¦‚å¿µï¼Œä¹Ÿæ˜¯å®ç°ç½‘ç»œåº”ç”¨å±‚äº¤äº’çš„å…³é”®å·¥å…·ï¼Œå…¶è®¾è®¡ç›®æ ‡æ˜¯å±è”½åº•å±‚åè®®çš„å¤æ‚æ€§ï¼Œæä¾›ç»Ÿä¸€çš„ç¼–ç¨‹æ¥å£ã€‚</p>
</blockquote>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/3.png" alt="3"></p>
<blockquote>
<p>GET ï¼šè¯·æ±‚å‚æ•°é€šè¿‡ URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆQuery Stringï¼‰ä¼ é€’ï¼Œæ•°æ®æš´éœ²åœ¨åœ°å€æ ä¸­ï¼Œä¾‹å¦‚ï¼š<a href="https://example.com">https://example.com</a> ?name=value</p>
<p>POST ï¼šè¯·æ±‚å‚æ•°å­˜å‚¨åœ¨è¯·æ±‚ä½“ï¼ˆBodyï¼‰ä¸­ä¼ è¾“ï¼Œç›¸å¯¹æ›´å®‰å…¨ï¼Œä¸”æ”¯æŒä¼ è¾“éå­—ç¬¦ä¸²æ•°æ®ï¼ˆå¦‚æ–‡ä»¶ã€äºŒè¿›åˆ¶ç­‰ï¼‰</p>
<p>ä¸€ä¸ªå®Œæ•´çš„URLåŒ…æ‹¬ï¼šåè®®ã€ipã€ç«¯å£ã€è·¯å¾„ã€å‚æ•°</p>
<p>ä¾‹å¦‚ï¼š<a target="_blank" rel="noopener" href="https://www.baidu.com/s?wd=yuan">https://www.baidu.com/s?wd=yuan</a> å…¶ä¸­httpsæ˜¯åè®®ï¼Œwww.baidu.com æ˜¯IPï¼Œç«¯å£é»˜è®¤80ï¼Œ/sæ˜¯è·¯å¾„ï¼Œå‚æ•°æ˜¯wd=yuan</p>
<p>è¯·æ±‚æ–¹å¼ï¼šgetä¸postè¯·æ±‚</p>
<ul>
<li>GETæäº¤çš„æ•°æ®ä¼šæ”¾åœ¨URLä¹‹åï¼Œä»¥?åˆ†å‰²URLå’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;ç›¸è¿ï¼Œå¦‚EditBook?name=test1&amp;id=123456ã€‚POSTæ–¹æ³•æ˜¯æŠŠæäº¤çš„æ•°æ®æ”¾åœ¨HTTPåŒ…çš„è¯·æ±‚ä½“ä¸­ã€‚</li>
<li>GETæäº¤çš„æ•°æ®å¤§å°æœ‰é™åˆ¶ï¼ˆå› ä¸ºæµè§ˆå™¨å¯¹URLçš„é•¿åº¦æœ‰é™åˆ¶ï¼‰ï¼Œè€ŒPOSTæ–¹æ³•æäº¤çš„æ•°æ®æ²¡æœ‰é™åˆ¶</li>
</ul>
<p>å“åº”çŠ¶æ€ç ï¼šçŠ¶æ€ç çš„èŒè´£æ˜¯å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œè¿”å›çš„è¯·æ±‚ç»“æœã€‚å€ŸåŠ©çŠ¶æ€ç ï¼Œç”¨æˆ·å¯ä»¥çŸ¥é“æœåŠ¡å™¨ç«¯æ˜¯æ­£å¸¸å¤„ç†äº†è¯·æ±‚ï¼Œè¿˜æ˜¯å‡ºç°äº†é—®é¢˜ã€‚çŠ¶æ€ç å¦‚200 OKï¼Œä»¥3ä½æ•°å­—å’ŒåŸå› ç»„æˆã€‚</p>
</blockquote>
<p>æµ‹è¯•httpåè®®æ ¼å¼ï¼šè¯·æ±‚ä¸å“åº”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#webåº”ç”¨ç¨‹åºï¼šéµå¾ªhttpåè®®</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">sock=socket.socket()</span><br><span class="line">sock.bind((<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">8080</span>))</span><br><span class="line">sock.listen(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    conn è¡¨ç¤ºæ–°å»ºç«‹çš„å¥—æ¥å­—å¯¹è±¡ï¼Œç”¨äºåœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</span></span><br><span class="line"><span class="string">    addr æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œå®ƒåŒ…å«äº†è¿æ¥è¿›æ¥çš„å®¢æˆ·ç«¯çš„ IP åœ°å€å’Œç«¯å£å·ã€‚</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    conn, addr = sock.accept()<span class="comment">#é˜»å¡ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">    data=conn.recv(<span class="number">1024</span>)<span class="comment">#è¯·æ±‚æŠ¥æ–‡</span></span><br><span class="line">    <span class="comment"># data æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸²ï¼ŒåŒ…å«äº†å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¿¡æ¯ã€‚</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¿¡æ¯ï¼š\n&quot;</span>,data)</span><br><span class="line">    conn.send(<span class="string">b&quot;HTTP/1.1 200 ok\r\nserver:zxj\r\n\r\nhello world&quot;</span>)<span class="comment">#å“åº”é¦–è¡Œ+å“åº”å¤´+å“åº”ä½“</span></span><br><span class="line">    conn.close()</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•postè¯·æ±‚ï¼šurlencodedæ ¼å¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º socket è¿æ¥</span></span><br><span class="line">client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">client.connect((<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€  POST è¯·æ±‚æŠ¥æ–‡</span></span><br><span class="line">path = <span class="string">&quot;/&quot;</span>  <span class="comment"># ç›®æ ‡è·¯å¾„</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,  <span class="comment"># æ•°æ®æ ¼å¼</span></span><br><span class="line">    <span class="string">&quot;Content-Length&quot;</span>: <span class="built_in">len</span>(<span class="string">&quot;username=admin&amp;password=123456&quot;</span>)  <span class="comment"># æ•°æ®é•¿åº¦</span></span><br><span class="line">&#125;</span><br><span class="line">body = <span class="string">&quot;username=admin&amp;password=123456&quot;</span>  <span class="comment"># è¯·æ±‚ä½“ï¼ˆè¡¨å•æ•°æ®ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹¼æ¥è¯·æ±‚æŠ¥æ–‡</span></span><br><span class="line">request = <span class="string">f&quot;POST <span class="subst">&#123;path&#125;</span> HTTP/1.1\r\n&quot;</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> headers.items():</span><br><span class="line">    request += <span class="string">f&quot;<span class="subst">&#123;k&#125;</span>: <span class="subst">&#123;v&#125;</span>\r\n&quot;</span></span><br><span class="line">request += <span class="string">&quot;\r\n&quot;</span>  <span class="comment"># ç©ºè¡Œåˆ†éš”å¤´éƒ¨ä¸ä¸»ä½“</span></span><br><span class="line">request += body</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€è¯·æ±‚</span></span><br><span class="line">client.send(request.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥æ”¶å“åº”</span></span><br><span class="line">response = client.recv(<span class="number">4096</span>)</span><br><span class="line"><span class="built_in">print</span>(response.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•postè¯·æ±‚ï¼šjsonæ ¼å¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰è¯·æ±‚åœ°å€</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:8080&quot;</span></span><br><span class="line"><span class="comment"># å®šä¹‰ JSON æ•°æ®ï¼ˆå­—å…¸æ ¼å¼ï¼‰</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€ POST è¯·æ±‚</span></span><br><span class="line">response = requests.post(</span><br><span class="line">    url, </span><br><span class="line">    json=data  <span class="comment"># ä½¿ç”¨ json å‚æ•°è‡ªåŠ¨åºåˆ—åŒ–å­—å…¸å¹¶è®¾ç½® Content-Type: application/json</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå“åº”ç»“æœ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;çŠ¶æ€ç :&quot;</span>, response.status_code)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å“åº”å†…å®¹:&quot;</span>, response.text)  <span class="comment"># ä½¿ç”¨ text è·å–åŸå§‹å“åº”æ–‡æœ¬</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¿¡æ¯ï¼š</span></span><br><span class="line"><span class="string"> b&#x27;POST / HTTP/1.1\r\nHost: 127.0.0.1:8080\r\nUser-Agent: python-requests/2.32.2\r\nAccept-Encoding: gzip, deflate\r\nAccept: */*\r\nConnection: keep-alive\r\nContent-Length: 43\r\nContent-Type: application/json\r\n\r\n&#123;&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;123456&quot;&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>é€šè¿‡ <code>json=data</code> å‚æ•°ï¼Œ<code>requests</code> ä¼šè‡ªåŠ¨å°†å­—å…¸è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ï¼Œå¹¶è®¾ç½®è¯·æ±‚å¤´ <code>Content-Type: application/json</code>ï¼Œæ— éœ€æ‰‹åŠ¨è°ƒç”¨ <code>json.dumps()</code> æˆ–é…ç½® headers </p>
<p>SSL éªŒè¯æ˜¯æŒ‡é€šè¿‡ SSL è¯ä¹¦éªŒè¯ç½‘ç«™èº«ä»½å¹¶ç¡®ä¿é€šä¿¡å®‰å…¨çš„è¿‡ç¨‹ã€‚å…¶æ ¸å¿ƒç›®æ ‡æ˜¯ç¡®è®¤æœåŠ¡å™¨çš„çœŸå®æ€§ã€é˜²æ­¢èº«ä»½ä¼ªé€ ï¼Œå¹¶å»ºç«‹åŠ å¯†è¿æ¥ä»¥ä¿æŠ¤æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§</p>
<p>HTTPSï¼ˆHyperText Transfer Protocol Secureï¼‰æ˜¯ä»¥å®‰å…¨ä¸ºç›®æ ‡çš„ HTTP é€šé“ï¼Œé€šè¿‡åœ¨ HTTP åŸºç¡€ä¸ŠåŠ å…¥åŠ å¯†å’Œèº«ä»½è®¤è¯æœºåˆ¶ï¼Œç¡®ä¿æ•°æ®ä¼ è¾“çš„éšç§æ€§ã€å®Œæ•´æ€§å’ŒæœåŠ¡å™¨èº«ä»½çš„çœŸå®æ€§</p>
<p>https=http+ssl</p>
<p>é€šè¿‡ <code>Content-Type</code>ï¼ŒæœåŠ¡å™¨å¯è¯†åˆ«è¯·æ±‚ä½“ï¼ˆBodyï¼‰çš„æ ¼å¼ï¼ˆå¦‚ JSONã€è¡¨å•æ•°æ®ï¼‰ï¼Œå®¢æˆ·ç«¯å¯è§£æå“åº”æ•°æ®çš„ç±»å‹ï¼ˆå¦‚ HTMLã€å›¾ç‰‡ï¼‰</p>
<p>ä¾‹å¦‚ï¼šconn.send(bâ€HTTP/1.1 200 ok\r\nserver:zxj\r\n<strong>content-type:text/html</strong>\r\n\r\n</p><h1>hello world&lt;\h1&gt;â€)<p></p>
<p>å†ä¾‹å¦‚ï¼šâ€˜HTTP/1.1 200 ok\r\nserver:zxj\r\n<strong>content-type:application/json</strong>\r\n\r\n{â€œuser_idâ€:zxj}â€™</p>
</h1></blockquote>
<h5 id="apiæ¥å£"><a href="#apiæ¥å£" class="headerlink" title="apiæ¥å£"></a>apiæ¥å£</h5><p>åœ¨å¼€å‘webåº”ç”¨ä¸­ï¼Œæœ‰ä¸¤ç§åº”ç”¨æ¨¡å¼ï¼š</p>
<p>1.å‰åç«¯ä¸åˆ†ç¦»ï¼šå®¢æˆ·ç«¯çœ‹åˆ°çš„å†…å®¹å’Œæ‰€æœ‰é¡µé¢æ•ˆæœéƒ½æ˜¯æœ‰æœåŠ¡ç«¯æä¾›å‡ºæ¥çš„</p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/4.png" alt="4"></p>
<p>2.å‰åç«¯åˆ†ç¦»ï¼šæŠŠå‰ç«¯çš„é¡µé¢æ•ˆæœï¼ˆhtmlï¼Œcssï¼Œjsåˆ†ç¦»åˆ°å¦ä¸€ä¸ªæœåŠ¡ç«¯ï¼ŒpythonæœåŠ¡ç«¯åªéœ€è¦è¿”å›æ•°æ®å³å¯ï¼‰</p>
<p>å‰ç«¯å½¢æˆä¸€ä¸ªç‹¬ç«‹çš„ç½‘ç«™ï¼ŒæœåŠ¡ç«¯æ„æˆä¸€ä¸ªç‹¬ç«‹çš„ç½‘ç«™</p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/5.png" alt="5"></p>
<p><strong>åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆApplication Programming Interfaceï¼ŒAPIæ¥å£ï¼‰</strong>ï¼Œå°±æ˜¯åº”ç”¨ç¨‹åºå¯¹å¤–æä¾›äº†ä¸€ä¸ªæ“ä½œæ•°æ®çš„å…¥å£ï¼Œè¿™ä¸ªå…¥å£å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–ç±»æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªurlåœ°å€æˆ–è€…ä¸€ä¸ªç½‘ç»œåœ°å€ã€‚å½“å®¢æˆ·ç«¯è°ƒç”¨è¿™ä¸ªå…¥å£ï¼Œåº”ç”¨ç¨‹åºåˆ™ä¼šæ‰§è¡Œå¯¹åº”ä»£ç æ“ä½œï¼Œç»™å®¢æˆ·ç«¯å®Œæˆç›¸å¯¹åº”çš„åŠŸèƒ½ã€‚</p>
<p>å½“ç„¶ï¼Œapiæ¥å£åœ¨å·¥ä½œä¸­æ˜¯æ¯”è¾ƒå¸¸è§çš„å¼€å‘å†…å®¹ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨å…¶ä»–äººç¼–å†™çš„apiæ¥å£ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æä¾›apiæ¥å£ç»™å…¶ä»–äººæ“ä½œã€‚ç”±æ­¤å°±ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œapiæ¥å£å¾€å¾€éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€ç±»æ–¹æ³•ã€æˆ–è€…urlæˆ–å…¶ä»–ç½‘ç»œåœ°å€ï¼Œä¸æ–­æ˜¯å“ªä¸€ç§ï¼Œå½“apiæ¥å£ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éƒ½è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜å°±æ˜¯è¿™ä¸ªæ¥å£åº”è¯¥æ€ä¹ˆç¼–å†™ï¼Ÿæ¥å£æ€ä¹ˆå†™çš„æ›´åŠ å®¹æ˜“ç»´æŠ¤å’Œæ¸…æ™°ï¼Œè¿™å°±éœ€è¦å¤§å®¶åœ¨è°ƒç”¨æˆ–è€…ç¼–å†™apiæ¥å£çš„æ—¶å€™è¦æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç¼–å†™è§„èŒƒï¼ï¼ï¼</p>
<p>ä¸ºäº†åœ¨å›¢é˜Ÿå†…éƒ¨å½¢æˆå…±è¯†ï¼Œé˜²æ­¢ä¸ªäººä¹ æƒ¯å·®å¼‚å¼•èµ·çš„æ··ä¹±ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ‰¾åˆ°ä¸€ç§å¤§å®¶éƒ½è§‰å¾—å¾ˆå¥½çš„æ¥å£å®ç°è§„èŒƒï¼Œè€Œä¸”è¿™ç§è§„èŒƒèƒ½å¤Ÿè®©åç«¯å†™çš„æ¥å£ï¼Œç”¨é€”ä¸€ç›®äº†ç„¶ï¼Œå‡å°‘å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åŒæ–¹ä¹‹é—´çš„åˆä½œæˆæœ¬ã€‚</p>
<p>ç›®å‰å¸‚é¢ä¸Šå¤§éƒ¨åˆ†å…¬å¸å¼€å‘äººå‘˜ä½¿ç”¨çš„æ¥å£å®ç°è§„èŒƒä¸»è¦æœ‰ï¼šrestfulã€RPCã€‚</p>
<p>RESTå…¨ç§°æ˜¯Representational State Transferï¼Œä¸­æ–‡æ„æ€æ˜¯è¡¨è¿°ï¼ˆç¼–è€…æ³¨ï¼šé€šå¸¸è¯‘ä¸ºè¡¨å¾ï¼‰æ€§çŠ¶æ€è½¬ç§»ã€‚å®ƒé¦–æ¬¡å‡ºç°åœ¨2000å¹´Roy Fieldingçš„åšå£«è®ºæ–‡ä¸­ã€‚</p>
<p>RESTfulæ˜¯ä¸€ç§ä¸“é—¨ä¸ºWebå¼€å‘è€Œå®šä¹‰APIæ¥å£çš„è®¾è®¡é£æ ¼ï¼Œå°¤å…¶é€‚ç”¨äºå‰åç«¯åˆ†ç¦»çš„åº”ç”¨æ¨¡å¼ä¸­ã€‚</p>
<p><strong>å…³é”®ï¼šé¢å‘èµ„æºå¼€å‘</strong></p>
<p>è¿™ç§é£æ ¼çš„ç†å¿µè®¤ä¸ºåç«¯å¼€å‘ä»»åŠ¡å°±æ˜¯æä¾›æ•°æ®çš„ï¼Œå¯¹å¤–æä¾›çš„æ˜¯æ•°æ®èµ„æºçš„è®¿é—®æ¥å£ï¼Œæ‰€ä»¥åœ¨å®šä¹‰æ¥å£æ—¶ï¼Œå®¢æˆ·ç«¯è®¿é—®çš„URLè·¯å¾„å°±è¡¨ç¤ºè¿™ç§è¦æ“ä½œçš„æ•°æ®èµ„æºã€‚</p>
<p>è€Œ<strong>å¯¹äºæ•°æ®èµ„æºåˆ†åˆ«ä½¿ç”¨POSTã€DELETEã€GETã€UPDATEç­‰è¯·æ±‚åŠ¨ä½œæ¥è¡¨è¾¾å¯¹æ•°æ®çš„å¢åˆ æŸ¥æ”¹</strong>ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è¯·æ±‚æ–¹æ³•</th>
<th>è¯·æ±‚åœ°å€</th>
<th>åç«¯æ“ä½œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/student/</td>
<td>å¢åŠ å­¦ç”Ÿ</td>
</tr>
<tr>
<td>GET</td>
<td>/student/</td>
<td>è·å–æ‰€æœ‰å­¦ç”Ÿ</td>
</tr>
<tr>
<td>GET</td>
<td>/student/1</td>
<td>è·å–idä¸º1çš„å­¦ç”Ÿ</td>
</tr>
<tr>
<td>PUT</td>
<td>/student/1</td>
<td>ä¿®æ”¹idä¸º1çš„å­¦ç”Ÿ</td>
</tr>
<tr>
<td>DELETE</td>
<td>/student/1</td>
<td>åˆ é™¤idä¸º1çš„å­¦ç”Ÿ</td>
</tr>
</tbody>
</table>
</div>
<p>restfulè§„èŒƒæ˜¯ä¸€ç§é€šç”¨çš„è§„èŒƒï¼Œä¸é™åˆ¶è¯­è¨€å’Œå¼€å‘æ¡†æ¶çš„ä½¿ç”¨ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€é—¨è¯­è¨€ï¼Œä»»ä½•ä¸€ä¸ªæ¡†æ¶éƒ½å¯ä»¥å®ç°ç¬¦åˆrestfulè§„èŒƒçš„APIæ¥å£ã€‚</p>
<h3 id="fastapiå¿«é€Ÿå¼€å§‹"><a href="#fastapiå¿«é€Ÿå¼€å§‹" class="headerlink" title="fastapiå¿«é€Ÿå¼€å§‹"></a>fastapiå¿«é€Ÿå¼€å§‹</h3><h4 id="ç®€å•æ¡ˆä¾‹"><a href="#ç®€å•æ¡ˆä¾‹" class="headerlink" title="ç®€å•æ¡ˆä¾‹"></a>ç®€å•æ¡ˆä¾‹</h4><p>å®‰è£…ï¼š<code>pip install fastapi</code></p>
<p>è¿˜éœ€è¦ä¸€ä¸ªASGIæœåŠ¡å™¨ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨Uvicornï¼š<code>pip install uvicorn</code></p>
<blockquote>
<p>ASGIï¼ˆ<strong>Asynchronous Server Gateway Interface</strong> ï¼‰æ˜¯ä¸€ç§<strong>å¼‚æ­¥æœåŠ¡å™¨ç½‘å…³æ¥å£</strong> ï¼Œä¸º Python Web åº”ç”¨æä¾›äº†æ ‡å‡†æ¥å£ï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†ç°ä»£ç½‘ç»œåè®®ï¼ˆå¦‚ WebSocketã€HTTP/2 ç­‰ï¼‰çš„å¼‚æ­¥è¯·æ±‚ã€‚ä¸ä¼ ç»Ÿçš„ WSGI ä¸åŒï¼ŒASGI æ”¯æŒå¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œå…è®¸å•ä¸ªè¯·æ±‚å¤„ç†å¤šä¸ªäº‹ä»¶ï¼ˆå¦‚é•¿è¿æ¥ã€åŒå‘é€šä¿¡ï¼‰ï¼Œä»è€Œæå‡é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ€§èƒ½</p>
<p>Uvicorn æ˜¯ä¸€ä¸ªåŸºäº ASGI çš„é«˜æ€§èƒ½å¼‚æ­¥ Web æœåŠ¡å™¨ï¼Œä¸“ä¸º Python å¼‚æ­¥æ¡†æ¶è®¾è®¡ã€‚</p>
<p>webåº”ç”¨ç¨‹åº=webæ¡†æ¶+è‡ªå·±å†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI<span class="comment">#fastapiç±»</span></span><br><span class="line"></span><br><span class="line">app= FastAPI()<span class="comment">#åˆ›å»ºä¸€ä¸ªfastapiå®ä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;user_id&quot;</span>:<span class="number">1001</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/shop&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">shop</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;shop_id&quot;</span>:<span class="number">1002</span>&#125;</span><br></pre></td></tr></table></figure>
<p>å¯åŠ¨ï¼š<code>uvicorn &quot;04 fastapi_begin:app&quot; --reload</code></p>
<p>ä¹Ÿå¯ä»¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uvicorn</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    uvicorn.run(app=<span class="string">&quot;04 fastapi_begin:app&quot;</span>,port=<span class="number">8080</span>,reload=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>æ¥å£æ–‡æ¡£</p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/6.png" alt="6"></p>
<blockquote>
<p>ä¿®é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ Python ä¸­ä¸€ç§åŠ¨æ€ä¿®æ”¹å‡½æ•°æˆ–ç±»è¡Œä¸ºçš„é«˜çº§åŠŸèƒ½ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°æˆ–ç±»ï¼Œå®ƒ<strong>æ¥å—ç›®æ ‡å‡½æ•°æˆ–ç±»ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›åŒ…è£…åçš„æ–°å‡½æ•°æˆ–ç±»å¯¹è±¡</strong>ï¼Œä»è€Œåœ¨<strong>ä¸ä¿®æ”¹åŸå§‹ä»£ç </strong> çš„å‰æä¸‹ä¸ºå¯¹è±¡æ·»åŠ é¢å¤–åŠŸèƒ½</p>
</blockquote>
<h3 id="è·¯å¾„æ“ä½œ"><a href="#è·¯å¾„æ“ä½œ" class="headerlink" title="è·¯å¾„æ“ä½œ"></a>è·¯å¾„æ“ä½œ</h3><h4 id="è·¯å¾„æ“ä½œä¿®é¥°å™¨"><a href="#è·¯å¾„æ“ä½œä¿®é¥°å™¨" class="headerlink" title="è·¯å¾„æ“ä½œä¿®é¥°å™¨"></a>è·¯å¾„æ“ä½œä¿®é¥°å™¨</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get()</span></span><br><span class="line"><span class="meta">@app.post()</span></span><br><span class="line"><span class="meta">@app.put()</span></span><br><span class="line"><span class="meta">@app.patch()</span></span><br><span class="line"><span class="meta">@app.delete()</span></span><br><span class="line"><span class="meta">@app.options()</span></span><br><span class="line"><span class="meta">@app.head()</span></span><br><span class="line"><span class="meta">@app.trace()</span></span><br></pre></td></tr></table></figure>
<p>è·¯å¾„æ“ä½œä¿®é¥°å™¨å‚æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">tagsä¸ºæ¥å£æ·»åŠ æ ‡ç­¾ï¼Œç”¨äºåœ¨è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£</span></span><br><span class="line"><span class="string">summaryä¸ºæ¥å£æ·»åŠ æè¿°</span></span><br><span class="line"><span class="string">descriptionä¸ºæ¥å£æ·»åŠ è¯¦ç»†æè¿°</span></span><br><span class="line"><span class="string">response_descriptionä¸ºæ¥å£è¿”å›å€¼æè¿°</span></span><br><span class="line"><span class="string">deprecatedä¸ºè¿‡æ—¶çš„æ¥å£</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/post&quot;</span>, </span></span></span><br><span class="line"><span class="params"><span class="meta">        tags=[<span class="string">&quot;è¿™æ˜¯postæ–¹æ³•&quot;</span>],</span></span></span><br><span class="line"><span class="params"><span class="meta">        summary=<span class="string">&quot;è¿™æ˜¯postæ–¹æ³•çš„æè¿°&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">        description=<span class="string">&quot;è¿™æ˜¯postæ–¹æ³•çš„è¯¦ç»†æè¿°&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">        response_description=<span class="string">&quot;è¿™æ˜¯postæ–¹æ³•çš„è¿”å›å€¼æè¿°&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">        deprecated=<span class="literal">True</span>, <span class="comment"># è¿‡æ—¶çš„æ¥å£</span></span></span></span><br><span class="line"><span class="params"><span class="meta">        </span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br></pre></td></tr></table></figure>
<h4 id="include-router"><a href="#include-router" class="headerlink" title="include_router"></a>include_router</h4><p>æ–‡ä»¶è·¯å¾„å¦‚ä¸‹</p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/7.png" alt="7"></p>
<p>main.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">import</span> uvicorn</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> apps.app01.shop <span class="keyword">import</span> shop</span><br><span class="line"><span class="keyword">from</span> apps.app02.user <span class="keyword">import</span> user</span><br><span class="line"></span><br><span class="line">app= FastAPI()</span><br><span class="line"></span><br><span class="line">app.include_router(shop,</span><br><span class="line">                 prefix=<span class="string">&quot;/shop&quot;</span>, <span class="comment"># è·¯ç”±å‰ç¼€</span></span><br><span class="line">                 tags=[<span class="string">&quot;è´­ç‰©ä¸­å¿ƒæ¥å£&quot;</span>], <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">                 responses=&#123;<span class="number">200</span>: &#123;<span class="string">&quot;description&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>&#125;&#125; <span class="comment"># å“åº”æè¿°</span></span><br><span class="line">                 )</span><br><span class="line">app.include_router(user,</span><br><span class="line">                 prefix=<span class="string">&quot;/user&quot;</span>, <span class="comment"># è·¯ç”±å‰ç¼€</span></span><br><span class="line">                 tags=[<span class="string">&quot;ç”¨æˆ·æ¥å£&quot;</span>], <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">                 responses=&#123;<span class="number">200</span>: &#123;<span class="string">&quot;description&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>&#125;&#125; <span class="comment"># å“åº”æè¿°</span></span><br><span class="line">                 )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    uvicorn.run(<span class="string">&quot;main:app&quot;</span>, port=<span class="number">8080</span>,  reload=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>shop.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> APIRouter</span><br><span class="line"></span><br><span class="line">shop=APIRouter()</span><br><span class="line"></span><br><span class="line"><span class="meta">@shop.get(<span class="params"><span class="string">&quot;/food&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shop_food</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;food&quot;</span>:<span class="string">&quot;shop food&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@shop.get(<span class="params"><span class="string">&quot;/drink&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shop_drink</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;drink&quot;</span>:<span class="string">&quot;shop drink&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<p>user.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> APIRouter</span><br><span class="line"></span><br><span class="line">user=APIRouter()</span><br><span class="line"></span><br><span class="line"><span class="meta">@user.post(<span class="params"><span class="string">&quot;/login&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_login</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;user&quot;</span>:<span class="string">&quot;user login&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@user.post(<span class="params"><span class="string">&quot;/register&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">user_register</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;user&quot;</span>:<span class="string">&quot;user register&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>include_router</code> æ˜¯ FastAPI æ¡†æ¶ä¸­ç”¨äºæ•´åˆè·¯ç”±çš„æ ¸å¿ƒæ–¹æ³•ï¼Œå…¶ä½œç”¨æ˜¯å°†é€šè¿‡ <code>APIRouter</code> å®šä¹‰çš„è·¯ç”±æ¨¡å—æ·»åŠ åˆ°ä¸»åº”ç”¨ç¨‹åºå®ä¾‹ä¸­ï¼Œä½¿è¿™äº›è·¯ç”±åœ¨åº”ç”¨ä¸­ç”Ÿæ•ˆã€‚</p>
</blockquote>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/8.png" alt="8"></p>
<h3 id="è¯·æ±‚ä¸å“åº”"><a href="#è¯·æ±‚ä¸å“åº”" class="headerlink" title="è¯·æ±‚ä¸å“åº”"></a>è¯·æ±‚ä¸å“åº”</h3><h4 id="4-1-è·¯å¾„å‚æ•°"><a href="#4-1-è·¯å¾„å‚æ•°" class="headerlink" title="4.1 è·¯å¾„å‚æ•°"></a>4.1 è·¯å¾„å‚æ•°</h4><h5 id="ï¼ˆ1ï¼‰åŸºæœ¬ç”¨æ³•"><a href="#ï¼ˆ1ï¼‰åŸºæœ¬ç”¨æ³•" class="headerlink" title="ï¼ˆ1ï¼‰åŸºæœ¬ç”¨æ³•"></a>ï¼ˆ1ï¼‰åŸºæœ¬ç”¨æ³•</h5><p>ä»¥ä½¿ç”¨ä¸ Python æ ¼å¼åŒ–å­—ç¬¦ä¸²ç›¸åŒçš„è¯­æ³•æ¥å£°æ˜è·¯å¾„â€å‚æ•°â€æˆ–â€å˜é‡â€ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/user/&#123;user_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user</span>(<span class="params">user_id</span>):</span><br><span class="line">    <span class="built_in">print</span>(user_id, <span class="built_in">type</span>(user_id))</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;user_id&quot;</span>: user_id&#125;</span><br></pre></td></tr></table></figure>
<p>è·¯å¾„å‚æ•° <code>user_id</code> çš„å€¼å°†ä½œä¸ºå‚æ•° <code>user_id</code> ä¼ é€’ç»™ä½ çš„å‡½æ•°ã€‚</p>
<h5 id="ï¼ˆ2ï¼‰æœ‰ç±»å‹çš„è·¯å¾„å‚æ•°"><a href="#ï¼ˆ2ï¼‰æœ‰ç±»å‹çš„è·¯å¾„å‚æ•°" class="headerlink" title="ï¼ˆ2ï¼‰æœ‰ç±»å‹çš„è·¯å¾„å‚æ•°"></a>ï¼ˆ2ï¼‰æœ‰ç±»å‹çš„è·¯å¾„å‚æ•°</h5><p>ä½ å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ Python ç±»å‹æ ‡æ³¨ä¸ºå‡½æ•°ä¸­çš„è·¯å¾„å‚æ•°å£°æ˜ç±»å‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/user/&#123;user_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user</span>(<span class="params">user_id: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(user_id, <span class="built_in">type</span>(user_id))</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;user_id&quot;</span>: user_id&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>user_id</code> è¢«å£°æ˜ä¸º int ç±»å‹ã€‚</p>
<blockquote>
<p>è¿™å°†ä¸ºä½ çš„å‡½æ•°æä¾›ç¼–è¾‘å™¨æ”¯æŒï¼ŒåŒ…æ‹¬é”™è¯¯æ£€æŸ¥ã€ä»£ç è¡¥å…¨ç­‰ç­‰ã€‚</p>
</blockquote>
<h5 id="ï¼ˆ3ï¼‰æ³¨æ„é¡ºåº"><a href="#ï¼ˆ3ï¼‰æ³¨æ„é¡ºåº" class="headerlink" title="ï¼ˆ3ï¼‰æ³¨æ„é¡ºåº"></a>ï¼ˆ3ï¼‰æ³¨æ„é¡ºåº</h5><p>åœ¨åˆ›å»ºè·¯å¾„æ“ä½œæ—¶ï¼Œä½ ä¼šå‘ç°æœ‰äº›æƒ…å†µä¸‹è·¯å¾„æ˜¯å›ºå®šçš„ã€‚</p>
<p>æ¯”å¦‚ <code>/users/me</code>ï¼Œæˆ‘ä»¬å‡è®¾å®ƒç”¨æ¥è·å–å…³äºå½“å‰ç”¨æˆ·çš„æ•°æ®ã€‚</p>
<p>ç„¶åï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨è·¯å¾„ <code>/user/&#123;username&#125;</code> æ¥é€šè¿‡ç”¨æˆ·åè·å–å…³äºç‰¹å®šç”¨æˆ·çš„æ•°æ®ã€‚</p>
<p>ç”±äºè·¯å¾„æ“ä½œæ˜¯<strong>æŒ‰é¡ºåºä¾æ¬¡è¿è¡Œ</strong>çš„ï¼Œä½ éœ€è¦ç¡®ä¿è·¯å¾„ /<code>user/me</code> å£°æ˜åœ¨è·¯å¾„ <code>/user/&#123;username&#125;</code> ä¹‹å‰ã€‚</p>
<p>å¦‚ä¸‹</p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/image-20250516193934740.png" alt="image-20250516193934740"></p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/image-20250516201128482.png" alt="image-20250516201128482"></p>
<blockquote>
<p>è·¯ç”±ï¼ˆRoutingï¼‰æ˜¯æŒ‡åœ¨ç½‘ç»œä¸­<strong>é€‰æ‹©æ•°æ®ä¼ è¾“è·¯å¾„</strong>çš„è¿‡ç¨‹ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯å°†æ•°æ®ä»æºç‚¹é«˜æ•ˆã€å¯é åœ°ä¼ è¾“åˆ°ç›®çš„åœ°</p>
<p>cURL æ˜¯ä¸€ä¸ªå¼€æºçš„å‘½ä»¤è¡Œå·¥å…·å’Œè·¨å¹³å°çš„åº“ï¼ˆlibcurlï¼‰ï¼Œç”¨äºåŸºäº URL è¯­æ³•åœ¨ç½‘ç»œåè®®ä¸‹è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚å®ƒæ”¯æŒå¤šç§åè®®ï¼ˆå¦‚ HTTPã€HTTPSã€FTPã€SMTP ç­‰ï¼‰ï¼Œèƒ½å¤Ÿå®ç°æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ä»¥åŠä¸ Web æœåŠ¡å™¨çš„äº¤äº’ï¼Œå¸¸è¢«å¼€å‘è€…ç”¨äº API æµ‹è¯•ã€æ•°æ®ä¼ è¾“ç­‰åœºæ™¯</p>
</blockquote>
<h4 id="4-2-æŸ¥è¯¢å‚æ•°ï¼ˆè¯·æ±‚å‚æ•°ï¼‰"><a href="#4-2-æŸ¥è¯¢å‚æ•°ï¼ˆè¯·æ±‚å‚æ•°ï¼‰" class="headerlink" title="4.2 æŸ¥è¯¢å‚æ•°ï¼ˆè¯·æ±‚å‚æ•°ï¼‰"></a>4.2 æŸ¥è¯¢å‚æ•°ï¼ˆè¯·æ±‚å‚æ•°ï¼‰</h4><p>è·¯å¾„å‡½æ•°ä¸­å£°æ˜<strong>ä¸å±äºè·¯å¾„å‚æ•°çš„å…¶ä»–å‡½æ•°å‚æ•°</strong>æ—¶ï¼Œå®ƒä»¬å°†è¢«<strong>è‡ªåŠ¨è§£é‡Šä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°</strong>ï¼Œå°±æ˜¯ <code>urlï¼Ÿ</code>ä¹‹åç”¨ <code>&amp;</code> åˆ†å‰²çš„ <code>key-value é”®å€¼å¯¹</code>ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app02.get(<span class="params"><span class="string">&quot;/jobs&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_jobs</span>(<span class="params">kind1: <span class="built_in">str</span>, kind2: <span class="built_in">str</span>, kind3: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="comment">#åŸºäºæŸ¥è¯¢å‚æ•°çš„å€¼æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œ</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;kind1&quot;</span>: kind1,</span><br><span class="line">        <span class="string">&quot;kind2&quot;</span>: kind2,</span><br><span class="line">        <span class="string">&quot;kind3&quot;</span>: kind3</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/image-20250516201707589.png" alt="image-20250516201707589"></p>
<p>å¢åŠ è·¯å¾„å‚æ•°ï¼škind1ä¸ºè·¯å¾„å‚æ•°</p>
<p>å¢åŠ é»˜è®¤å‚æ•°å€¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app02.get(<span class="params"><span class="string">&quot;/jobs/&#123;kind1&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_jobs</span>(<span class="params">kind1: <span class="built_in">str</span>, kind2: <span class="built_in">str</span>=<span class="string">&quot;None&quot;</span>, kind3: <span class="built_in">str</span>=<span class="string">&quot;None&quot;</span></span>):<span class="comment">#å¢åŠ é»˜è®¤å€¼ï¼Œå¯é€‰å¡«</span></span><br><span class="line">    <span class="comment">#åŸºäºæŸ¥è¯¢å‚æ•°çš„å€¼æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œ</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;kind1&quot;</span>: kind1,</span><br><span class="line">        <span class="string">&quot;kind2&quot;</span>: kind2,</span><br><span class="line">        <span class="string">&quot;kind3&quot;</span>: kind3</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>Request URLï¼š</p>
<p><code>http://127.0.0.1:8080/app02/jobs/11?kind2=22&amp;kind3=33</code></p>
<p>è‡ªpython3.5å¼€å§‹ï¼ŒPEP484ä¸ºpythonå¼•å…¥äº†ç±»å‹æ³¨è§£(type hints)ï¼Œtypingçš„ä¸»è¦ä½œç”¨æœ‰ï¼š</p>
<blockquote>
<p>1.ç±»å‹æ£€æŸ¥ï¼Œé˜²æ­¢è¿è¡Œæ—¶å‡ºç°å‚æ•°ã€è¿”å›å€¼ç±»å‹ä¸ç¬¦ã€‚</p>
<p>2.ä½œä¸ºå¼€å‘æ–‡æ¡£é™„åŠ è¯´æ˜ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…è°ƒç”¨æ—¶ä¼ å…¥å’Œè¿”å›å‚æ•°ç±»å‹ã€‚</p>
<p>3.æ¨¡å—åŠ å…¥ä¸ä¼šå½±å“ç¨‹åºçš„è¿è¡Œä¸ä¼šæŠ¥æ­£å¼çš„é”™è¯¯ï¼Œpycharmæ”¯æŒtypingæ£€æŸ¥é”™è¯¯æ—¶ä¼šå‡ºç°é»„è‰²è­¦å‘Šã€‚</p>
</blockquote>
<p><code>type hints</code>ä¸»è¦æ˜¯è¦æŒ‡ç¤ºå‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºçš„æ•°æ®ç±»å‹ï¼Œæ•°æ®ç±»å‹åœ¨typingåŒ…ä¸­ï¼ŒåŸºæœ¬ç±»å‹æœ‰<code>str list dict</code>ç­‰ç­‰ï¼Œ</p>
<blockquote>
<p>Type Hints æ˜¯ Python 3.5 å¼•å…¥çš„åŠŸèƒ½ï¼Œé€šè¿‡ç±»å‹æ³¨è§£å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚å®ƒå…è®¸å¼€å‘è€…ä¸ºå˜é‡ã€å‡½æ•°å‚æ•°ã€è¿”å›å€¼ç­‰æŒ‡å®šé¢„æœŸçš„æ•°æ®ç±»å‹ï¼Œä»è€Œå¸®åŠ©é™æ€ç±»å‹æ£€æŸ¥å·¥å…·ï¼ˆå¦‚ <code>mypy</code>ï¼‰æ•è·æ½œåœ¨é”™è¯¯ï¼Œå¹¶æå‡ IDE çš„æ™ºèƒ½æç¤ºèƒ½åŠ›ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">greet</span>(<span class="params">name: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Hello, <span class="subst">&#123;name&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„ <code>name: str</code> è¡¨ç¤ºå‚æ•°éœ€ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œ<code>-&gt; str</code> è¡¨ç¤ºè¿”å›å€¼ç±»å‹ä¸ºå­—ç¬¦ä¸² ã€‚</p>
</blockquote>
<p><code>Union</code>æ˜¯å½“æœ‰å¤šç§å¯èƒ½çš„æ•°æ®ç±»å‹æ—¶ä½¿ç”¨ï¼Œæ¯”å¦‚å‡½æ•°æœ‰å¯èƒ½æ ¹æ®ä¸åŒæƒ…å†µæœ‰æ—¶è¿”å›stræˆ–è¿”å›listï¼Œé‚£ä¹ˆå°±å¯ä»¥å†™æˆ<code>Union[list, str]</code></p>
<blockquote>
<p>ä» Python 3.10 èµ·ï¼Œ<code>Union[X, Y]</code> å¯ç®€å†™ä¸º <code>X | Y</code>ã€‚ä¾‹å¦‚ <code>int | str</code> ç­‰ä»·äº <code>Union[int, str]</code> ã€‚</p>
<p>å†ä¾‹å¦‚ï¼š<code>kind2:str|None=None</code></p>
</blockquote>
<p><code>Optional</code>æ˜¯Unionçš„ä¸€ä¸ªç®€åŒ–ï¼Œå½“æ•°æ®ç±»å‹ä¸­æœ‰å¯èƒ½æ˜¯Noneæ—¶ï¼Œæ¯”å¦‚æœ‰å¯èƒ½æ˜¯strä¹Ÿæœ‰å¯èƒ½æ˜¯Noneï¼Œåˆ™Optional[str]ï¼Œç›¸å½“äºUnion[str, None]</p>
<h4 id="4-3-è¯·æ±‚ä½“æ•°æ®"><a href="#4-3-è¯·æ±‚ä½“æ•°æ®" class="headerlink" title="4.3 è¯·æ±‚ä½“æ•°æ®"></a>4.3 è¯·æ±‚ä½“æ•°æ®</h4><p>å½“ä½ éœ€è¦å°†æ•°æ®ä»å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚æµè§ˆå™¨ï¼‰å‘é€ç»™ API æ—¶ï¼Œä½ å°†å…¶ä½œä¸ºã€Œè¯·æ±‚ä½“ã€å‘é€ã€‚è¯·æ±‚ä½“æ˜¯å®¢æˆ·ç«¯å‘é€ç»™ API çš„æ•°æ®ã€‚å“åº”ä½“æ˜¯ API å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ®ã€‚</p>
<p>FastAPI åŸºäº <code>Pydantic</code> ï¼Œ<code>Pydantic</code> ä¸»è¦ç”¨æ¥åšç±»å‹å¼ºåˆ¶æ£€æŸ¥ï¼ˆæ ¡éªŒæ•°æ®ï¼‰ã€‚ä¸ç¬¦åˆç±»å‹è¦æ±‚å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>å¯¹äº API æœåŠ¡ï¼Œæ”¯æŒç±»å‹æ£€æŸ¥éå¸¸æœ‰ç”¨ï¼Œä¼šè®©æœåŠ¡æ›´åŠ å¥å£®ï¼Œä¹Ÿä¼šåŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œå› ä¸ºå¼€å‘è€…å†ä¹Ÿä¸ç”¨è‡ªå·±å†™ä¸€è¡Œä¸€è¡Œçš„åšç±»å‹æ£€æŸ¥ã€‚</p>
<p>å®‰è£…ä¸Šæ‰‹ <code>pip install pydantic</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> APIRouter</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel,Field,field_validator</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span>,<span class="type">Optional</span></span><br><span class="line"></span><br><span class="line">app03 = APIRouter()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Address</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    province: <span class="built_in">str</span></span><br><span class="line">    city: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    <span class="comment">#æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="comment">#username:str=Field(pattern=&quot;^[a-zA-Z0-9]&#123;3,10&#125;$&quot;,title=&quot;ç”¨æˆ·å&quot;,description=&quot;ç”¨æˆ·åé•¿åº¦åœ¨3-10ä¹‹é—´ï¼Œä¸”åªèƒ½åŒ…å«å­—æ¯å’Œæ•°å­—&quot;)</span></span><br><span class="line">    <span class="comment">#name: str|None = None</span></span><br><span class="line">    name:<span class="built_in">str</span></span><br><span class="line">    age: <span class="built_in">int</span>=Field(default=<span class="number">0</span>,gt=<span class="number">0</span>,lt=<span class="number">100</span>)</span><br><span class="line">    birth:<span class="type">Union</span>[date,<span class="literal">None</span>] = <span class="literal">None</span></span><br><span class="line">    friends:<span class="built_in">list</span>[<span class="built_in">int</span>]=[]</span><br><span class="line">    description:<span class="type">Optional</span>[<span class="built_in">str</span>]=<span class="literal">None</span></span><br><span class="line">    <span class="comment">#åµŒå¥—</span></span><br><span class="line">    addr:Address|<span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    field_validator çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ clsï¼Œå› ä¸ºå®ƒæ˜¯ç±»æ–¹æ³• ï¼ˆclassmethodï¼‰ï¼Œç”¨äºåœ¨éªŒè¯å­—æ®µæ—¶è®¿é—®æ¨¡å‹ç±»çš„ä¸Šä¸‹æ–‡ã€‚</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">    @field_validator(<span class="params"><span class="string">&quot;name&quot;</span></span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">name_must_alpha</span>(<span class="params">cls,value</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        value.isalpha() ä¼šæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦åªç”±å­—æ¯ç»„æˆï¼Œå¦‚æœæ˜¯åˆ™è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</span></span><br><span class="line"><span class="string">        å¦‚æœè¿”å› Falseï¼Œassert è§¦å‘ï¼Œä¼šæŠ›å‡º AssertionErrorï¼Œå¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ &quot;name must be alpha&quot;ã€‚</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">assert</span> value.isalpha(), <span class="string">&quot;name must be alpha&quot;</span></span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"><span class="comment">#åµŒå¥—</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Data</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    data:<span class="built_in">list</span>[User]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app03.post(<span class="params"><span class="string">&quot;/user&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">user</span>(<span class="params">user:User</span>):</span><br><span class="line">    <span class="built_in">print</span>(user,<span class="built_in">type</span>(user))</span><br><span class="line">    <span class="keyword">return</span> user</span><br><span class="line"></span><br><span class="line"><span class="meta">@app03.post(<span class="params"><span class="string">&quot;/data&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">data</span>(<span class="params">data:Data</span>):</span><br><span class="line">    <span class="built_in">print</span>(data,<span class="built_in">type</span>(data))</span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>BaseModel</code>ä¸“é—¨ç”¨äºæ•°æ®éªŒè¯ã€æ•°æ®è½¬æ¢å’Œåºåˆ—åŒ–ã€‚åœ¨å®šä¹‰æ•°æ®ç»“æ„æ—¶ç»§æ‰¿è‡ª BaseModelï¼Œå¯ä»¥ï¼š</p>
<ul>
<li><strong>è‡ªåŠ¨æ ¡éªŒæ•°æ®ç±»å‹</strong>ï¼šæ ¹æ®ç±»ä¸­å­—æ®µçš„ç±»å‹æ³¨è§£ï¼Œè‡ªåŠ¨æ ¡éªŒè¾“å…¥æ•°æ®æ˜¯å¦ç¬¦åˆé¢„æœŸç±»å‹ã€‚</li>
<li><strong>æ•°æ®è½¬æ¢</strong>ï¼šå¯ä»¥è‡ªåŠ¨å°†è¾“å…¥æ•°æ®ï¼ˆä¾‹å¦‚ JSON å­—ç¬¦ä¸²ï¼‰è½¬æ¢æˆç›¸åº”çš„ Python æ•°æ®ç±»å‹ã€‚</li>
<li><strong>åºåˆ—åŒ–è¾“å‡º</strong>ï¼šæ”¯æŒå°†æ¨¡å‹å®ä¾‹è½¬æ¢æˆ JSONã€å­—å…¸ç­‰æ ¼å¼ï¼Œä¾¿äºå“åº”è¾“å‡ºã€‚</li>
</ul>
<p>åœ¨ Pydantic ä¸­ï¼Œ<code>Field</code> ç”¨äºä¸ºæ¨¡å‹å­—æ®µæä¾›é¢å¤–çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è®¾ç½®é»˜è®¤å€¼ã€æè¿°ä¿¡æ¯ã€çº¦æŸæ¡ä»¶ï¼ˆä¾‹å¦‚é•¿åº¦ã€èŒƒå›´ç­‰ï¼‰æˆ–åˆ«åã€‚è¿™å¯ä»¥å¸®åŠ©è‡ªåŠ¨ç”Ÿæˆ OpenAPI æ–‡æ¡£ã€å¢å¼ºéªŒè¯æˆ–å¯¹å­—æ®µè¿›è¡Œæ›´ç»†ç²’åº¦çš„æ§åˆ¶ã€‚</p>
<p><code>field_validator</code> æ˜¯ Pydantic v2 ä¸­ç”¨äºæ›¿ä»£æ—§ç‰ˆ <code>@validator</code> çš„æ–°è£…é¥°å™¨ï¼Œä¸“é—¨ç”¨äºä¸ºæ¨¡å‹å­—æ®µæ·»åŠ è‡ªå®šä¹‰éªŒè¯é€»è¾‘ã€‚å®ƒé€šè¿‡æ›´æ¸…æ™°çš„å‘½åå’Œæ›´çµæ´»çš„æ¨¡å¼ï¼ˆå¦‚ <code>mode=&quot;before&quot;</code> æˆ– <code>mode=&quot;after&quot;</code>ï¼‰æå‡ä»£ç å¯è¯»æ€§å’ŒéªŒè¯é€»è¾‘çš„æ§åˆ¶èƒ½åŠ›</p>
<p><code>field_validator</code>å’Œ<code>model_validator</code>åŒºåˆ«</p>
<p><strong><code>field_validator</code></strong>ä¸“é—¨é’ˆå¯¹<strong>å•ä¸ªå­—æ®µ</strong> è¿›è¡ŒéªŒè¯ï¼Œé€‚ç”¨äºéœ€è¦æ ¡éªŒç‰¹å®šå­—æ®µçš„è§„åˆ™ï¼ˆå¦‚é•¿åº¦ã€æ ¼å¼ã€ç±»å‹çº¦æŸï¼‰ã€‚ä¾‹å¦‚éªŒè¯ç”¨æˆ·åé•¿åº¦</p>
<p><strong><code>model_validator</code></strong>ä½œç”¨äº<strong>æ•´ä¸ªæ¨¡å‹å®ä¾‹</strong> ï¼Œé€‚ç”¨äºéœ€è¦è·¨å­—æ®µéªŒè¯æˆ–å…¨å±€é€»è¾‘çš„åœºæ™¯ã€‚ä¾‹å¦‚æ£€æŸ¥ä¸¤æ¬¡å¯†ç æ˜¯å¦ä¸€è‡´</p>
</blockquote>
<h4 id="4-4-formè¡¨å•æ•°æ®"><a href="#4-4-formè¡¨å•æ•°æ®" class="headerlink" title="4.4 formè¡¨å•æ•°æ®"></a>4.4 formè¡¨å•æ•°æ®</h4><p>åœ¨ <code>OAuth2</code> è§„èŒƒçš„ä¸€ç§ä½¿ç”¨æ–¹å¼ï¼ˆå¯†ç æµï¼‰ä¸­ï¼Œéœ€è¦å°†ç”¨æˆ·åã€å¯†ç ä½œä¸ºè¡¨å•å­—æ®µå‘é€ï¼Œè€Œä¸æ˜¯ JSONã€‚</p>
<p>FastAPI å¯ä»¥ä½¿ç”¨ <strong>Form ç»„ä»¶</strong>æ¥æ¥æ”¶è¡¨å•æ•°æ®ï¼Œéœ€è¦å…ˆä½¿ç”¨ <code>pip install python-multipart</code> å‘½ä»¤è¿›è¡Œå®‰è£…ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app04.post(<span class="params"><span class="string">&quot;/register&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">data</span>(<span class="params">username:<span class="built_in">str</span>=Form(<span class="params"></span>),password:<span class="built_in">str</span>=Form(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;username: <span class="subst">&#123;username&#125;</span>, password: <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: username,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: password</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å‘é€postè¯·æ±‚ï¼šformè¡¨å•æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›®æ ‡ URL</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:8080/app04/register&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨å•æ•°æ®ï¼ˆé”®å€¼å¯¹ï¼‰</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;test_user&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;secure_password_123&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€ POST è¯·æ±‚</span></span><br><span class="line">response = requests.post(</span><br><span class="line">    url, </span><br><span class="line">    data=data</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>é€šè¿‡ requests.post() çš„ data å‚æ•°ä¼ é€’è¡¨å•æ•°æ®ï¼Œè¯¥å‚æ•°æ¥å—å­—å…¸æˆ–å­—ç¬¦ä¸²æ ¼å¼çš„æ•°æ®ã€‚requests ä¼šè‡ªåŠ¨å°†å…¶ç¼–ç ä¸º application/x-www-form-urlencoded æ ¼å¼</p>
</blockquote>
<h4 id="4-5-æ–‡ä»¶ä¸Šä¼ "><a href="#4-5-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="4.5 æ–‡ä»¶ä¸Šä¼ "></a>4.5 æ–‡ä»¶ä¸Šä¼ </h4><p>å¯¼å…¥å¿…è¦åº“</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> File,UploadFile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app05 = APIRouter()</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å­—èŠ‚ä¸Šä¼ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app05.post(<span class="params"><span class="string">&quot;/file&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">file</span>(<span class="params">file: <span class="built_in">bytes</span> = File(<span class="params">...</span>)</span>):</span><br><span class="line">    <span class="comment">#é€‚åˆå°æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;filename&quot;</span>: <span class="string">&quot;file&quot;</span>,</span><br><span class="line">        <span class="string">&quot;size&quot;</span>: <span class="built_in">len</span>(file)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¤šæ–‡ä»¶ä¸Šä¼ </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app05.post(<span class="params"><span class="string">&quot;/files&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">files</span>(<span class="params">files: <span class="built_in">list</span>[<span class="built_in">bytes</span>] = File(<span class="params">...</span>)</span>):</span><br><span class="line">    <span class="comment">#å¤šæ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">len</span>(file))</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;filename&quot;</span>: <span class="string">&quot;files&quot;</span>,</span><br><span class="line">        <span class="string">&quot;size&quot;</span>: <span class="built_in">len</span>(files)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>UploadFileä¸Šä¼ ï¼Œç»å¯¹è·¯å¾„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app05.post(<span class="params"><span class="string">&quot;/uploadfile&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">upload_file</span>(<span class="params">file: UploadFile= File(<span class="params">...</span>)</span>):</span><br><span class="line">    <span class="comment">#é€‚åˆå¤§æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line">    <span class="comment"># è·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</span></span><br><span class="line">    base_dir = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line">    <span class="built_in">print</span>(base_dir)</span><br><span class="line">    img_dir = os.path.join(base_dir, <span class="string">&quot;../imgs&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(img_dir)</span><br><span class="line">    <span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line">    path = os.path.join(img_dir, file.filename)</span><br><span class="line">    <span class="comment">#path=os.path.join(&quot;../imgs&quot;,file.filename)</span></span><br><span class="line">    <span class="built_in">print</span>(path)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ–‡ä»¶å:&quot;</span>, file.filename)</span><br><span class="line">        <span class="keyword">for</span> chunk <span class="keyword">in</span> file.file:</span><br><span class="line">            f.write(chunk)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;filename&quot;</span>: file.filename</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>UploadFileæ˜¯ FastAPI æä¾›çš„ä¸€ä¸ªç±»ï¼Œç”¨äºå¤„ç†æ–‡ä»¶ä¸Šä¼ ã€‚ä¸ç›´æ¥å°†æ–‡ä»¶å†…å®¹è¯»å–ä¸ºå­—èŠ‚æµï¼ˆä¾‹å¦‚ bytesç›¸æ¯”ï¼ŒUploadFileæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p>
<ul>
<li><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šå®ƒé‡‡ç”¨äº†æ–‡ä»¶å¯¹è±¡çš„æ–¹å¼å¤„ç†ä¸Šä¼ æ–‡ä»¶ï¼Œä¸å¿…å°†æ•´ä¸ªæ–‡ä»¶å†…å®¹ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œé€‚åˆå¤„ç†å¤§æ–‡ä»¶ã€‚</li>
<li><strong>å¼‚æ­¥æ”¯æŒ</strong>ï¼šæ”¯æŒå¼‚æ­¥æ“ä½œï¼Œå¯ä»¥ç”¨å¼‚æ­¥æ–¹å¼è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæé«˜æ€§èƒ½ã€‚</li>
<li><strong>æ–‡ä»¶å…ƒæ•°æ®</strong>ï¼šæä¾›æ–‡ä»¶åã€å†…å®¹ç±»å‹ç­‰å…ƒæ•°æ®ä¿¡æ¯ï¼Œé€šè¿‡å±æ€§ <code>filename</code>ã€<code>content_type</code> è·å–ã€‚</li>
<li><strong>æ–‡ä»¶æ¥å£</strong>ï¼šé€šè¿‡ file å±æ€§è·å–ä¸€ä¸ªç±»æ–‡ä»¶å¯¹è±¡ï¼Œå¯ä»¥åƒæ“ä½œæ™®é€šæ–‡ä»¶ä¸€æ ·è¯»å–æˆ–ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶ã€‚</li>
</ul>
</blockquote>
<h4 id="4-6-Requestå¯¹è±¡"><a href="#4-6-Requestå¯¹è±¡" class="headerlink" title="4.6 Requestå¯¹è±¡"></a>4.6 Requestå¯¹è±¡</h4><p>æœ‰äº›æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›èƒ½ç›´æ¥è®¿é—® Request å¯¹è±¡ã€‚ä¾‹å¦‚æˆ‘ä»¬åœ¨è·¯å¾„æ“ä½œå‡½æ•°ä¸­æƒ³è·å–å®¢æˆ·ç«¯çš„ IP åœ°å€ï¼Œéœ€è¦åœ¨å‡½æ•°ä¸­å£°æ˜ Request ç±»å‹çš„å‚æ•°ï¼ŒFastAPI å°±ä¼šè‡ªåŠ¨ä¼ é€’ Request å¯¹è±¡ç»™è¿™ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ° Request å¯¹è±¡åŠå…¶å±æ€§ä¿¡æ¯ï¼Œä¾‹å¦‚ headerã€urlã€cookieã€session ç­‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app06.post(<span class="params"><span class="string">&quot;/items&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">items</span>(<span class="params">request: Request</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;url:&quot;</span>, request.url)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å®¢æˆ·ç«¯ip:&quot;</span>, request.client.host)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¯·æ±‚å¤´:&quot;</span>, request.headers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å®¢æˆ·ç«¯å®¿ä¸»&quot;</span>,request.headers.get(<span class="string">&quot;user-agent&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;cookie:&quot;</span>, request.cookies)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;url&quot;</span>: request.url,</span><br><span class="line">        <span class="string">&quot;client_ip&quot;</span>: request.client.host,</span><br><span class="line">        <span class="string">&quot;headers&quot;</span>: request.headers,</span><br><span class="line">        <span class="string">&quot;user_agent&quot;</span>: request.headers.get(<span class="string">&quot;user-agent&quot;</span>),</span><br><span class="line">        <span class="string">&quot;cookies&quot;</span>: request.cookies</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-7è¯·æ±‚é™æ€æ–‡ä»¶"><a href="#4-7è¯·æ±‚é™æ€æ–‡ä»¶" class="headerlink" title="4.7è¯·æ±‚é™æ€æ–‡ä»¶"></a>4.7è¯·æ±‚é™æ€æ–‡ä»¶</h4><p>åœ¨ Web å¼€å‘ä¸­ï¼Œéœ€è¦è¯·æ±‚å¾ˆå¤šé™æ€èµ„æºæ–‡ä»¶ï¼ˆä¸æ˜¯ç”±æœåŠ¡å™¨ç”Ÿæˆçš„æ–‡ä»¶ï¼‰ï¼Œå¦‚ css/js å’Œå›¾ç‰‡æ–‡ä»¶ç­‰ã€‚</p>
<p>main.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi.staticfiles <span class="keyword">import</span> StaticFiles</span><br><span class="line">app.mount(<span class="string">&quot;/static&quot;</span>, StaticFiles(directory=<span class="string">&quot;statics&quot;</span>))<span class="comment">#é™æ€æ–‡ä»¶ç›®å½•</span></span><br></pre></td></tr></table></figure>
<p><img src="./../../../../images/fastapi/image-20250517143857442.png" alt="image-20250517143857442"></p>
<p><img src="./../../../../images/fastapi/image-20250517143914772.png" alt="image-20250517143914772"></p>
<blockquote>
<p><strong>é™æ€ç½‘ç«™</strong></p>
<p>å®Œå…¨ç”±é™æ€æ–‡ä»¶ï¼ˆHTMLã€CSSã€JavaScriptï¼‰ç»„æˆï¼Œå†…å®¹å›ºå®šä¸å˜ï¼Œæ‰€æœ‰é¡µé¢åœ¨å¼€å‘æ—¶å·²é¢„ç”Ÿæˆï¼Œæ— éœ€åŠ¨æ€è®¡ç®—æˆ–æ•°æ®åº“æ”¯æŒ</p>
<p><strong>åŠ¨æ€ç½‘ç«™</strong></p>
<p>å†…å®¹æ ¹æ®ç”¨æˆ·è¯·æ±‚å®æ—¶ç”Ÿæˆï¼Œé€šå¸¸ä¾èµ–æ•°æ®åº“å’ŒæœåŠ¡å™¨ç«¯ç¼–ç¨‹ï¼ˆå¦‚PHPã€Pythonã€Node.jsï¼‰ï¼Œèƒ½æä¾›ä¸ªæ€§åŒ–å’Œäº¤äº’åŠŸèƒ½</p>
<p><code>StaticFiles</code>æ˜¯ FastAPIï¼ˆå®é™…æ¥è‡ª Starletteï¼‰æä¾›çš„ä¸€ä¸ªç±»ï¼Œç”¨äºæŒ‚è½½å’ŒæœåŠ¡é™æ€æ–‡ä»¶ç›®å½•ã€‚<br>å®ƒçš„ä½œç”¨æ˜¯è®©ä½ å¯ä»¥é€šè¿‡ HTTP è·¯å¾„ç›´æ¥è®¿é—®æœåŠ¡å™¨ä¸Šçš„é™æ€èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€CSSã€JS æ–‡ä»¶ç­‰ï¼‰ã€‚</p>
<p><code>mount()</code>æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨æˆ–é™æ€æ–‡ä»¶ç›®å½•æŒ‚è½½åˆ°ä¸» FastAPI åº”ç”¨çš„æŸä¸ªè·¯å¾„ä¸‹ã€‚è¿™æ ·ï¼Œè®¿é—®æŒ‡å®šè·¯å¾„æ—¶ï¼Œè¯·æ±‚ä¼šè¢«è½¬å‘åˆ°æŒ‚è½½çš„åº”ç”¨æˆ–ç›®å½•ã€‚</p>
</blockquote>
<h4 id="4-8-å“åº”æ¨¡å‹ç›¸å…³å‚æ•°"><a href="#4-8-å“åº”æ¨¡å‹ç›¸å…³å‚æ•°" class="headerlink" title="4.8 å“åº”æ¨¡å‹ç›¸å…³å‚æ•°"></a>4.8 å“åº”æ¨¡å‹ç›¸å…³å‚æ•°</h4><h5 id="response-model"><a href="#response-model" class="headerlink" title="response_model"></a>response_model</h5><p><code>response_model</code>æ˜¯ FastAPI è·¯ç”±è£…é¥°å™¨ï¼ˆå¦‚ <code>@app.post</code>ã€<code>@app.get</code> ç­‰ï¼‰ä¸­çš„ä¸€ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šæ¥å£å“åº”çš„æ•°æ®æ¨¡å‹ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼š</p>
<ul>
<li><strong>è‡ªåŠ¨æ ¡éªŒå’Œåºåˆ—åŒ–</strong>ï¼šFastAPI ä¼šæ ¹æ®ä½ æŒ‡å®šçš„ Pydantic æ¨¡å‹è‡ªåŠ¨æ ¡éªŒã€è¿‡æ»¤å’Œæ ¼å¼åŒ–è¿”å›çš„æ•°æ®ã€‚</li>
<li><strong>è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£</strong>ï¼šæ¥å£æ–‡æ¡£ä¼šè‡ªåŠ¨æ˜¾ç¤ºå“åº”çš„æ•°æ®ç»“æ„ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserIn</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    username: <span class="built_in">str</span></span><br><span class="line">    password: <span class="built_in">str</span></span><br><span class="line">    email: EmailStr</span><br><span class="line">    full_name: <span class="built_in">str</span>|<span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserOut</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    username: <span class="built_in">str</span></span><br><span class="line">    email: EmailStr</span><br><span class="line">    full_name: <span class="built_in">str</span>|<span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app07.post(<span class="params"><span class="string">&quot;/user02&quot;</span>,response_model=UserOut</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">create_user</span>(<span class="params">user: UserIn</span>):</span><br><span class="line">    <span class="comment"># è¿™é‡Œå¯ä»¥è¿›è¡Œä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚å°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°æ•°æ®åº“ä¸­</span></span><br><span class="line">    <span class="keyword">return</span> user</span><br></pre></td></tr></table></figure>
<p>æ¡ˆä¾‹ï¼š</p>
<ul>
<li>æ³¨å†ŒåŠŸèƒ½</li>
<li>è¾“å…¥è´¦å·ã€å¯†ç ã€æ˜µç§°ã€é‚®ç®±ï¼Œæ³¨å†ŒæˆåŠŸåè¿”å›ä¸ªäººä¿¡æ¯</li>
</ul>
<h5 id="response-model-exclude-unset-True"><a href="#response-model-exclude-unset-True" class="headerlink" title="response_model_exclude_unset=True"></a>response_model_exclude_unset=True</h5><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å­¦åˆ°äº†å¦‚ä½•ç”¨ response_model æ§åˆ¶å“åº”ä½“ç»“æ„ï¼Œä½†æ˜¯ï¼Œå¦‚æœå®ƒä»¬å®é™…ä¸Šæ²¡æœ‰å­˜å‚¨ï¼Œåˆ™å¯èƒ½è¦ä»ç»“æœä¸­å¿½ç•¥å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ model åœ¨ NoSQL æ•°æ®åº“ä¸­å…·æœ‰å¾ˆå¤šå¯é€‰å±æ€§ï¼Œä½†æ˜¯ä¸æƒ³å‘é€å¾ˆé•¿çš„ JSON å“åº”ï¼Œå…¶ä¸­åŒ…å«é»˜è®¤å€¼ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Item</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    name:<span class="built_in">str</span></span><br><span class="line">    description: <span class="built_in">str</span>|<span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line">    price: <span class="built_in">float</span></span><br><span class="line">    tax:<span class="built_in">float</span>=<span class="number">10.5</span></span><br><span class="line">    tags: <span class="built_in">list</span>[<span class="built_in">str</span>]|<span class="literal">None</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¨¡æ‹Ÿæ•°æ®åº“</span></span><br><span class="line">items=&#123;</span><br><span class="line">    <span class="string">&quot;item01&quot;</span>:Item(name=<span class="string">&quot;item01&quot;</span>,price=<span class="number">10.5</span>),</span><br><span class="line">    <span class="string">&quot;item02&quot;</span>:Item(name=<span class="string">&quot;item02&quot;</span>,description=<span class="string">&quot;item02&quot;</span>,price=<span class="number">20.5</span>,tax=<span class="number">20.5</span>,tags=[<span class="string">&quot;tag1&quot;</span>,<span class="string">&quot;tag2&quot;</span>]),</span><br><span class="line">    <span class="string">&quot;item03&quot;</span>:Item(name=<span class="string">&quot;item03&quot;</span>,description=<span class="string">&quot;item03&quot;</span>,price=<span class="number">30.5</span>,tax=<span class="number">30.5</span>,tags=[<span class="string">&quot;tag1&quot;</span>,<span class="string">&quot;tag2&quot;</span>]),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@app07.get(<span class="params"><span class="string">&quot;/items/&#123;item_id&#125;&quot;</span>,response_model=Item,response_model_exclude_unset=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_item</span>(<span class="params">item_id: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> items[item_id]</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®åè¿”å›ä¸ºï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">item01</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;item01&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;price&quot;</span><span class="punctuation">:</span> <span class="number">10.5</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å½“ä½ è®¾ç½® <code>response_model_exclude_unset=True</code> æ—¶ï¼Œè¿”å›çš„å“åº”æ•°æ®åªåŒ…å«<strong>è¢«æ˜¾å¼è®¾ç½®è¿‡çš„å­—æ®µ</strong>ï¼Œæ²¡æœ‰è¢«èµ‹å€¼çš„ï¼ˆå³ä½¿ç”¨é»˜è®¤å€¼ä¸”æœªä¼ é€’çš„ï¼‰å­—æ®µä¸ä¼šå‡ºç°åœ¨å“åº”ä¸­ã€‚</p>
</blockquote>
<h5 id="å…¶ä»–å‚æ•°"><a href="#å…¶ä»–å‚æ•°" class="headerlink" title="å…¶ä»–å‚æ•°"></a>å…¶ä»–å‚æ•°</h5><p><strong>response_model_exclude_defaults </strong>ä½œç”¨ï¼šæ’é™¤æ‰€æœ‰å€¼ä¸ºé»˜è®¤å€¼çš„å­—æ®µã€‚</p>
<p><strong>response_model_exclude_none</strong> ä½œç”¨ï¼šæ’é™¤æ‰€æœ‰å€¼ä¸º <code>None</code> çš„å­—æ®µã€‚</p>
<p><strong>response_model_include</strong> ä½œç”¨ï¼šåªè¿”å›æŒ‡å®šå­—æ®µ</p>
<p><strong>response_model_exclude</strong> ä½œç”¨ï¼šæ’é™¤æŒ‡å®šå­—æ®µï¼Œä¸åœ¨å“åº”ä¸­è¿”å›ã€‚</p>
<h3 id="jinja2æ¨¡æ¿"><a href="#jinja2æ¨¡æ¿" class="headerlink" title="jinja2æ¨¡æ¿"></a>jinja2æ¨¡æ¿</h3><p>è¦äº†è§£ jinja2ï¼Œé‚£ä¹ˆéœ€è¦å…ˆç†è§£æ¨¡æ¿çš„æ¦‚å¿µã€‚æ¨¡æ¿åœ¨ Python çš„ web å¼€å‘ä¸­å¹¿æ³›ä½¿ç”¨ï¼Œå®ƒèƒ½å¤Ÿæœ‰æ•ˆçš„å°†ä¸šåŠ¡é€»è¾‘å’Œé¡µé¢é€»è¾‘åˆ†å¼€ï¼Œä½¿ä»£ç å¯è¯»æ€§å¢å¼ºã€å¹¶ä¸”æ›´åŠ å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚</p>
<p>æ¨¡æ¿ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªå…¶ä¸­åŒ…æ¶µå ä½å˜é‡è¡¨ç¤ºåŠ¨æ€çš„éƒ¨åˆ†çš„æ–‡ä»¶ï¼Œæ¨¡æ¿æ–‡ä»¶åœ¨ç»è¿‡åŠ¨æ€èµ‹å€¼åï¼Œè¿”å›ç»™ç”¨æˆ·ã€‚</p>
<p>jinja2 æ˜¯ Flask ä½œè€…å¼€å‘çš„ä¸€ä¸ªæ¨¡æ¿ç³»ç»Ÿï¼Œèµ·åˆæ˜¯ä»¿ django æ¨¡æ¿çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œä¸º Flask æä¾›æ¨¡æ¿æ”¯æŒï¼Œç”±äºå…¶çµæ´»ï¼Œå¿«é€Ÿå’Œå®‰å…¨ç­‰ä¼˜ç‚¹è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>
<p>åœ¨ jinja2 ä¸­ï¼Œå­˜åœ¨ä¸‰ç§è¯­æ³•ï¼š</p>
<blockquote>
<ol>
<li>å˜é‡å–å€¼ <code>&#123;&#123; &#125;&#125;</code></li>
<li>æ§åˆ¶ç»“æ„ <code>&#123;% %&#125;</code></li>
</ol>
<p>åº”ç”¨äºå‰åç«¯ä¸åˆ†ç¦»ï¼Œæ¨¡æ¿html+æ•°æ®åº“ï¼Œè¿”å›åŠ¨æ€ç½‘ç«™</p>
</blockquote>
<h4 id="5-1-å˜é‡"><a href="#5-1-å˜é‡" class="headerlink" title="5.1 å˜é‡"></a>5.1 å˜é‡</h4><p>main.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi.templating <span class="keyword">import</span> Jinja2Templates</span><br><span class="line"></span><br><span class="line">templates=Jinja2Templates(directory=<span class="string">&quot;templates&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/index&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request: Request</span>):</span><br><span class="line">    <span class="comment">#æ•°æ®åº“</span></span><br><span class="line">    name=<span class="string">&quot;World&quot;</span></span><br><span class="line">    books=[<span class="string">&quot;Python&quot;</span>, <span class="string">&quot;Java&quot;</span>, <span class="string">&quot;C++&quot;</span>]</span><br><span class="line">    user=&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Tom&quot;</span>, <span class="string">&quot;age&quot;</span>:<span class="number">18</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> templates.TemplateResponse(</span><br><span class="line">        <span class="string">&quot;index.html&quot;</span>,<span class="comment">#æ¨¡æ¿æ–‡ä»¶</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;request&quot;</span>: request,<span class="comment"># FastAPIéœ€è¦ä¸€ä¸ªrequestå¯¹è±¡</span></span><br><span class="line">            <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">            <span class="string">&quot;books&quot;</span>: books,</span><br><span class="line">            <span class="string">&quot;user&quot;</span>: user</span><br><span class="line">        &#125;<span class="comment">#contextä¸Šä¸‹æ–‡å¯¹è±¡</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>index.html</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;Hello, &#123;&#123; name &#125;&#125;!&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;Your favorite books are:&lt;/p&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &#123;% <span class="keyword">for</span> book <span class="keyword">in</span> books %&#125;</span><br><span class="line">        &lt;li&gt;&#123;&#123; book &#125;&#125;&lt;/li&gt;</span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;p&gt;å§“åï¼š&#123;&#123; user.name &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;å¹´é¾„ï¼š&#123;&#123; user.age &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/image-20250517200643492.png" alt="image-20250517200643492"></p>
<h4 id="5-2-è¿‡æ»¤å™¨"><a href="#5-2-è¿‡æ»¤å™¨" class="headerlink" title="5.2 è¿‡æ»¤å™¨"></a>5.2 è¿‡æ»¤å™¨</h4><p>å˜é‡å¯ä»¥é€šè¿‡â€œè¿‡æ»¤å™¨â€è¿›è¡Œä¿®æ”¹ï¼Œè¿‡æ»¤å™¨å¯ä»¥ç†è§£ä¸ºæ˜¯ jinja2 é‡Œé¢çš„å†…ç½®å‡½æ•°å’Œå­—ç¬¦ä¸²å¤„ç†å‡½æ•°ã€‚å¸¸ç”¨çš„è¿‡æ»¤å™¨æœ‰ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è¿‡æ»¤å™¨åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>capitalize</td>
<td>æŠŠå€¼çš„é¦–å­—æ¯è½¬æ¢æˆå¤§å†™ï¼Œå…¶ä»–å­—æ¯è½¬æ¢ä¸ºå°å†™</td>
</tr>
<tr>
<td>lower</td>
<td>æŠŠå€¼è½¬æ¢æˆå°å†™å½¢å¼</td>
</tr>
<tr>
<td>title</td>
<td>æŠŠå€¼ä¸­æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æ¢æˆå¤§å†™</td>
</tr>
<tr>
<td>trim</td>
<td>æŠŠå€¼çš„é¦–å°¾ç©ºæ ¼å»æ‰</td>
</tr>
<tr>
<td>striptags</td>
<td>æ¸²æŸ“ä¹‹å‰æŠŠå€¼ä¸­æ‰€æœ‰çš„ HTML æ ‡ç­¾éƒ½åˆ æ‰</td>
</tr>
<tr>
<td>join</td>
<td>æ‹¼æ¥å¤šä¸ªå€¼ä¸ºå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>round</td>
<td>é»˜è®¤å¯¹æ•°å­—è¿›è¡Œå››èˆäº”å…¥ï¼Œä¹Ÿå¯ä»¥ç”¨å‚æ•°è¿›è¡Œæ§åˆ¶</td>
</tr>
<tr>
<td>safe</td>
<td>æ¸²æŸ“æ—¶å€¼ä¸è½¬ä¹‰</td>
</tr>
</tbody>
</table>
</div>
<p>é‚£ä¹ˆå¦‚ä½•ä½¿ç”¨è¿™äº›è¿‡æ»¤å™¨å‘¢ï¼Ÿåªéœ€è¦åœ¨å˜é‡åé¢ä½¿ç”¨ç®¡é“ (|) åˆ†å‰²ï¼Œå¤šä¸ªè¿‡æ»¤å™¨å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œå‰ä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å‡ºä¼šä½œä¸ºåä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å…¥ã€‚</p>
<p>ä¾‹å¦‚ï¼š<code>&lt;h1&gt;Hello, &#123;&#123; name|upper &#125;&#125;!&lt;/h1&gt;</code>   <code>&lt;li&gt;&#123;&#123; book|title &#125;&#125;&lt;/li&gt;</code></p>
<h4 id="5-3-æ§åˆ¶ç»“æ„"><a href="#5-3-æ§åˆ¶ç»“æ„" class="headerlink" title="5.3 æ§åˆ¶ç»“æ„"></a>5.3 æ§åˆ¶ç»“æ„</h4><p>jinja2ä¸­çš„ifè¯­å¥ç±»ä¼¼ä¸Pythonçš„ifè¯­å¥ï¼Œå®ƒä¹Ÿå…·æœ‰å•åˆ†æ”¯ï¼Œå¤šåˆ†æ”¯ç­‰å¤šç§ç»“æ„ï¼Œä¸åŒçš„æ˜¯ï¼Œæ¡ä»¶è¯­å¥ä¸éœ€è¦ä½¿ç”¨å†’å·ç»“å°¾ï¼Œè€Œç»“æŸæ§åˆ¶è¯­å¥ï¼Œéœ€è¦ä½¿ç”¨endifå…³é”®å­—</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;å½±è§†åŒº&lt;/p&gt;</span><br><span class="line"><span class="punctuation">&#123;</span>% if age &gt;= <span class="number">18</span> %<span class="punctuation">&#125;</span></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li&gt;æˆäººå½±ç‰‡&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;æˆäººæ¸¸æˆ&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"><span class="punctuation">&#123;</span>% else %<span class="punctuation">&#125;</span></span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li&gt;å„¿ç«¥å½±ç‰‡&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;å„¿ç«¥æ¸¸æˆ&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"><span class="punctuation">&#123;</span>% endif %<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>jinja2ä¸­çš„forå¾ªç¯ç”¨äºè¿­ä»£Pythonçš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬åˆ—è¡¨ã€å…ƒç»„å’Œå­—å…¸ã€‚åœ¨jinja2ä¸­ä¸å­˜åœ¨whileå¾ªç¯ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>% for book in books %<span class="punctuation">&#125;</span></span><br><span class="line">&lt;li&gt;<span class="punctuation">&#123;</span><span class="punctuation">&#123;</span> book|title <span class="punctuation">&#125;</span><span class="punctuation">&#125;</span>&lt;/li&gt;</span><br><span class="line"><span class="punctuation">&#123;</span>% endfor %<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ORMæ“ä½œ"><a href="#ORMæ“ä½œ" class="headerlink" title="ORMæ“ä½œ"></a>ORMæ“ä½œ</h3><p>åœ¨å¤§å‹çš„ Web å¼€å‘ä¸­ï¼Œæˆ‘ä»¬è‚¯å®šä¼šç”¨åˆ°æ•°æ®åº“æ“ä½œï¼Œé‚£ä¹ˆ FastAPI ä¹Ÿæ”¯æŒæ•°æ®åº“çš„å¼€å‘ï¼Œä½ å¯ä»¥ç”¨ PostgreSQLã€MySQLã€SQLiteã€Oracle ç­‰ã€‚æœ¬æ–‡ç”¨ SQLite ä¸ºä¾‹ã€‚æˆ‘ä»¬çœ‹ä¸‹åœ¨ FastAPI æ˜¯å¦‚ä½•æ“ä½œè®¾è®¡æ•°æ®åº“çš„ã€‚</p>
<p>FastAPI æ˜¯ä¸€ä¸ªå¾ˆä¼˜ç§€çš„æ¡†æ¶ï¼Œä½†æ˜¯ç¼ºå°‘ä¸€ä¸ªåˆé€‚çš„ ORMï¼Œå®˜æ–¹ä»£ç é‡Œé¢ä½¿ç”¨çš„æ˜¯ SQLAlchemyï¼ŒTortoise ORM æ˜¯å— Django å¯å‘çš„æ˜“äºä½¿ç”¨çš„å¼‚æ­¥ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„å™¨ï¼‰ã€‚</p>
<p>Tortoise ORM ç›®å‰æ”¯æŒä»¥ä¸‹æ•°æ®åº“ï¼š</p>
<ul>
<li>PostgreSQL &gt;= 9.4ï¼ˆä½¿ç”¨ asyncpgï¼‰</li>
<li>SQLiteï¼ˆä½¿ç”¨ aiosqliteï¼‰</li>
<li>MySQL/MariaDBï¼ˆä½¿ç”¨ aiomysql æˆ–ä½¿ç”¨ asyncmyï¼‰</li>
</ul>
<p>å®‰è£…ï¼š<code>pip install tortoise-orm</code></p>
<h4 id="6-1-åˆ›å»ºæ¨¡å‹"><a href="#6-1-åˆ›å»ºæ¨¡å‹" class="headerlink" title="6.1 åˆ›å»ºæ¨¡å‹"></a>6.1 åˆ›å»ºæ¨¡å‹</h4><p><strong>1. ä¸€å¯¹ä¸€å…³ç³»ï¼ˆOne-to-Oneï¼‰</strong></p>
<ul>
<li><strong>å®šä¹‰</strong> ï¼šä¸€å¼ è¡¨ä¸­çš„ä¸€æ¡è®°å½•ä»…å…³è”å¦ä¸€å¼ è¡¨ä¸­çš„ä¸€æ¡è®°å½•ã€‚</li>
<li><strong>ç¤ºä¾‹</strong> ï¼šç”¨æˆ·è¡¨ï¼ˆUserï¼‰ä¸èº«ä»½è¯ä¿¡æ¯è¡¨ï¼ˆIDCardï¼‰ï¼Œä¸€ä¸ªç”¨æˆ·ä»…å¯¹åº”ä¸€å¼ èº«ä»½è¯ä¿¡æ¯ã€‚</li>
</ul>
<p><strong>2. ä¸€å¯¹å¤šå…³ç³»ï¼ˆOne-to-Manyï¼‰</strong></p>
<ul>
<li><strong>å®šä¹‰</strong> ï¼šä¸€å¼ è¡¨ä¸­çš„ä¸€æ¡è®°å½•å…³è”å¦ä¸€å¼ è¡¨ä¸­çš„å¤šæ¡è®°å½•ã€‚</li>
<li><strong>ç¤ºä¾‹</strong> ï¼šç­çº§è¡¨ï¼ˆClassï¼‰ä¸å­¦ç”Ÿè¡¨ï¼ˆStudentï¼‰ï¼Œä¸€ä¸ªç­çº§åŒ…å«å¤šä¸ªå­¦ç”Ÿï¼Œä½†æ¯ä¸ªå­¦ç”Ÿåªèƒ½å±äºä¸€ä¸ªç­çº§ã€‚</li>
</ul>
<p><strong>3. å¤šå¯¹å¤šå…³ç³»ï¼ˆMany-to-Manyï¼‰</strong></p>
<ul>
<li><strong>å®šä¹‰</strong> ï¼šä¸¤å¼ è¡¨ä¸­çš„è®°å½•å¯ä»¥äº’ç›¸å…³è”å¤šæ¡è®°å½•ï¼Œé€šå¸¸é€šè¿‡ä¸­é—´è¡¨å®ç°ã€‚</li>
<li><strong>ç¤ºä¾‹</strong> ï¼šå­¦ç”Ÿè¡¨ï¼ˆStudentï¼‰ä¸è¯¾ç¨‹è¡¨ï¼ˆCourseï¼‰ï¼Œä¸€ä¸ªå­¦ç”Ÿå¯é€‰ä¿®å¤šé—¨è¯¾ç¨‹ï¼Œä¸€é—¨è¯¾ç¨‹ä¹Ÿå¯è¢«å¤šä¸ªå­¦ç”Ÿé€‰ä¿®ã€‚</li>
</ul>
<p><strong>4. è‡ªå¼•ç”¨å…³ç³»ï¼ˆSelf-Referencingï¼‰</strong></p>
<ul>
<li><strong>å®šä¹‰</strong> ï¼šè¡¨å†…çš„è®°å½•é€šè¿‡å­—æ®µå…³è”è‡ªèº«ï¼Œå½¢æˆå±‚çº§æˆ–æ ‘çŠ¶ç»“æ„ã€‚</li>
<li><strong>ç¤ºä¾‹</strong> ï¼šå‘˜å·¥è¡¨ï¼ˆEmployeeï¼‰ï¼Œæ¯ä¸ªå‘˜å·¥å¯èƒ½æœ‰ç›´å±ä¸Šçº§ï¼ˆå¦ä¸€ä¸ªå‘˜å·¥ï¼‰ã€‚</li>
</ul>
<p><strong>5. ç»§æ‰¿å…³ç³»ï¼ˆInheritanceï¼‰</strong></p>
<ul>
<li><strong>å®šä¹‰</strong> ï¼šåŸºäºé¢å‘å¯¹è±¡çš„ç»§æ‰¿æ¦‚å¿µï¼Œå­è¡¨ç»§æ‰¿çˆ¶è¡¨çš„å­—æ®µå’Œçº¦æŸã€‚</li>
<li><strong>ç¤ºä¾‹</strong> ï¼šç”¨æˆ·è¡¨ï¼ˆUserï¼‰ä½œä¸ºåŸºè¡¨ï¼Œç®¡ç†å‘˜è¡¨ï¼ˆAdminï¼‰å’Œæ™®é€šç”¨æˆ·è¡¨ï¼ˆRegularUserï¼‰ç»§æ‰¿å…¶å­—æ®µï¼ˆå¦‚ç”¨æˆ·åã€å¯†ç ï¼‰ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tortoise.models <span class="keyword">import</span> Model</span><br><span class="line"><span class="keyword">from</span> tortoise <span class="keyword">import</span> fields</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Model æ˜¯æ‰€æœ‰æ•°æ®æ¨¡å‹çš„åŸºç±»ï¼Œé€šè¿‡ç»§æ‰¿ Model å¯å®šä¹‰æ•°æ®åº“è¡¨çš„ç»“æ„ã€‚æ¯ä¸ª Model å­ç±»å¯¹åº”ä¸€å¼ æ•°æ®åº“è¡¨ï¼Œå…¶ç±»å±æ€§å®šä¹‰äº†è¡¨çš„å­—æ®µï¼ˆåˆ—ï¼‰åŠå…¶çº¦æŸã€‚</span></span><br><span class="line"><span class="string">fields æä¾›äº†å¤šç§å­—æ®µç±»å‹ï¼Œç”¨äºå®šä¹‰æ•°æ®åº“è¡¨çš„åˆ—åŠå…¶çº¦æŸã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">Model</span>):</span><br><span class="line">    <span class="built_in">id</span> = fields.IntField(pk=<span class="literal">True</span>)<span class="comment">#è¯¥å­—æ®µä¼šè¢«æŒ‡å®šä¸ºæ¨¡å‹çš„ä¸»é”®</span></span><br><span class="line">    name = fields.CharField(max_length=<span class="number">50</span>,description=<span class="string">&quot;å§“å&quot;</span>)</span><br><span class="line">    pwd = fields.CharField(max_length=<span class="number">50</span>,description=<span class="string">&quot;å¯†ç &quot;</span>)</span><br><span class="line">    sno = fields.IntField(description=<span class="string">&quot;å­¦å·&quot;</span>)</span><br><span class="line">    <span class="comment">#ä¸€å¯¹å¤šå…³ç³»</span></span><br><span class="line">    Class_id = fields.ForeignKeyField(</span><br><span class="line">        <span class="string">&quot;models.Class&quot;</span>,<span class="comment">#å…³è”çš„æ¨¡å‹ç±»</span></span><br><span class="line">        related_name=<span class="string">&quot;students&quot;</span>,<span class="comment">#åå‘æŸ¥è¯¢æ—¶çš„åç§°</span></span><br><span class="line">        on_delete=fields.CASCADE,<span class="comment">#çº§è”åˆ é™¤</span></span><br><span class="line">        description=<span class="string">&quot;ç­çº§&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment">#å¤šå¯¹å¤šå…³ç³»</span></span><br><span class="line">    Course_id = fields.ManyToManyField(</span><br><span class="line">        <span class="string">&quot;models.Course&quot;</span>,<span class="comment">#å…³è”çš„æ¨¡å‹ç±»</span></span><br><span class="line">        related_name=<span class="string">&quot;students&quot;</span>,<span class="comment">#åå‘æŸ¥è¯¢æ—¶çš„åç§°</span></span><br><span class="line">        description=<span class="string">&quot;è¯¾ç¨‹&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Course</span>(<span class="title class_ inherited__">Model</span>):</span><br><span class="line">    <span class="built_in">id</span> = fields.IntField(pk=<span class="literal">True</span>)</span><br><span class="line">    name = fields.CharField(max_length=<span class="number">50</span>,description=<span class="string">&quot;è¯¾ç¨‹åç§°&quot;</span>)</span><br><span class="line">    teacher = fields.CharField(max_length=<span class="number">50</span>,description=<span class="string">&quot;æˆè¯¾è€å¸ˆ&quot;</span>)</span><br><span class="line">    <span class="comment">#ä¸€å¯¹å¤šå…³ç³»</span></span><br><span class="line">    teacher_id = fields.ForeignKeyField(</span><br><span class="line">        <span class="string">&quot;models.Teacher&quot;</span>,<span class="comment">#å…³è”çš„æ¨¡å‹ç±»</span></span><br><span class="line">        related_name=<span class="string">&quot;courses&quot;</span>,<span class="comment">#åå‘æŸ¥è¯¢æ—¶çš„åç§°</span></span><br><span class="line">        on_delete=fields.CASCADE,<span class="comment">#çº§è”åˆ é™¤</span></span><br><span class="line">        description=<span class="string">&quot;è€å¸ˆ&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Class</span>(<span class="title class_ inherited__">Model</span>):</span><br><span class="line">    <span class="built_in">id</span> = fields.IntField(pk=<span class="literal">True</span>)</span><br><span class="line">    name= fields.CharField(max_length=<span class="number">50</span>,description=<span class="string">&quot;ç­çº§åç§°&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Teacher</span>(<span class="title class_ inherited__">Model</span>):</span><br><span class="line">    <span class="built_in">id</span> =fields.IntField(pk=<span class="literal">True</span>)</span><br><span class="line">    name = fields.CharField(max_length=<span class="number">50</span>,description=<span class="string">&quot;è€å¸ˆå§“å&quot;</span>)</span><br><span class="line">    pwd = fields.CharField(max_length=<span class="number">50</span>,description=<span class="string">&quot;å¯†ç &quot;</span>)</span><br><span class="line">    sno = fields.IntField(description=<span class="string">&quot;å·¥å·&quot;</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ORMï¼ˆObject Relational Mappingï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ˜¯ä¸€ç§ç¨‹åºè®¾è®¡æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºå®ç°<strong>é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€</strong> ä¸<strong>å…³ç³»å‹æ•°æ®åº“</strong> ä¹‹é—´çš„æ•°æ®è½¬æ¢ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å¯¹è±¡æ¨¡å‹ä¸æ•°æ®åº“è¡¨ç»“æ„çš„æ˜ å°„ï¼Œå°†æ•°æ®åº“æ“ä½œè½¬åŒ–ä¸ºé¢å‘å¯¹è±¡çš„æ“ä½œï¼Œä»è€Œç®€åŒ–å¼€å‘æµç¨‹å¹¶æå‡ä»£ç çš„å¯ç»´æŠ¤æ€§</p>
<p>Tortoise ORM æ˜¯ä¸€æ¬¾ä¸“ä¸º Python å¼‚æ­¥ç¯å¢ƒè®¾è®¡çš„è½»é‡çº§å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORMï¼‰æ¡†æ¶ï¼Œå…¶è®¾è®¡çµæ„Ÿæ¥æºäº Django ORMï¼Œä½†ä¸“æ³¨äºå¼‚æ­¥ç¼–ç¨‹åœºæ™¯ï¼Œé€‚ç”¨äº FastAPIã€Sanic ç­‰åŸºäº <code>asyncio</code> çš„ç°ä»£ Web æ¡†æ¶ã€‚</p>
<p>å…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“</p>
<p><strong>å…³ç³»å‹æ•°æ®åº“</strong><br>ä»¥è¡¨æ ¼å½¢å¼å­˜å‚¨æ•°æ®ï¼Œæ•°æ®æŒ‰è¡Œå’Œåˆ—ç»„ç»‡ï¼Œåˆ—ä»£è¡¨å±æ€§ï¼ˆå­—æ®µï¼‰ï¼Œè¡Œä»£è¡¨è®°å½•ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·è¡¨å¯èƒ½åŒ…å« <code>id</code>ã€<code>name</code>ã€<code>email</code> ç­‰åˆ—ï¼Œæ¯è¡Œå¯¹åº”ä¸€ä¸ªç”¨æˆ·è®°å½•ã€‚è¿™ç§ç»“æ„åŒ–è®¾è®¡æ”¯æŒä¸¥æ ¼çš„æ¨¡å¼çº¦æŸï¼ˆSchemaï¼‰17ã€‚</p>
<p><strong>å…¸å‹ä»£è¡¨</strong> ï¼šMySQLã€Oracleã€PostgreSQLã€‚</p>
<p><strong>éå…³ç³»å‹æ•°æ®åº“ï¼ˆNoSQLï¼‰</strong><br>é‡‡ç”¨éç»“æ„åŒ–æˆ–åŠç»“æ„åŒ–å­˜å‚¨ï¼Œå¸¸è§çš„ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><p><strong>æ–‡æ¡£å‹</strong> ï¼ˆå¦‚ MongoDBï¼‰ï¼šä»¥ JSON æˆ– BSON æ ¼å¼å­˜å‚¨æ•°æ®ã€‚</p>
</li>
<li><p><strong>é”®å€¼å‹</strong> ï¼ˆå¦‚ Redisï¼‰ï¼šé€šè¿‡é”®ç›´æ¥è®¿é—®å€¼ã€‚</p>
</li>
<li><p><strong>åˆ—å­˜å‚¨</strong> ï¼ˆå¦‚ Cassandraï¼‰ï¼šæŒ‰åˆ—è€Œéè¡Œç»„ç»‡æ•°æ®ã€‚</p>
</li>
<li><p><strong>å›¾æ•°æ®åº“</strong> </p>
<p>ï¼ˆå¦‚ Neo4jï¼‰ï¼šä»¥èŠ‚ç‚¹å’Œè¾¹è¡¨ç¤ºæ•°æ®å…³ç³»</p>
</li>
</ul>
</blockquote>
<h4 id="6-2-aerichè¿ç§»å·¥å…·"><a href="#6-2-aerichè¿ç§»å·¥å…·" class="headerlink" title="6.2 aerichè¿ç§»å·¥å…·"></a>6.2 aerichè¿ç§»å·¥å…·</h4><p><strong>docker å®‰è£… mysql</strong>ï¼š</p>
<p>æ‹‰å– MySQL é•œåƒï¼š<code>docker pull mysql</code></p>
<p>è¿è¡Œ MySQL å®¹å™¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name fastapi -e MYSQL_ROOT_PASSWORD=root -p 3306:3306 -d mysql</span><br></pre></td></tr></table></figure>
<blockquote>
<p>-pè¡¨ç¤ºç«¯å£æ˜ å°„<br>â€”restart=alwaysè¡¨ç¤ºå®¹å™¨é€€å‡ºæ—¶æ€»æ˜¯é‡å¯<br>â€”nameè¡¨ç¤ºå®¹å™¨å‘½å<br>â€”privileged=trueè¡¨ç¤ºèµ‹äºˆå®¹å™¨æƒé™ä¿®æ”¹å®¿ä¸»æ–‡ä»¶æƒåˆ©<br>-v /home/mysql/log:/var/log/mysqlè¡¨ç¤ºå®¹å™¨æ—¥å¿—æŒ‚è½½åˆ°å®¿ä¸»æœº<br>-v /home/mysql/data:/var/lib/mysqlè¡¨ç¤ºå®¹å™¨å­˜å‚¨æ–‡ä»¶æŒ‚è½½åˆ°å®¿ä¸»æœº<br>-v /home/mysql/conf/my.cnf:/etc/mysql/my.cnfè¡¨ç¤ºå®¹å™¨é…ç½®æ–‡ä»¶æŒ‚è½½åˆ°å®¿ä¸»æœº<br>-e MYSQL_ROOT_PASSWORD=a12bCd3_W45pUq6è¡¨ç¤ºè®¾ç½®mysqlçš„rootç”¨æˆ·å¯†ç ,å»ºè®®ç”¨å¼ºå¯†ç <br>-dè¡¨ç¤ºåå°è¿è¡Œ</p>
</blockquote>
<p>å¯åŠ¨è¿™ä¸ª MySQL å®¹å™¨ï¼š<code>docker start fastapi</code></p>
<p>è¿›å…¥ MySQL å®¹å™¨ï¼š<code>docker exec -it fastapi bash</code></p>
<blockquote>
<p>è¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ï¼š</p>
<ul>
<li><code>docker exec</code>ï¼šåœ¨å·²è¿è¡Œçš„ Docker å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ã€‚</li>
<li><code>-it</code>ï¼š<code>-i</code> è¡¨ç¤ºäº¤äº’å¼æ“ä½œï¼Œ<code>-t</code> åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼ˆè®©ä½ åƒåœ¨ç»ˆç«¯ä¸€æ ·æ“ä½œï¼‰ã€‚</li>
<li><code>fastapi</code>ï¼šè¿™æ˜¯ä½ è¦è¿›å…¥çš„å®¹å™¨åç§°ï¼ˆä½ çš„ MySQL å®¹å™¨åï¼‰ã€‚</li>
<li><code>bash</code>ï¼šåœ¨å®¹å™¨å†…å¯åŠ¨ bash shellã€‚</li>
</ul>
<p>è¿™æ¡å‘½ä»¤ä¼šè®©ä½ è¿›å…¥åä¸º <code>fastapi</code> çš„å®¹å™¨ï¼Œå¹¶è·å¾—ä¸€ä¸ª bash å‘½ä»¤è¡Œç•Œé¢ï¼Œå°±åƒç™»å½•åˆ°ä¸€å° Linux æœåŠ¡å™¨ä¸€æ ·ï¼Œå¯ä»¥åœ¨é‡Œé¢æ‰§è¡Œå„ç§å‘½ä»¤ï¼ˆæ¯”å¦‚ç™»å½• MySQLã€æŸ¥çœ‹æ—¥å¿—ç­‰ï¼‰ã€‚</p>
</blockquote>
<p>ç™»å½• MySQLï¼š<code>mysql -u root -p</code></p>
<p>ä»ä¸»æœºç›´æ¥è¿æ¥ï¼š<code>mysql -h 127.0.0.1 -P 3306 -u root -p</code></p>
<h5 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">TORTOISE_ORM = &#123;</span><br><span class="line">    &quot;connections&quot;: &#123;</span><br><span class="line">        &quot;default&quot;: &#123;</span><br><span class="line">            &quot;engine&quot;:&#x27;tortoise.backends.mysql&#x27;,#é€‰æ‹©æ•°æ®åº“å¼•æ“ï¼Œmysql</span><br><span class="line">            &quot;credentials&quot;: &#123;</span><br><span class="line">                &quot;host&quot;: &quot;localhost&quot;,#æ•°æ®åº“åœ°å€</span><br><span class="line">                &quot;port&quot;: 3306,#æ•°æ®åº“ç«¯å£</span><br><span class="line">                &quot;user&quot;: &quot;root&quot;,#æ•°æ®åº“ç”¨æˆ·å</span><br><span class="line">                &quot;password&quot;: &quot;root&quot;,#æ•°æ®åº“å¯†ç </span><br><span class="line">                &quot;database&quot;: &quot;fastapi_db&quot;,#æ•°æ®åº“åç§°</span><br><span class="line">                &#x27;charset&#x27;: &quot;utf8mb4&quot;,#æ•°æ®åº“ç¼–ç </span><br><span class="line">                &#x27;echo&#x27;: True,#æ˜¯å¦æ‰“å°sqlè¯­å¥</span><br><span class="line">                &#x27;minsize&#x27;: 1,#è¿æ¥æ± æœ€å°è¿æ¥æ•°</span><br><span class="line">                &#x27;maxsize&#x27;: 5#è¿æ¥æ± æœ€å¤§è¿æ¥æ•°</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;apps&quot;: &#123;</span><br><span class="line">        &quot;models&quot;: &#123;</span><br><span class="line">            #db.modelsæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„æ¨¡å‹ç±»,modelsåœ¨dbæ–‡ä»¶å¤¹ä¸‹</span><br><span class="line">            &quot;models&quot;: [&quot;db.models&quot;,&quot;aerich.models&quot;],</span><br><span class="line">            &quot;default_connection&quot;: &quot;default&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#x27;use_tz&#x27;: False,#æ˜¯å¦ä½¿ç”¨æ—¶åŒº</span><br><span class="line">    &#x27;timezone&#x27;: &#x27;Asia/Shanghai&#x27;,#æ—¶åŒº</span><br><span class="line">    &quot;generate_schemas&quot;: True,</span><br><span class="line">    &quot;add_exception_handlers&quot;: True</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="1-åˆå§‹åŒ–é…ç½®ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€æ¬¡"><a href="#1-åˆå§‹åŒ–é…ç½®ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€æ¬¡" class="headerlink" title="1.åˆå§‹åŒ–é…ç½®ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€æ¬¡"></a>1.åˆå§‹åŒ–é…ç½®ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€æ¬¡</h5><p>aerich æ˜¯ä¸€ç§ ORM è¿ç§»å·¥å…·ï¼Œéœ€è¦ç»“åˆ tortoise å¼‚æ­¥ orm æ¡†æ¶ä½¿ç”¨ã€‚å®‰è£… aerich</p>
<p><code>pip install aerich</code></p>
<p><code>aerich init -t settings.TORTOISE_ORM  # TORTOISE_ORM é…ç½®çš„ä½ç½®</code></p>
<blockquote>
<p>åˆå§‹åŒ–å®Œä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼špyproject.toml å’Œä¸€ä¸ªæ–‡ä»¶å¤¹ï¼šmigrations</p>
<ul>
<li>pyproject.tomlï¼šä¿å­˜é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œä½ç‰ˆæœ¬å¯èƒ½æ˜¯ aerich.ini</li>
<li>migrationsï¼šå­˜æ”¾è¿ç§»æ–‡ä»¶</li>
</ul>
</blockquote>
<h5 id="2-åˆå§‹åŒ–æ•°æ®åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªç”¨ä¸€æ¬¡"><a href="#2-åˆå§‹åŒ–æ•°æ®åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªç”¨ä¸€æ¬¡" class="headerlink" title="2.åˆå§‹åŒ–æ•°æ®åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªç”¨ä¸€æ¬¡"></a>2.åˆå§‹åŒ–æ•°æ®åº“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªç”¨ä¸€æ¬¡</h5><p><code>aerich init-db</code></p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/image-20250521105044582.png" alt="image-20250521105044582"></p>
<h5 id="3-æ›´æ–°æ¨¡å‹å¹¶è¿›è¡Œè¿ç§»"><a href="#3-æ›´æ–°æ¨¡å‹å¹¶è¿›è¡Œè¿ç§»" class="headerlink" title="3.æ›´æ–°æ¨¡å‹å¹¶è¿›è¡Œè¿ç§»"></a>3.æ›´æ–°æ¨¡å‹å¹¶è¿›è¡Œè¿ç§»</h5><p>ä¿®æ”¹modelç±»ï¼Œé‡æ–°ç”Ÿæˆè¿ç§»æ–‡ä»¶</p>
<p><code>aerich migrate</code></p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/image-20250521111024194.png" alt="image-20250521111024194"></p>
<h5 id="4-é‡æ–°æ‰§è¡Œè¿ç§»ï¼Œå†™å…¥æ•°æ®åº“"><a href="#4-é‡æ–°æ‰§è¡Œè¿ç§»ï¼Œå†™å…¥æ•°æ®åº“" class="headerlink" title="4.é‡æ–°æ‰§è¡Œè¿ç§»ï¼Œå†™å…¥æ•°æ®åº“"></a>4.é‡æ–°æ‰§è¡Œè¿ç§»ï¼Œå†™å…¥æ•°æ®åº“</h5><p><code>aerich upgrade</code></p>
<p><img src="/2025/05/14/%E5%AD%A6%E4%B9%A0/python-web/fastapi/fastapi/image-20250521111131931.png" alt="image-20250521111131931"></p>
<h5 id="5-å›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬"><a href="#5-å›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬" class="headerlink" title="5.å›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬"></a>5.å›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</h5><p><code>aerich downgrade</code></p>
<h5 id="6-æŸ¥çœ‹å†å²è¿ç§»è®°å½•"><a href="#6-æŸ¥çœ‹å†å²è¿ç§»è®°å½•" class="headerlink" title="6.æŸ¥çœ‹å†å²è¿ç§»è®°å½•"></a>6.æŸ¥çœ‹å†å²è¿ç§»è®°å½•</h5><p><code>aerich history</code></p>
<blockquote>
<p><code>register_tortoise</code> æ˜¯ Tortoise ORM æä¾›çš„ä¸€ä¸ªå·¥å…·å‡½æ•°ï¼Œç”¨äºåœ¨ <strong>FastAPI</strong> ç­‰å¼‚æ­¥æ¡†æ¶ä¸­å¿«é€Ÿé›†æˆå’Œç®¡ç† Tortoise ORM çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚å¯åŠ¨æ—¶åˆå§‹åŒ–æ•°æ®åº“è¿æ¥ï¼Œå…³é—­æ—¶é‡Šæ”¾èµ„æºï¼‰ã€‚å…¶æ ¸å¿ƒä½œç”¨æ˜¯ç®€åŒ– Tortoise ORM çš„é…ç½®å’Œè‡ªåŠ¨åŒ–ç®¡ç†ï¼Œå¼€å‘è€…åªéœ€ä¸€è¡Œä»£ç å³å¯å®Œæˆå¤æ‚çš„åˆå§‹åŒ–æµç¨‹</p>
</blockquote>
<h4 id="6-3-ORMæŸ¥è¯¢æ“ä½œ"><a href="#6-3-ORMæŸ¥è¯¢æ“ä½œ" class="headerlink" title="6.3 ORMæŸ¥è¯¢æ“ä½œ"></a>6.3 ORMæŸ¥è¯¢æ“ä½œ</h4><p>api.stud</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> APIRouter</span><br><span class="line"><span class="comment">#å¯¼å…¥æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">from</span> db.models <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">student_api=APIRouter()</span><br><span class="line"></span><br><span class="line"><span class="meta">@student_api.get(<span class="params"><span class="string">&quot;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_students</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    #æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line"><span class="string">    students= await Student.all()#è·å–æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line"><span class="string">    for student in students:</span></span><br><span class="line"><span class="string">        print(student.id,student.name)</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    #è¿‡æ»¤æŸ¥è¯¢filter</span></span><br><span class="line"><span class="string">    students= await Student.filter(name__contains=&quot;å¼ &quot;).all()</span></span><br><span class="line"><span class="string">    for student in students:</span></span><br><span class="line"><span class="string">        print(student.id,student.name)</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    #getå­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line"><span class="string">    stu = await Student.get(id=1)</span></span><br><span class="line"><span class="string">    print(stu.id,stu.name)</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    #æ¨¡ç³ŠæŸ¥è¯¢</span></span><br><span class="line"><span class="string">    #æœ€å¤§å€¼</span></span><br><span class="line"><span class="string">    stu =await Student.filter(sno__gt=1000).all()</span></span><br><span class="line"><span class="string">    #æœ€å°å€¼</span></span><br><span class="line"><span class="string">    #stu = await Student.filter(sno__lt=1000).all()</span></span><br><span class="line"><span class="string">    #èŒƒå›´æŸ¥è¯¢</span></span><br><span class="line"><span class="string">    #stu = await Student.filter(sno__range=(1000,2000)).all()</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    #valuesæŸ¥è¯¢</span></span><br><span class="line"><span class="string">    stu = await Student.all().values(&quot;sno&quot;,&quot;name&quot;)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="string">&quot;æ“ä½œ&quot;</span>:<span class="string">&quot;è·å–æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@student_api.post(<span class="params"><span class="string">&quot;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">create_student</span>():</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="string">&quot;æ“ä½œ&quot;</span>:<span class="string">&quot;åˆ›å»ºå­¦ç”Ÿä¿¡æ¯&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@student_api.get(<span class="params"><span class="string">&quot;/&#123;student_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_student</span>(<span class="params">student_id:<span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="string">&quot;æ“ä½œ&quot;</span>:<span class="string">f&quot;è·å–å­¦ç”Ÿä¿¡æ¯ï¼ŒIDï¼š<span class="subst">&#123;student_id&#125;</span>&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@student_api.put(<span class="params"><span class="string">&quot;/&#123;student_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">update_student</span>(<span class="params">student_id:<span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="string">&quot;æ“ä½œ&quot;</span>:<span class="string">f&quot;æ›´æ–°å­¦ç”Ÿä¿¡æ¯ï¼ŒIDï¼š<span class="subst">&#123;student_id&#125;</span>&quot;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨ FastAPI å’Œ Tortoise ORM ä¸­ï¼Œ<code>async</code> å’Œ <code>await</code> ç”¨äº<strong>å¼‚æ­¥ç¼–ç¨‹</strong>ï¼Œä¸»è¦åŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>å¼‚æ­¥ I/O æ“ä½œ</strong><br>æ•°æ®åº“æŸ¥è¯¢ï¼ˆå¦‚ Student.all()ï¼‰æ˜¯è€—æ—¶çš„ I/O æ“ä½œã€‚ä½¿ç”¨ <code>async</code>/<code>await</code> å¯ä»¥åœ¨ç­‰å¾…æ•°æ®åº“å“åº”æ—¶ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ï¼Œæé«˜åº”ç”¨çš„å¹¶å‘æ€§èƒ½ã€‚</li>
<li><strong>FastAPI æ”¯æŒå¼‚æ­¥è·¯ç”±</strong><br>FastAPI æ”¯æŒå¼‚æ­¥ï¼ˆ<code>async def</code>ï¼‰çš„è·¯ç”±å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥å……åˆ†åˆ©ç”¨ Python çš„å¼‚æ­¥ç‰¹æ€§ï¼Œæå‡ Web æœåŠ¡çš„ååé‡ã€‚</li>
<li><strong>Tortoise ORM çš„æ–¹æ³•æ˜¯å¼‚æ­¥çš„</strong><br>Tortoise ORM çš„æ•°æ®åº“æ“ä½œæ–¹æ³•ï¼ˆå¦‚ <code>.all()</code>ã€<code>.create()</code> ç­‰ï¼‰æœ¬èº«å°±æ˜¯å¼‚æ­¥æ–¹æ³•ï¼Œå¿…é¡»ç”¨ <code>await</code> è°ƒç”¨ï¼Œå¹¶ä¸”æ‰€åœ¨å‡½æ•°å¿…é¡»ç”¨ <code>async def</code> å£°æ˜ã€‚</li>
</ol>
</blockquote>
<h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><h4 id="ç«¯å£æŸ¥è¯¢"><a href="#ç«¯å£æŸ¥è¯¢" class="headerlink" title="ç«¯å£æŸ¥è¯¢"></a>ç«¯å£æŸ¥è¯¢</h4><p>æŸ¥çœ‹æ‰€æœ‰ç«¯å£å ç”¨æƒ…å†µï¼š<code>netstat -ano</code></p>
<p>æŸ¥è¯¢ç‰¹å®šç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š<code>netstat -ano | findstr 8080</code></p>
<p>ä½¿ç”¨ <code>taskkill</code> å‘½ä»¤å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼š<code>taskkill /PID è¿›ç¨‹ID /F</code></p>
<p>é€šè¿‡ PID æŸ¥æ‰¾è¿›ç¨‹ï¼š<code>tasklist | findstr PID</code></p>
<h4 id="è·å–ç»å¯¹è·¯å¾„"><a href="#è·å–ç»å¯¹è·¯å¾„" class="headerlink" title="è·å–ç»å¯¹è·¯å¾„"></a>è·å–ç»å¯¹è·¯å¾„</h4><p>è·å–å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼š<code>base_dir = os.path.dirname(os.path.abspath(__file__))</code></p>
<p>æ‹¼æ¥è·¯å¾„ï¼š<code>img_dir = os.path.join(base_dir, &quot;../imgs&quot;)</code></p>
<h4 id="mysqléƒ¨åˆ†æŒ‡ä»¤"><a href="#mysqléƒ¨åˆ†æŒ‡ä»¤" class="headerlink" title="mysqléƒ¨åˆ†æŒ‡ä»¤"></a>mysqléƒ¨åˆ†æŒ‡ä»¤</h4><p><strong>æŸ¥çœ‹æ•°æ®åº“åˆ—è¡¨</strong>ï¼š<code>SHOW DATABASES;</code></p>
<p><strong>é€‰æ‹©æ•°æ®åº“</strong>ï¼š<code>USE æ•°æ®åº“å;</code></p>
<p><strong>åˆ é™¤æ•°æ®åº“</strong>ï¼š<code>DROP DATABASE æ•°æ®åº“å;</code></p>
<p><strong>åˆ›å»ºæ•°æ®åº“</strong>ï¼š<code>CREATE DATABASE æ•°æ®åº“å;</code></p>
<p><strong>ç™»å½• MySQL</strong>ï¼š<code>mysql -u root -p</code></p>
<p><strong>é€€å‡º</strong>ï¼š<code>exit</code></p>
<h4 id="dockeréƒ¨åˆ†æŒ‡ä»¤"><a href="#dockeréƒ¨åˆ†æŒ‡ä»¤" class="headerlink" title="dockeréƒ¨åˆ†æŒ‡ä»¤"></a>dockeréƒ¨åˆ†æŒ‡ä»¤</h4><p><strong>linuxå®‰è£…docker</strong>ï¼š<code>sudo apt-get update &amp;&amp; sudo apt-get install docker.io</code></p>
<p><strong>æŸ¥çœ‹ Docker ç‰ˆæœ¬ä¿¡æ¯</strong>ï¼š<code>docker version</code></p>
<p><strong>æŸ¥çœ‹é•œåƒ</strong>ï¼š<code>docker images</code></p>
<p><strong>æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨</strong>ï¼š<code>docker ps -a</code> </p>
<blockquote>
<p><code>systemctl</code> æ˜¯ <strong>systemd</strong> ç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨çš„æ ¸å¿ƒå·¥å…·ï¼Œç”¨äºç®¡ç†ç³»ç»Ÿå’ŒæœåŠ¡çš„çŠ¶æ€åŠé…ç½®ã€‚</p>
</blockquote>
<p><code>mysql-client</code> æ˜¯ MySQL æ•°æ®åº“çš„å‘½ä»¤è¡Œå®¢æˆ·ç«¯å·¥å…·ã€‚å®ƒå…è®¸ä½ é€šè¿‡å‘½ä»¤è¡Œè¿æ¥å’Œæ“ä½œ MySQL æ•°æ®åº“æœåŠ¡å™¨ï¼Œæ¯”å¦‚æ‰§è¡Œ SQL æŸ¥è¯¢ã€ç®¡ç†æ•°æ®åº“å’Œç”¨æˆ·ç­‰ã€‚</p>
<p>å¸¸ç”¨å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š<code>mysql -h ä¸»æœºåœ°å€ -P ç«¯å£å· -u ç”¨æˆ·å -p</code></p>
<p>ä½ å¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å·²å®‰è£… <code>mysql-client</code>ï¼š<code>mysql --version</code></p>
<p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š<code>sudo apt-get update  sudo apt-get install mysql-client</code></p>
<blockquote>
<p><code>sudo apt-get update</code> è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯<strong>æ›´æ–°æœ¬åœ°è½¯ä»¶åŒ…åˆ—è¡¨</strong>ã€‚</p>
</blockquote>
<p><strong>åœæ­¢å¹¶åˆ é™¤å®¹å™¨</strong>ï¼š<code>docker stop fastapi  docker rm fastapi</code></p>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p>fastapiä¸€ä¸ªé¡¹ç›®<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1TSVPzkE7Y?spm_id_from=333.788.videopod.episodes&amp;vd_source=bacf29bd4bb51f2ecf08a1ac7c7d8f11">FastAPIè¿›é˜¶_å“”å“©å“”å“©_bilibili</a></p>
<p>æ•™ç¨‹<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Ya4y1D7et/?spm_id_from=333.337.search-card.all.click&amp;vd_source=bacf29bd4bb51f2ecf08a1ac7c7d8f11">fastapiæ¡†æ¶å¿«é€Ÿå­¦ä¹ _å“”å“©å“”å“©_bilibili</a></p>
<p>fastapiç›¸å…³çŸ¥è¯†çš„è¡¥å……<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1zJ7mzdEc8?spm_id_from=333.788.videopod.sections&amp;vd_source=bacf29bd4bb51f2ecf08a1ac7c7d8f11">Python å¼‚æ­¥ç¼–ç¨‹ - ææ˜ç™½ async, await (ç»§ç»­è§£é‡Š yield)_å“”å“©å“”å“©_bilibili</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/19/%E5%9B%9E%E5%BF%86/%E5%89%8D%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/04/19/%E5%9B%9E%E5%BF%86/%E5%89%8D%E8%A8%80/" class="post-title-link" itemprop="url">å‰è¨€</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-04-19 00:00:00" itemprop="dateCreated datePublished" datetime="2025-04-19T00:00:00+08:00">2025-04-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-04-20 00:09:10" itemprop="dateModified" datetime="2025-04-20T00:09:10+08:00">2025-04-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%9B%9E%E5%BF%86/" itemprop="url" rel="index"><span itemprop="name">å›å¿†</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æˆ‘æ˜¯ä¸€ä¸ªå¾ˆçæƒœå›å¿†çš„äººï¼Œä½†æ˜¯ä»»ä½•å›å¿†éƒ½æœ‰å¿˜å´çš„é‚£ä¸€å¤©ï¼Œæ‰€ä»¥æˆ‘èƒ½åšçš„å°±æ˜¯å°½å¯èƒ½æŠŠä»–jiâ€™lu</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/19/%E5%9B%9E%E5%BF%86/%E6%88%91%E6%83%B3%E5%90%AC%E4%BB%96%E6%89%AB%E5%BC%A6%E7%9A%84%E5%A3%B0%E9%9F%B3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zxjavatar.gif">
      <meta itemprop="name" content="å¼ ç†™æµš">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhang XiJun">
      <meta itemprop="description" content="zxj Blogs">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Zhang XiJun">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/04/19/%E5%9B%9E%E5%BF%86/%E6%88%91%E6%83%B3%E5%90%AC%E4%BB%96%E6%89%AB%E5%BC%A6%E7%9A%84%E5%A3%B0%E9%9F%B3/" class="post-title-link" itemprop="url">æˆ‘æƒ³å¬ä»–æ‰«å¼¦çš„å£°éŸ³</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-04-19 00:00:00" itemprop="dateCreated datePublished" datetime="2025-04-19T00:00:00+08:00">2025-04-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-06-12 18:39:42" itemprop="dateModified" datetime="2025-06-12T18:39:42+08:00">2025-06-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%9B%9E%E5%BF%86/" itemprop="url" rel="index"><span itemprop="name">å›å¿†</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="æˆ‘æƒ³å¬ä»–æ‰«å¼¦çš„å£°éŸ³"><a href="#æˆ‘æƒ³å¬ä»–æ‰«å¼¦çš„å£°éŸ³" class="headerlink" title="æˆ‘æƒ³å¬ä»–æ‰«å¼¦çš„å£°éŸ³"></a>æˆ‘æƒ³å¬ä»–æ‰«å¼¦çš„å£°éŸ³</h3><p>å—äº¬1701livehouse</p>
<p><img src="/2025/04/19/%E5%9B%9E%E5%BF%86/%E6%88%91%E6%83%B3%E5%90%AC%E4%BB%96%E6%89%AB%E5%BC%A6%E7%9A%84%E5%A3%B0%E9%9F%B3/1745077840515.jpg" alt="1745077840515"></p>
<p><img src="/2025/04/19/%E5%9B%9E%E5%BF%86/%E6%88%91%E6%83%B3%E5%90%AC%E4%BB%96%E6%89%AB%E5%BC%A6%E7%9A%84%E5%A3%B0%E9%9F%B3/1745077840490.jpg" alt="1745077840490"></p>
<p><img src="/2025/04/19/%E5%9B%9E%E5%BF%86/%E6%88%91%E6%83%B3%E5%90%AC%E4%BB%96%E6%89%AB%E5%BC%A6%E7%9A%84%E5%A3%B0%E9%9F%B3/1745077840469.jpg" alt="1745077840469"></p>
<p><img src="/2025/04/19/%E5%9B%9E%E5%BF%86/%E6%88%91%E6%83%B3%E5%90%AC%E4%BB%96%E6%89%AB%E5%BC%A6%E7%9A%84%E5%A3%B0%E9%9F%B3/1745077840480.jpg" alt="1745077840480"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="ä¸Šä¸€é¡µ" aria-label="ä¸Šä¸€é¡µ" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" title="ä¸‹ä¸€é¡µ" aria-label="ä¸‹ä¸€é¡µ" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">å¼ ç†™æµš</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="æœ¬ç«™è®¿é—®æ•° fa fa-user æ¬¡"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="æœ¬ç«™æ€»è®¿é—®é‡ fa fa-eye æ¬¡"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="400" alpha="0.6" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
